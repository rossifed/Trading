USE [master]
GO
/****** Object:  Database [Trading]    Script Date: 23/08/2023 15:39:46 ******/
CREATE DATABASE [Trading]
 CONTAINMENT = NONE
 ON  PRIMARY 
( NAME = N'Trading', FILENAME = N'C:\Program Files\Microsoft SQL Server\MSSQL16.MSSQLSERVER\MSSQL\DATA\Trading.mdf' , SIZE = 401408KB , MAXSIZE = UNLIMITED, FILEGROWTH = 65536KB )
 LOG ON 
( NAME = N'Trading_log', FILENAME = N'C:\Program Files\Microsoft SQL Server\MSSQL16.MSSQLSERVER\MSSQL\DATA\Trading_log.ldf' , SIZE = 925696KB , MAXSIZE = 2048GB , FILEGROWTH = 65536KB )
 WITH CATALOG_COLLATION = DATABASE_DEFAULT, LEDGER = OFF
GO
ALTER DATABASE [Trading] SET COMPATIBILITY_LEVEL = 160
GO
IF (1 = FULLTEXTSERVICEPROPERTY('IsFullTextInstalled'))
begin
EXEC [Trading].[dbo].[sp_fulltext_database] @action = 'enable'
end
GO
ALTER DATABASE [Trading] SET ANSI_NULL_DEFAULT OFF 
GO
ALTER DATABASE [Trading] SET ANSI_NULLS OFF 
GO
ALTER DATABASE [Trading] SET ANSI_PADDING OFF 
GO
ALTER DATABASE [Trading] SET ANSI_WARNINGS OFF 
GO
ALTER DATABASE [Trading] SET ARITHABORT OFF 
GO
ALTER DATABASE [Trading] SET AUTO_CLOSE OFF 
GO
ALTER DATABASE [Trading] SET AUTO_SHRINK OFF 
GO
ALTER DATABASE [Trading] SET AUTO_UPDATE_STATISTICS ON 
GO
ALTER DATABASE [Trading] SET CURSOR_CLOSE_ON_COMMIT OFF 
GO
ALTER DATABASE [Trading] SET CURSOR_DEFAULT  GLOBAL 
GO
ALTER DATABASE [Trading] SET CONCAT_NULL_YIELDS_NULL OFF 
GO
ALTER DATABASE [Trading] SET NUMERIC_ROUNDABORT OFF 
GO
ALTER DATABASE [Trading] SET QUOTED_IDENTIFIER OFF 
GO
ALTER DATABASE [Trading] SET RECURSIVE_TRIGGERS OFF 
GO
ALTER DATABASE [Trading] SET  DISABLE_BROKER 
GO
ALTER DATABASE [Trading] SET AUTO_UPDATE_STATISTICS_ASYNC OFF 
GO
ALTER DATABASE [Trading] SET DATE_CORRELATION_OPTIMIZATION OFF 
GO
ALTER DATABASE [Trading] SET TRUSTWORTHY OFF 
GO
ALTER DATABASE [Trading] SET ALLOW_SNAPSHOT_ISOLATION OFF 
GO
ALTER DATABASE [Trading] SET PARAMETERIZATION SIMPLE 
GO
ALTER DATABASE [Trading] SET READ_COMMITTED_SNAPSHOT OFF 
GO
ALTER DATABASE [Trading] SET HONOR_BROKER_PRIORITY OFF 
GO
ALTER DATABASE [Trading] SET RECOVERY SIMPLE 
GO
ALTER DATABASE [Trading] SET  MULTI_USER 
GO
ALTER DATABASE [Trading] SET PAGE_VERIFY CHECKSUM  
GO
ALTER DATABASE [Trading] SET DB_CHAINING OFF 
GO
ALTER DATABASE [Trading] SET FILESTREAM( NON_TRANSACTED_ACCESS = OFF ) 
GO
ALTER DATABASE [Trading] SET TARGET_RECOVERY_TIME = 60 SECONDS 
GO
ALTER DATABASE [Trading] SET DELAYED_DURABILITY = DISABLED 
GO
ALTER DATABASE [Trading] SET ACCELERATED_DATABASE_RECOVERY = OFF  
GO
EXEC sys.sp_db_vardecimal_storage_format N'Trading', N'ON'
GO
ALTER DATABASE [Trading] SET QUERY_STORE = ON
GO
ALTER DATABASE [Trading] SET QUERY_STORE (OPERATION_MODE = READ_WRITE, CLEANUP_POLICY = (STALE_QUERY_THRESHOLD_DAYS = 30), DATA_FLUSH_INTERVAL_SECONDS = 900, INTERVAL_LENGTH_MINUTES = 60, MAX_STORAGE_SIZE_MB = 1000, QUERY_CAPTURE_MODE = AUTO, SIZE_BASED_CLEANUP_MODE = AUTO, MAX_PLANS_PER_QUERY = 200, WAIT_STATS_CAPTURE_MODE = ON)
GO
USE [Trading]
GO
/****** Object:  Schema [blpapi]    Script Date: 23/08/2023 15:39:46 ******/
CREATE SCHEMA [blpapi]
GO
/****** Object:  Schema [constr]    Script Date: 23/08/2023 15:39:46 ******/
CREATE SCHEMA [constr]
GO
/****** Object:  Schema [conv]    Script Date: 23/08/2023 15:39:46 ******/
CREATE SCHEMA [conv]
GO
/****** Object:  Schema [efrp]    Script Date: 23/08/2023 15:39:46 ******/
CREATE SCHEMA [efrp]
GO
/****** Object:  Schema [exec]    Script Date: 23/08/2023 15:39:46 ******/
CREATE SCHEMA [exec]
GO
/****** Object:  Schema [instr]    Script Date: 23/08/2023 15:39:46 ******/
CREATE SCHEMA [instr]
GO
/****** Object:  Schema [mktdata]    Script Date: 23/08/2023 15:39:46 ******/
CREATE SCHEMA [mktdata]
GO
/****** Object:  Schema [ord]    Script Date: 23/08/2023 15:39:46 ******/
CREATE SCHEMA [ord]
GO
/****** Object:  Schema [port]    Script Date: 23/08/2023 15:39:46 ******/
CREATE SCHEMA [port]
GO
/****** Object:  Schema [prc]    Script Date: 23/08/2023 15:39:46 ******/
CREATE SCHEMA [prc]
GO
/****** Object:  Schema [pricing]    Script Date: 23/08/2023 15:39:46 ******/
CREATE SCHEMA [pricing]
GO
/****** Object:  Schema [px]    Script Date: 23/08/2023 15:39:46 ******/
CREATE SCHEMA [px]
GO
/****** Object:  Schema [rebal]    Script Date: 23/08/2023 15:39:46 ******/
CREATE SCHEMA [rebal]
GO
/****** Object:  Schema [ref]    Script Date: 23/08/2023 15:39:46 ******/
CREATE SCHEMA [ref]
GO
/****** Object:  Schema [rep]    Script Date: 23/08/2023 15:39:46 ******/
CREATE SCHEMA [rep]
GO
/****** Object:  Schema [risk]    Script Date: 23/08/2023 15:39:46 ******/
CREATE SCHEMA [risk]
GO
/****** Object:  Schema [roll]    Script Date: 23/08/2023 15:39:46 ******/
CREATE SCHEMA [roll]
GO
/****** Object:  Schema [rout]    Script Date: 23/08/2023 15:39:46 ******/
CREATE SCHEMA [rout]
GO
/****** Object:  Schema [strats]    Script Date: 23/08/2023 15:39:46 ******/
CREATE SCHEMA [strats]
GO
/****** Object:  Schema [val]    Script Date: 23/08/2023 15:39:46 ******/
CREATE SCHEMA [val]
GO
/****** Object:  Schema [wght]    Script Date: 23/08/2023 15:39:46 ******/
CREATE SCHEMA [wght]
GO
/****** Object:  Table [instr].[TimeZone_H]    Script Date: 23/08/2023 15:39:46 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [instr].[TimeZone_H](
	[TimeZoneId] [smallint] NOT NULL,
	[Name] [nvarchar](100) NOT NULL,
	[ValidFrom] [datetime2](2) NOT NULL,
	[ValidTo] [datetime2](2) NOT NULL
) ON [PRIMARY]
WITH
(
DATA_COMPRESSION = PAGE
)
GO
/****** Object:  Index [ix_TimeZone_H]    Script Date: 23/08/2023 15:39:47 ******/
CREATE CLUSTERED INDEX [ix_TimeZone_H] ON [instr].[TimeZone_H]
(
	[ValidTo] ASC,
	[ValidFrom] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, SORT_IN_TEMPDB = OFF, DROP_EXISTING = OFF, ONLINE = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF, DATA_COMPRESSION = PAGE) ON [PRIMARY]
GO
/****** Object:  Table [instr].[TimeZone]    Script Date: 23/08/2023 15:39:47 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [instr].[TimeZone](
	[TimeZoneId] [smallint] IDENTITY(1,1) NOT NULL,
	[Name] [nvarchar](100) NOT NULL,
	[ValidFrom] [datetime2](2) GENERATED ALWAYS AS ROW START NOT NULL,
	[ValidTo] [datetime2](2) GENERATED ALWAYS AS ROW END NOT NULL,
 CONSTRAINT [PK_TimeZone] PRIMARY KEY CLUSTERED 
(
	[TimeZoneId] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY],
	PERIOD FOR SYSTEM_TIME ([ValidFrom], [ValidTo])
) ON [PRIMARY]
WITH
(
SYSTEM_VERSIONING = ON (HISTORY_TABLE = [instr].[TimeZone_H])
)
GO
/****** Object:  Table [instr].[Exchange_H]    Script Date: 23/08/2023 15:39:47 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [instr].[Exchange_H](
	[ExchangeId] [smallint] NOT NULL,
	[Symbol] [nvarchar](5) NOT NULL,
	[Name] [nvarchar](150) NOT NULL,
	[CountryId] [smallint] NOT NULL,
	[CurrencyId] [tinyint] NOT NULL,
	[TimeZoneId] [smallint] NOT NULL,
	[FirstSessionStartTime] [time](7) NOT NULL,
	[LastSessionEndTime] [time](7) NOT NULL,
	[ValidFrom] [datetime2](2) NOT NULL,
	[ValidTo] [datetime2](2) NOT NULL
) ON [PRIMARY]
WITH
(
DATA_COMPRESSION = PAGE
)
GO
/****** Object:  Index [ix_Exchange_H]    Script Date: 23/08/2023 15:39:47 ******/
CREATE CLUSTERED INDEX [ix_Exchange_H] ON [instr].[Exchange_H]
(
	[ValidTo] ASC,
	[ValidFrom] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, SORT_IN_TEMPDB = OFF, DROP_EXISTING = OFF, ONLINE = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF, DATA_COMPRESSION = PAGE) ON [PRIMARY]
GO
/****** Object:  Table [instr].[Exchange]    Script Date: 23/08/2023 15:39:47 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [instr].[Exchange](
	[ExchangeId] [smallint] IDENTITY(1,1) NOT NULL,
	[Symbol] [nvarchar](5) NOT NULL,
	[Name] [nvarchar](150) NOT NULL,
	[CountryId] [smallint] NOT NULL,
	[CurrencyId] [tinyint] NOT NULL,
	[TimeZoneId] [smallint] NOT NULL,
	[FirstSessionStartTime] [time](7) NOT NULL,
	[LastSessionEndTime] [time](7) NOT NULL,
	[ValidFrom] [datetime2](2) GENERATED ALWAYS AS ROW START NOT NULL,
	[ValidTo] [datetime2](2) GENERATED ALWAYS AS ROW END NOT NULL,
 CONSTRAINT [PK_ExchangeId] PRIMARY KEY CLUSTERED 
(
	[ExchangeId] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY],
 CONSTRAINT [UC_ExchangeSymbol] UNIQUE NONCLUSTERED 
(
	[Symbol] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY],
	PERIOD FOR SYSTEM_TIME ([ValidFrom], [ValidTo])
) ON [PRIMARY]
WITH
(
SYSTEM_VERSIONING = ON (HISTORY_TABLE = [instr].[Exchange_H])
)
GO
/****** Object:  Table [instr].[Cfd_H]    Script Date: 23/08/2023 15:39:47 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [instr].[Cfd_H](
	[CfdId] [int] NOT NULL,
	[UnderlyingInstrumentId] [int] NOT NULL,
	[ValidFrom] [datetime2](2) NOT NULL,
	[ValidTo] [datetime2](2) NOT NULL
) ON [PRIMARY]
WITH
(
DATA_COMPRESSION = PAGE
)
GO
/****** Object:  Index [ix_Cfd_H]    Script Date: 23/08/2023 15:39:47 ******/
CREATE CLUSTERED INDEX [ix_Cfd_H] ON [instr].[Cfd_H]
(
	[ValidTo] ASC,
	[ValidFrom] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, SORT_IN_TEMPDB = OFF, DROP_EXISTING = OFF, ONLINE = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF, DATA_COMPRESSION = PAGE) ON [PRIMARY]
GO
/****** Object:  Table [instr].[Cfd]    Script Date: 23/08/2023 15:39:47 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [instr].[Cfd](
	[CfdId] [int] NOT NULL,
	[UnderlyingInstrumentId] [int] NOT NULL,
	[ValidFrom] [datetime2](2) GENERATED ALWAYS AS ROW START NOT NULL,
	[ValidTo] [datetime2](2) GENERATED ALWAYS AS ROW END NOT NULL,
 CONSTRAINT [PK_Cfd] PRIMARY KEY CLUSTERED 
(
	[CfdId] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY],
 CONSTRAINT [UC_Cfd_UnderlyingInstrument] UNIQUE NONCLUSTERED 
(
	[UnderlyingInstrumentId] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY],
	PERIOD FOR SYSTEM_TIME ([ValidFrom], [ValidTo])
) ON [PRIMARY]
WITH
(
SYSTEM_VERSIONING = ON (HISTORY_TABLE = [instr].[Cfd_H])
)
GO
/****** Object:  Table [conv].[FutureConversionRule_H]    Script Date: 23/08/2023 15:39:47 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [conv].[FutureConversionRule_H](
	[FutureConversionRuleId] [int] NOT NULL,
	[PortfolioId] [tinyint] NULL,
	[ConvertToCurrencyPair] [bit] NOT NULL,
	[ValidFrom] [datetime2](2) NOT NULL,
	[ValidTo] [datetime2](2) NOT NULL
) ON [PRIMARY]
WITH
(
DATA_COMPRESSION = PAGE
)
GO
/****** Object:  Index [ix_FutureConversionRule_H]    Script Date: 23/08/2023 15:39:47 ******/
CREATE CLUSTERED INDEX [ix_FutureConversionRule_H] ON [conv].[FutureConversionRule_H]
(
	[ValidTo] ASC,
	[ValidFrom] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, SORT_IN_TEMPDB = OFF, DROP_EXISTING = OFF, ONLINE = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF, DATA_COMPRESSION = PAGE) ON [PRIMARY]
GO
/****** Object:  Table [conv].[FutureConversionRule]    Script Date: 23/08/2023 15:39:47 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [conv].[FutureConversionRule](
	[FutureConversionRuleId] [int] IDENTITY(1,1) NOT NULL,
	[PortfolioId] [tinyint] NULL,
	[ConvertToCurrencyPair] [bit] NOT NULL,
	[ValidFrom] [datetime2](2) GENERATED ALWAYS AS ROW START NOT NULL,
	[ValidTo] [datetime2](2) GENERATED ALWAYS AS ROW END NOT NULL,
 CONSTRAINT [PK_FutureConversionRule] PRIMARY KEY CLUSTERED 
(
	[FutureConversionRuleId] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY],
	PERIOD FOR SYSTEM_TIME ([ValidFrom], [ValidTo])
) ON [PRIMARY]
WITH
(
SYSTEM_VERSIONING = ON (HISTORY_TABLE = [conv].[FutureConversionRule_H])
)
GO
/****** Object:  Table [conv].[EquityConversionRule_H]    Script Date: 23/08/2023 15:39:47 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [conv].[EquityConversionRule_H](
	[EquityConversionRuleId] [int] NOT NULL,
	[PortfolioId] [tinyint] NULL,
	[ConvertToCfd] [bit] NOT NULL,
	[ValidFrom] [datetime2](2) NOT NULL,
	[ValidTo] [datetime2](2) NOT NULL
) ON [PRIMARY]
WITH
(
DATA_COMPRESSION = PAGE
)
GO
/****** Object:  Index [ix_EquityConversionRule_H]    Script Date: 23/08/2023 15:39:47 ******/
CREATE CLUSTERED INDEX [ix_EquityConversionRule_H] ON [conv].[EquityConversionRule_H]
(
	[ValidTo] ASC,
	[ValidFrom] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, SORT_IN_TEMPDB = OFF, DROP_EXISTING = OFF, ONLINE = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF, DATA_COMPRESSION = PAGE) ON [PRIMARY]
GO
/****** Object:  Table [conv].[EquityConversionRule]    Script Date: 23/08/2023 15:39:47 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [conv].[EquityConversionRule](
	[EquityConversionRuleId] [int] IDENTITY(1,1) NOT NULL,
	[PortfolioId] [tinyint] NULL,
	[ConvertToCfd] [bit] NOT NULL,
	[ValidFrom] [datetime2](2) GENERATED ALWAYS AS ROW START NOT NULL,
	[ValidTo] [datetime2](2) GENERATED ALWAYS AS ROW END NOT NULL,
 CONSTRAINT [PK_EquityConversionRule] PRIMARY KEY CLUSTERED 
(
	[EquityConversionRuleId] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY],
	PERIOD FOR SYSTEM_TIME ([ValidFrom], [ValidTo])
) ON [PRIMARY]
WITH
(
SYSTEM_VERSIONING = ON (HISTORY_TABLE = [conv].[EquityConversionRule_H])
)
GO
/****** Object:  Table [instr].[CurrencyPair_H]    Script Date: 23/08/2023 15:39:47 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [instr].[CurrencyPair_H](
	[CurrencyPairId] [int] NOT NULL,
	[BaseCurrencyId] [tinyint] NOT NULL,
	[QuoteCurrencyId] [tinyint] NOT NULL,
	[ValidFrom] [datetime2](2) NOT NULL,
	[ValidTo] [datetime2](2) NOT NULL
) ON [PRIMARY]
WITH
(
DATA_COMPRESSION = PAGE
)
GO
/****** Object:  Index [ix_CurrencyPair_H]    Script Date: 23/08/2023 15:39:47 ******/
CREATE CLUSTERED INDEX [ix_CurrencyPair_H] ON [instr].[CurrencyPair_H]
(
	[ValidTo] ASC,
	[ValidFrom] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, SORT_IN_TEMPDB = OFF, DROP_EXISTING = OFF, ONLINE = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF, DATA_COMPRESSION = PAGE) ON [PRIMARY]
GO
/****** Object:  Table [instr].[CurrencyPair]    Script Date: 23/08/2023 15:39:47 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [instr].[CurrencyPair](
	[CurrencyPairId] [int] NOT NULL,
	[BaseCurrencyId] [tinyint] NOT NULL,
	[QuoteCurrencyId] [tinyint] NOT NULL,
	[ValidFrom] [datetime2](2) GENERATED ALWAYS AS ROW START NOT NULL,
	[ValidTo] [datetime2](2) GENERATED ALWAYS AS ROW END NOT NULL,
 CONSTRAINT [PK_CurrencyPair] PRIMARY KEY CLUSTERED 
(
	[CurrencyPairId] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY],
 CONSTRAINT [UC_CurrencyPair] UNIQUE NONCLUSTERED 
(
	[BaseCurrencyId] ASC,
	[QuoteCurrencyId] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY],
	PERIOD FOR SYSTEM_TIME ([ValidFrom], [ValidTo])
) ON [PRIMARY]
WITH
(
SYSTEM_VERSIONING = ON (HISTORY_TABLE = [instr].[CurrencyPair_H])
)
GO
/****** Object:  Table [instr].[InstrumentType_H]    Script Date: 23/08/2023 15:39:47 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [instr].[InstrumentType_H](
	[InstrumentTypeId] [tinyint] NOT NULL,
	[Mnemonic] [nvarchar](10) NOT NULL,
	[Description] [nvarchar](100) NOT NULL,
	[ValidFrom] [datetime2](2) NOT NULL,
	[ValidTo] [datetime2](2) NOT NULL
) ON [PRIMARY]
WITH
(
DATA_COMPRESSION = PAGE
)
GO
/****** Object:  Index [ix_InstrumentType_H]    Script Date: 23/08/2023 15:39:53 ******/
CREATE CLUSTERED INDEX [ix_InstrumentType_H] ON [instr].[InstrumentType_H]
(
	[ValidTo] ASC,
	[ValidFrom] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, SORT_IN_TEMPDB = OFF, DROP_EXISTING = OFF, ONLINE = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF, DATA_COMPRESSION = PAGE) ON [PRIMARY]
GO
/****** Object:  Table [instr].[InstrumentType]    Script Date: 23/08/2023 15:39:53 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [instr].[InstrumentType](
	[InstrumentTypeId] [tinyint] IDENTITY(1,1) NOT NULL,
	[Mnemonic] [nvarchar](10) NOT NULL,
	[Description] [nvarchar](100) NOT NULL,
	[ValidFrom] [datetime2](2) GENERATED ALWAYS AS ROW START NOT NULL,
	[ValidTo] [datetime2](2) GENERATED ALWAYS AS ROW END NOT NULL,
 CONSTRAINT [PK_InstrumentTypeId] PRIMARY KEY CLUSTERED 
(
	[InstrumentTypeId] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY],
 CONSTRAINT [UC_InstrumentType_Mnemonic] UNIQUE NONCLUSTERED 
(
	[Mnemonic] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY],
	PERIOD FOR SYSTEM_TIME ([ValidFrom], [ValidTo])
) ON [PRIMARY]
WITH
(
SYSTEM_VERSIONING = ON (HISTORY_TABLE = [instr].[InstrumentType_H])
)
GO
/****** Object:  Table [instr].[Country_H]    Script Date: 23/08/2023 15:39:53 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [instr].[Country_H](
	[CountryId] [smallint] NOT NULL,
	[Name] [nvarchar](200) NOT NULL,
	[IsoAlpha2Code] [char](2) NOT NULL,
	[ValidFrom] [datetime2](2) NOT NULL,
	[ValidTo] [datetime2](2) NOT NULL
) ON [PRIMARY]
WITH
(
DATA_COMPRESSION = PAGE
)
GO
/****** Object:  Index [ix_Country_H]    Script Date: 23/08/2023 15:39:53 ******/
CREATE CLUSTERED INDEX [ix_Country_H] ON [instr].[Country_H]
(
	[ValidTo] ASC,
	[ValidFrom] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, SORT_IN_TEMPDB = OFF, DROP_EXISTING = OFF, ONLINE = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF, DATA_COMPRESSION = PAGE) ON [PRIMARY]
GO
/****** Object:  Table [instr].[Country]    Script Date: 23/08/2023 15:39:53 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [instr].[Country](
	[CountryId] [smallint] IDENTITY(1,1) NOT NULL,
	[Name] [nvarchar](200) NOT NULL,
	[IsoAlpha2Code] [char](2) NOT NULL,
	[ValidFrom] [datetime2](2) GENERATED ALWAYS AS ROW START NOT NULL,
	[ValidTo] [datetime2](2) GENERATED ALWAYS AS ROW END NOT NULL,
 CONSTRAINT [PK_CountryId] PRIMARY KEY CLUSTERED 
(
	[CountryId] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY],
 CONSTRAINT [UC_IsoAlpha2Code] UNIQUE NONCLUSTERED 
(
	[IsoAlpha2Code] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY],
	PERIOD FOR SYSTEM_TIME ([ValidFrom], [ValidTo])
) ON [PRIMARY]
WITH
(
SYSTEM_VERSIONING = ON (HISTORY_TABLE = [instr].[Country_H])
)
GO
/****** Object:  Table [instr].[Currency_H]    Script Date: 23/08/2023 15:39:53 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [instr].[Currency_H](
	[CurrencyId] [tinyint] NOT NULL,
	[Code] [char](3) NULL,
	[Name] [nvarchar](200) NOT NULL,
	[ValidFrom] [datetime2](2) NOT NULL,
	[ValidTo] [datetime2](2) NOT NULL
) ON [PRIMARY]
WITH
(
DATA_COMPRESSION = PAGE
)
GO
/****** Object:  Index [ix_Currency_H]    Script Date: 23/08/2023 15:39:53 ******/
CREATE CLUSTERED INDEX [ix_Currency_H] ON [instr].[Currency_H]
(
	[ValidTo] ASC,
	[ValidFrom] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, SORT_IN_TEMPDB = OFF, DROP_EXISTING = OFF, ONLINE = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF, DATA_COMPRESSION = PAGE) ON [PRIMARY]
GO
/****** Object:  Table [instr].[Currency]    Script Date: 23/08/2023 15:39:53 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [instr].[Currency](
	[CurrencyId] [tinyint] IDENTITY(1,1) NOT NULL,
	[Code] [char](3) NULL,
	[Name] [nvarchar](200) NOT NULL,
	[ValidFrom] [datetime2](2) GENERATED ALWAYS AS ROW START NOT NULL,
	[ValidTo] [datetime2](2) GENERATED ALWAYS AS ROW END NOT NULL,
 CONSTRAINT [PK_Currency] PRIMARY KEY CLUSTERED 
(
	[CurrencyId] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY],
 CONSTRAINT [UC_Currency_Code] UNIQUE NONCLUSTERED 
(
	[Code] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY],
	PERIOD FOR SYSTEM_TIME ([ValidFrom], [ValidTo])
) ON [PRIMARY]
WITH
(
SYSTEM_VERSIONING = ON (HISTORY_TABLE = [instr].[Currency_H])
)
GO
/****** Object:  Table [ord].[Portfolio]    Script Date: 23/08/2023 15:39:53 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [ord].[Portfolio](
	[PortfolioId] [tinyint] NOT NULL,
	[Mnemonic] [nvarchar](6) NOT NULL,
	[Name] [nvarchar](50) NOT NULL,
	[Currency] [char](3) NOT NULL,
 CONSTRAINT [PK_PortfolioId] PRIMARY KEY CLUSTERED 
(
	[PortfolioId] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  Table [ord].[Broker]    Script Date: 23/08/2023 15:39:53 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [ord].[Broker](
	[BrokerId] [int] IDENTITY(1,1) NOT NULL,
	[Name] [nvarchar](30) NOT NULL,
	[Code] [nvarchar](10) NOT NULL,
	[ValidFrom] [datetime2](2) GENERATED ALWAYS AS ROW START NOT NULL,
	[ValidTo] [datetime2](2) GENERATED ALWAYS AS ROW END NOT NULL,
 CONSTRAINT [PK_Broker] PRIMARY KEY CLUSTERED 
(
	[BrokerId] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY],
	PERIOD FOR SYSTEM_TIME ([ValidFrom], [ValidTo])
) ON [PRIMARY]
GO
/****** Object:  Table [ord].[InstrumentType]    Script Date: 23/08/2023 15:39:53 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [ord].[InstrumentType](
	[InstrumentTypeId] [tinyint] NOT NULL,
	[Mnemonic] [nvarchar](10) NOT NULL,
	[Description] [nvarchar](100) NOT NULL,
 CONSTRAINT [PK_InstrumentTypeId] PRIMARY KEY CLUSTERED 
(
	[InstrumentTypeId] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY],
 CONSTRAINT [UC_InstrumentType_Mnemonic] UNIQUE NONCLUSTERED 
(
	[Mnemonic] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  Table [ord].[TradingAccountSelectionRule_H]    Script Date: 23/08/2023 15:39:53 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [ord].[TradingAccountSelectionRule_H](
	[TradingAccountSelectionRuleId] [int] NOT NULL,
	[PortfolioId] [tinyint] NOT NULL,
	[BrokerId] [int] NOT NULL,
	[InstrumentTypeId] [tinyint] NOT NULL,
	[TradeModeId] [tinyint] NOT NULL,
	[TradingAccountId] [int] NOT NULL,
	[ValidFrom] [datetime2](2) NOT NULL,
	[ValidTo] [datetime2](2) NOT NULL
) ON [PRIMARY]
WITH
(
DATA_COMPRESSION = PAGE
)
GO
/****** Object:  Index [ix_TradingAccountSelectionRule_H]    Script Date: 23/08/2023 15:39:54 ******/
CREATE CLUSTERED INDEX [ix_TradingAccountSelectionRule_H] ON [ord].[TradingAccountSelectionRule_H]
(
	[ValidTo] ASC,
	[ValidFrom] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, SORT_IN_TEMPDB = OFF, DROP_EXISTING = OFF, ONLINE = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF, DATA_COMPRESSION = PAGE) ON [PRIMARY]
GO
/****** Object:  Table [ord].[TradingAccountSelectionRule]    Script Date: 23/08/2023 15:39:54 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [ord].[TradingAccountSelectionRule](
	[TradingAccountSelectionRuleId] [int] IDENTITY(1,1) NOT NULL,
	[PortfolioId] [tinyint] NOT NULL,
	[BrokerId] [int] NOT NULL,
	[InstrumentTypeId] [tinyint] NOT NULL,
	[TradeModeId] [tinyint] NOT NULL,
	[TradingAccountId] [int] NOT NULL,
	[ValidFrom] [datetime2](2) GENERATED ALWAYS AS ROW START NOT NULL,
	[ValidTo] [datetime2](2) GENERATED ALWAYS AS ROW END NOT NULL,
 CONSTRAINT [PK_TradingAccountSelectionRule] PRIMARY KEY CLUSTERED 
(
	[TradingAccountSelectionRuleId] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY],
	PERIOD FOR SYSTEM_TIME ([ValidFrom], [ValidTo])
) ON [PRIMARY]
WITH
(
SYSTEM_VERSIONING = ON (HISTORY_TABLE = [ord].[TradingAccountSelectionRule_H])
)
GO
/****** Object:  Table [ord].[TradingAccount_H]    Script Date: 23/08/2023 15:39:54 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [ord].[TradingAccount_H](
	[TradingAccountId] [int] NOT NULL,
	[Code] [nvarchar](50) NOT NULL,
	[BrokerId] [int] NOT NULL,
	[ValidFrom] [datetime2](2) NOT NULL,
	[ValidTo] [datetime2](2) NOT NULL
) ON [PRIMARY]
WITH
(
DATA_COMPRESSION = PAGE
)
GO
/****** Object:  Index [ix_TradingAccount_H]    Script Date: 23/08/2023 15:39:54 ******/
CREATE CLUSTERED INDEX [ix_TradingAccount_H] ON [ord].[TradingAccount_H]
(
	[ValidTo] ASC,
	[ValidFrom] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, SORT_IN_TEMPDB = OFF, DROP_EXISTING = OFF, ONLINE = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF, DATA_COMPRESSION = PAGE) ON [PRIMARY]
GO
/****** Object:  Table [ord].[TradingAccount]    Script Date: 23/08/2023 15:39:54 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [ord].[TradingAccount](
	[TradingAccountId] [int] IDENTITY(1,1) NOT NULL,
	[Code] [nvarchar](50) NOT NULL,
	[BrokerId] [int] NOT NULL,
	[ValidFrom] [datetime2](2) GENERATED ALWAYS AS ROW START NOT NULL,
	[ValidTo] [datetime2](2) GENERATED ALWAYS AS ROW END NOT NULL,
 CONSTRAINT [PK_TradingAccount] PRIMARY KEY CLUSTERED 
(
	[TradingAccountId] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY],
	PERIOD FOR SYSTEM_TIME ([ValidFrom], [ValidTo])
) ON [PRIMARY]
WITH
(
SYSTEM_VERSIONING = ON (HISTORY_TABLE = [ord].[TradingAccount_H])
)
GO
/****** Object:  Table [ord].[TradeMode]    Script Date: 23/08/2023 15:39:54 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [ord].[TradeMode](
	[TradeModeId] [tinyint] IDENTITY(1,1) NOT NULL,
	[Mnemonic] [nvarchar](10) NOT NULL,
	[Description] [nvarchar](200) NOT NULL,
	[ValidFrom] [datetime2](2) GENERATED ALWAYS AS ROW START NOT NULL,
	[ValidTo] [datetime2](2) GENERATED ALWAYS AS ROW END NOT NULL,
 CONSTRAINT [PK_TradeMode] PRIMARY KEY CLUSTERED 
(
	[TradeModeId] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY],
	PERIOD FOR SYSTEM_TIME ([ValidFrom], [ValidTo])
) ON [PRIMARY]
GO
/****** Object:  View [rep].[VwTradingAccountSelectionRule]    Script Date: 23/08/2023 15:39:54 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
/****** Script for SelectTopNRows command from SSMS  ******/

CREATE VIEW [rep].[VwTradingAccountSelectionRule] as
SELECT  [TradingAccountSelectionRuleId]
      ,rl.[PortfolioId]
	  ,pf.Name as [Portfolio]
	  , br.Name as [Broker]
	  , it.Mnemonic as [Instrument Type]
	  , tm.Mnemonic as [Trade Mode]
	  , ta.Code as  [Selected Trading Account]
from [ord].[TradingAccountSelectionRule] rl
    JOIN ord.Portfolio pf on pf.PortfolioId = rl.PortfolioId
  JOIN ord.Broker br on br.BrokerId = rl.BrokerId
  JOIN ord.InstrumentType it on it.InstrumentTypeId = rl.InstrumentTypeId
  JOIN ord.TradeMode tm on tm.TradeModeId = rl.TradeModeId
  JOIN ord.TradingAccount ta on ta.TradingAccountId = rl.TradingAccountId
GO
/****** Object:  Table [ord].[Instrument]    Script Date: 23/08/2023 15:39:54 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [ord].[Instrument](
	[InstrumentId] [int] NOT NULL,
	[InstrumentTypeId] [tinyint] NOT NULL,
	[Symbol] [nvarchar](30) NOT NULL,
	[Name] [nvarchar](100) NOT NULL,
	[Currency] [char](3) NOT NULL,
	[Exchange] [nvarchar](5) NULL,
	[MarketSector] [nvarchar](6) NOT NULL,
 CONSTRAINT [PK_InstrumentId] PRIMARY KEY CLUSTERED 
(
	[InstrumentId] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  Table [ord].[TradeModeSelectionRule_H]    Script Date: 23/08/2023 15:39:54 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [ord].[TradeModeSelectionRule_H](
	[TradeModeSelectionRuleId] [int] NOT NULL,
	[PortfolioId] [tinyint] NOT NULL,
	[BrokerId] [int] NOT NULL,
	[InstrumentId] [int] NOT NULL,
	[TradeModeId] [tinyint] NOT NULL,
	[ValidFrom] [datetime2](2) NOT NULL,
	[ValidTo] [datetime2](2) NOT NULL
) ON [PRIMARY]
WITH
(
DATA_COMPRESSION = PAGE
)
GO
/****** Object:  Index [ix_TradeModeSelectionRule_H]    Script Date: 23/08/2023 15:39:54 ******/
CREATE CLUSTERED INDEX [ix_TradeModeSelectionRule_H] ON [ord].[TradeModeSelectionRule_H]
(
	[ValidTo] ASC,
	[ValidFrom] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, SORT_IN_TEMPDB = OFF, DROP_EXISTING = OFF, ONLINE = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF, DATA_COMPRESSION = PAGE) ON [PRIMARY]
GO
/****** Object:  Table [ord].[TradeModeSelectionRule]    Script Date: 23/08/2023 15:39:54 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [ord].[TradeModeSelectionRule](
	[TradeModeSelectionRuleId] [int] IDENTITY(1,1) NOT NULL,
	[PortfolioId] [tinyint] NOT NULL,
	[BrokerId] [int] NOT NULL,
	[InstrumentId] [int] NOT NULL,
	[TradeModeId] [tinyint] NOT NULL,
	[ValidFrom] [datetime2](2) GENERATED ALWAYS AS ROW START NOT NULL,
	[ValidTo] [datetime2](2) GENERATED ALWAYS AS ROW END NOT NULL,
 CONSTRAINT [PK_TradeModeSelectionRule] PRIMARY KEY CLUSTERED 
(
	[TradeModeSelectionRuleId] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY],
	PERIOD FOR SYSTEM_TIME ([ValidFrom], [ValidTo])
) ON [PRIMARY]
WITH
(
SYSTEM_VERSIONING = ON (HISTORY_TABLE = [ord].[TradeModeSelectionRule_H])
)
GO
/****** Object:  View [rep].[VwTradeModeRule]    Script Date: 23/08/2023 15:39:54 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

/****** Script for SelectTopNRows command from SSMS  ******/

CREATE VIEW [rep].[VwTradeModeRule] as
SELECT rl.PortfolioId
	  , pf.Name as Portfolio
      ,br.Name as Broker
      ,ins.Symbol as Instrument
	  ,tm.Mnemonic as TradeMode

  FROM [Trading].[ord].[TradeModeSelectionRule] rl
      JOIN ord.Portfolio pf on pf.PortfolioId = rl.PortfolioId
  JOIN ord.Broker br on br.BrokerId = rl.BrokerId
  JOIN ord.Instrument ins on ins.InstrumentId = rl.InstrumentId
  JOIN ord.TradeMode tm on tm.TradeModeId = rl.TradeModeId

GO
/****** Object:  Table [ord].[OrderType_H]    Script Date: 23/08/2023 15:39:54 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [ord].[OrderType_H](
	[OrderTypeId] [int] NOT NULL,
	[Mnemonic] [nvarchar](10) NOT NULL,
	[Name] [nvarchar](50) NOT NULL,
	[Description] [nvarchar](200) NOT NULL,
	[ValidFrom] [datetime2](2) NOT NULL,
	[ValidTo] [datetime2](2) NOT NULL
) ON [PRIMARY]
WITH
(
DATA_COMPRESSION = PAGE
)
GO
/****** Object:  Index [ix_OrderType_H]    Script Date: 23/08/2023 15:39:54 ******/
CREATE CLUSTERED INDEX [ix_OrderType_H] ON [ord].[OrderType_H]
(
	[ValidTo] ASC,
	[ValidFrom] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, SORT_IN_TEMPDB = OFF, DROP_EXISTING = OFF, ONLINE = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF, DATA_COMPRESSION = PAGE) ON [PRIMARY]
GO
/****** Object:  Table [ord].[OrderType]    Script Date: 23/08/2023 15:39:54 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [ord].[OrderType](
	[OrderTypeId] [int] IDENTITY(1,1) NOT NULL,
	[Mnemonic] [nvarchar](10) NOT NULL,
	[Name] [nvarchar](50) NOT NULL,
	[Description] [nvarchar](200) NOT NULL,
	[ValidFrom] [datetime2](2) GENERATED ALWAYS AS ROW START NOT NULL,
	[ValidTo] [datetime2](2) GENERATED ALWAYS AS ROW END NOT NULL,
 CONSTRAINT [PK_OrderType] PRIMARY KEY CLUSTERED 
(
	[OrderTypeId] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY],
	PERIOD FOR SYSTEM_TIME ([ValidFrom], [ValidTo])
) ON [PRIMARY]
WITH
(
SYSTEM_VERSIONING = ON (HISTORY_TABLE = [ord].[OrderType_H])
)
GO
/****** Object:  Table [ord].[ExecutionAlgorithm_H]    Script Date: 23/08/2023 15:39:54 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [ord].[ExecutionAlgorithm_H](
	[ExecutionAlgorithmId] [int] NOT NULL,
	[Mnmemonic] [nvarchar](10) NOT NULL,
	[Name] [nvarchar](50) NOT NULL,
	[ValidFrom] [datetime2](2) NOT NULL,
	[ValidTo] [datetime2](2) NOT NULL
) ON [PRIMARY]
WITH
(
DATA_COMPRESSION = PAGE
)
GO
/****** Object:  Index [ix_ExecutionAlgorithm_H]    Script Date: 23/08/2023 15:39:54 ******/
CREATE CLUSTERED INDEX [ix_ExecutionAlgorithm_H] ON [ord].[ExecutionAlgorithm_H]
(
	[ValidTo] ASC,
	[ValidFrom] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, SORT_IN_TEMPDB = OFF, DROP_EXISTING = OFF, ONLINE = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF, DATA_COMPRESSION = PAGE) ON [PRIMARY]
GO
/****** Object:  Table [ord].[ExecutionAlgorithm]    Script Date: 23/08/2023 15:39:54 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [ord].[ExecutionAlgorithm](
	[ExecutionAlgorithmId] [int] IDENTITY(1,1) NOT NULL,
	[Mnmemonic] [nvarchar](10) NOT NULL,
	[Name] [nvarchar](50) NOT NULL,
	[ValidFrom] [datetime2](2) GENERATED ALWAYS AS ROW START NOT NULL,
	[ValidTo] [datetime2](2) GENERATED ALWAYS AS ROW END NOT NULL,
 CONSTRAINT [PK_ExecutionAlgorithm] PRIMARY KEY CLUSTERED 
(
	[ExecutionAlgorithmId] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY],
	PERIOD FOR SYSTEM_TIME ([ValidFrom], [ValidTo])
) ON [PRIMARY]
WITH
(
SYSTEM_VERSIONING = ON (HISTORY_TABLE = [ord].[ExecutionAlgorithm_H])
)
GO
/****** Object:  Table [ord].[ExecutionChannel_H]    Script Date: 23/08/2023 15:39:54 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [ord].[ExecutionChannel_H](
	[ExecutionChannelId] [tinyint] NOT NULL,
	[Mnemonic] [nvarchar](10) NOT NULL,
	[Description] [nvarchar](200) NOT NULL,
	[ValidFrom] [datetime2](2) NOT NULL,
	[ValidTo] [datetime2](2) NOT NULL
) ON [PRIMARY]
WITH
(
DATA_COMPRESSION = PAGE
)
GO
/****** Object:  Index [ix_ExecutionChannel_H]    Script Date: 23/08/2023 15:39:54 ******/
CREATE CLUSTERED INDEX [ix_ExecutionChannel_H] ON [ord].[ExecutionChannel_H]
(
	[ValidTo] ASC,
	[ValidFrom] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, SORT_IN_TEMPDB = OFF, DROP_EXISTING = OFF, ONLINE = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF, DATA_COMPRESSION = PAGE) ON [PRIMARY]
GO
/****** Object:  Table [ord].[ExecutionChannel]    Script Date: 23/08/2023 15:39:54 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [ord].[ExecutionChannel](
	[ExecutionChannelId] [tinyint] IDENTITY(1,1) NOT NULL,
	[Mnemonic] [nvarchar](10) NOT NULL,
	[Description] [nvarchar](200) NOT NULL,
	[ValidFrom] [datetime2](2) GENERATED ALWAYS AS ROW START NOT NULL,
	[ValidTo] [datetime2](2) GENERATED ALWAYS AS ROW END NOT NULL,
 CONSTRAINT [PK_ExecutionChannel] PRIMARY KEY CLUSTERED 
(
	[ExecutionChannelId] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY],
	PERIOD FOR SYSTEM_TIME ([ValidFrom], [ValidTo])
) ON [PRIMARY]
WITH
(
SYSTEM_VERSIONING = ON (HISTORY_TABLE = [ord].[ExecutionChannel_H])
)
GO
/****** Object:  Table [ord].[HandlingInstruction_H]    Script Date: 23/08/2023 15:39:54 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [ord].[HandlingInstruction_H](
	[HandlingInstructionId] [int] NOT NULL,
	[Code] [nvarchar](10) NOT NULL,
	[Description] [nvarchar](200) NULL,
	[ValidFrom] [datetime2](2) NOT NULL,
	[ValidTo] [datetime2](2) NOT NULL
) ON [PRIMARY]
WITH
(
DATA_COMPRESSION = PAGE
)
GO
/****** Object:  Index [ix_HandlingInstruction_H]    Script Date: 23/08/2023 15:39:54 ******/
CREATE CLUSTERED INDEX [ix_HandlingInstruction_H] ON [ord].[HandlingInstruction_H]
(
	[ValidTo] ASC,
	[ValidFrom] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, SORT_IN_TEMPDB = OFF, DROP_EXISTING = OFF, ONLINE = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF, DATA_COMPRESSION = PAGE) ON [PRIMARY]
GO
/****** Object:  Table [ord].[HandlingInstruction]    Script Date: 23/08/2023 15:39:54 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [ord].[HandlingInstruction](
	[HandlingInstructionId] [int] IDENTITY(1,1) NOT NULL,
	[Code] [nvarchar](10) NOT NULL,
	[Description] [nvarchar](200) NULL,
	[ValidFrom] [datetime2](2) GENERATED ALWAYS AS ROW START NOT NULL,
	[ValidTo] [datetime2](2) GENERATED ALWAYS AS ROW END NOT NULL,
 CONSTRAINT [PK_HandlingInstruction] PRIMARY KEY CLUSTERED 
(
	[HandlingInstructionId] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY],
	PERIOD FOR SYSTEM_TIME ([ValidFrom], [ValidTo])
) ON [PRIMARY]
WITH
(
SYSTEM_VERSIONING = ON (HISTORY_TABLE = [ord].[HandlingInstruction_H])
)
GO
/****** Object:  Table [ord].[ExecutionAlgorithmParamSet_H]    Script Date: 23/08/2023 15:39:54 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [ord].[ExecutionAlgorithmParamSet_H](
	[ExecutionAlgorithmParamSetId] [int] NOT NULL,
	[ExecutionAlgorithmId] [int] NOT NULL,
	[Param1] [nvarchar](30) NOT NULL,
	[Value1] [nvarchar](30) NULL,
	[Param2] [nvarchar](30) NULL,
	[Value2] [nvarchar](30) NULL,
	[Param3] [nvarchar](30) NULL,
	[Value3] [nvarchar](30) NULL,
	[Param4] [nvarchar](30) NULL,
	[Value4] [nvarchar](30) NULL,
	[Param5] [nvarchar](30) NULL,
	[Value5] [nvarchar](30) NULL,
	[Param6] [nvarchar](30) NULL,
	[Value6] [nvarchar](30) NULL,
	[Param7] [nvarchar](30) NULL,
	[Value7] [nvarchar](30) NULL,
	[Param8] [nvarchar](30) NULL,
	[Value8] [nvarchar](30) NULL,
	[ValidFrom] [datetime2](2) NOT NULL,
	[ValidTo] [datetime2](2) NOT NULL
) ON [PRIMARY]
WITH
(
DATA_COMPRESSION = PAGE
)
GO
/****** Object:  Index [ix_ExecutionAlgorithmParamSet_H]    Script Date: 23/08/2023 15:39:54 ******/
CREATE CLUSTERED INDEX [ix_ExecutionAlgorithmParamSet_H] ON [ord].[ExecutionAlgorithmParamSet_H]
(
	[ValidTo] ASC,
	[ValidFrom] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, SORT_IN_TEMPDB = OFF, DROP_EXISTING = OFF, ONLINE = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF, DATA_COMPRESSION = PAGE) ON [PRIMARY]
GO
/****** Object:  Table [ord].[ExecutionAlgorithmParamSet]    Script Date: 23/08/2023 15:39:54 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [ord].[ExecutionAlgorithmParamSet](
	[ExecutionAlgorithmParamSetId] [int] IDENTITY(1,1) NOT NULL,
	[ExecutionAlgorithmId] [int] NOT NULL,
	[Param1] [nvarchar](30) NOT NULL,
	[Value1] [nvarchar](30) NULL,
	[Param2] [nvarchar](30) NULL,
	[Value2] [nvarchar](30) NULL,
	[Param3] [nvarchar](30) NULL,
	[Value3] [nvarchar](30) NULL,
	[Param4] [nvarchar](30) NULL,
	[Value4] [nvarchar](30) NULL,
	[Param5] [nvarchar](30) NULL,
	[Value5] [nvarchar](30) NULL,
	[Param6] [nvarchar](30) NULL,
	[Value6] [nvarchar](30) NULL,
	[Param7] [nvarchar](30) NULL,
	[Value7] [nvarchar](30) NULL,
	[Param8] [nvarchar](30) NULL,
	[Value8] [nvarchar](30) NULL,
	[ValidFrom] [datetime2](2) GENERATED ALWAYS AS ROW START NOT NULL,
	[ValidTo] [datetime2](2) GENERATED ALWAYS AS ROW END NOT NULL,
 CONSTRAINT [PK_ExecutionAlgorithmParamSet] PRIMARY KEY CLUSTERED 
(
	[ExecutionAlgorithmParamSetId] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY],
	PERIOD FOR SYSTEM_TIME ([ValidFrom], [ValidTo])
) ON [PRIMARY]
WITH
(
SYSTEM_VERSIONING = ON (HISTORY_TABLE = [ord].[ExecutionAlgorithmParamSet_H])
)
GO
/****** Object:  Table [ord].[TimeInForce_H]    Script Date: 23/08/2023 15:39:54 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [ord].[TimeInForce_H](
	[TimeInForceId] [tinyint] NOT NULL,
	[Mnemonic] [nvarchar](10) NOT NULL,
	[Name] [nvarchar](50) NOT NULL,
	[Description] [nvarchar](200) NOT NULL,
	[ValidFrom] [datetime2](2) NOT NULL,
	[ValidTo] [datetime2](2) NOT NULL
) ON [PRIMARY]
WITH
(
DATA_COMPRESSION = PAGE
)
GO
/****** Object:  Index [ix_TimeInForce_H]    Script Date: 23/08/2023 15:39:54 ******/
CREATE CLUSTERED INDEX [ix_TimeInForce_H] ON [ord].[TimeInForce_H]
(
	[ValidTo] ASC,
	[ValidFrom] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, SORT_IN_TEMPDB = OFF, DROP_EXISTING = OFF, ONLINE = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF, DATA_COMPRESSION = PAGE) ON [PRIMARY]
GO
/****** Object:  Table [ord].[TimeInForce]    Script Date: 23/08/2023 15:39:54 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [ord].[TimeInForce](
	[TimeInForceId] [tinyint] IDENTITY(1,1) NOT NULL,
	[Mnemonic] [nvarchar](10) NOT NULL,
	[Name] [nvarchar](50) NOT NULL,
	[Description] [nvarchar](200) NOT NULL,
	[ValidFrom] [datetime2](2) GENERATED ALWAYS AS ROW START NOT NULL,
	[ValidTo] [datetime2](2) GENERATED ALWAYS AS ROW END NOT NULL,
 CONSTRAINT [PK_TimeInForce] PRIMARY KEY CLUSTERED 
(
	[TimeInForceId] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY],
	PERIOD FOR SYSTEM_TIME ([ValidFrom], [ValidTo])
) ON [PRIMARY]
WITH
(
SYSTEM_VERSIONING = ON (HISTORY_TABLE = [ord].[TimeInForce_H])
)
GO
/****** Object:  Table [ord].[ExecutionProfile_H]    Script Date: 23/08/2023 15:39:54 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [ord].[ExecutionProfile_H](
	[ExecutionProfileId] [int] NOT NULL,
	[OrderTypeId] [int] NOT NULL,
	[TimeInForceId] [tinyint] NOT NULL,
	[ExecutionAlgorithmId] [int] NOT NULL,
	[ExecutionAlgorithmParamSetId] [int] NULL,
	[HandlingInstructionId] [int] NOT NULL,
	[ExecutionChannelId] [tinyint] NOT NULL,
	[ValidFrom] [datetime2](2) NOT NULL,
	[ValidTo] [datetime2](2) NOT NULL
) ON [PRIMARY]
WITH
(
DATA_COMPRESSION = PAGE
)
GO
/****** Object:  Index [ix_ExecutionProfile_H]    Script Date: 23/08/2023 15:39:54 ******/
CREATE CLUSTERED INDEX [ix_ExecutionProfile_H] ON [ord].[ExecutionProfile_H]
(
	[ValidTo] ASC,
	[ValidFrom] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, SORT_IN_TEMPDB = OFF, DROP_EXISTING = OFF, ONLINE = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF, DATA_COMPRESSION = PAGE) ON [PRIMARY]
GO
/****** Object:  Table [ord].[ExecutionProfile]    Script Date: 23/08/2023 15:39:54 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [ord].[ExecutionProfile](
	[ExecutionProfileId] [int] IDENTITY(1,1) NOT NULL,
	[OrderTypeId] [int] NOT NULL,
	[TimeInForceId] [tinyint] NOT NULL,
	[ExecutionAlgorithmId] [int] NOT NULL,
	[ExecutionAlgorithmParamSetId] [int] NULL,
	[HandlingInstructionId] [int] NOT NULL,
	[ExecutionChannelId] [tinyint] NOT NULL,
	[ValidFrom] [datetime2](2) GENERATED ALWAYS AS ROW START NOT NULL,
	[ValidTo] [datetime2](2) GENERATED ALWAYS AS ROW END NOT NULL,
 CONSTRAINT [PK_ ExecutionProfile] PRIMARY KEY CLUSTERED 
(
	[ExecutionProfileId] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY],
	PERIOD FOR SYSTEM_TIME ([ValidFrom], [ValidTo])
) ON [PRIMARY]
WITH
(
SYSTEM_VERSIONING = ON (HISTORY_TABLE = [ord].[ExecutionProfile_H])
)
GO
/****** Object:  View [rep].[VwExecutionProfile]    Script Date: 23/08/2023 15:39:54 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
/****** Script for SelectTopNRows command from SSMS  ******/

CREATE VIEW [rep].[VwExecutionProfile] as
SELECT  [ExecutionProfileId]
      ,ot.Mnemonic as OrderType
	  , tf.Mnemonic as TimeInForce
	  , ea.Mnmemonic as ExecutionAlgorithm
	  ,hi.Code as HandlingInstruction
	  , ec.Mnemonic as ExecutionChannel
	  , ps.Param1 
	  ,ps.Value1
	  	  , ps.Param2
	  ,ps.Value2
	  	  , ps.Param3
	  ,ps.Value3
	  	  , ps.Param4
	  ,ps.Value4
	  	  , ps.Param5
	  ,ps.Value5
	  	  , ps.Param6
	  ,ps.Value6
  FROM [Trading].[ord].[ExecutionProfile] ep
    JOIN ord.OrderType ot on ot.OrderTypeId = ep.OrderTypeId
	    JOIN ord.TimeInForce tf on tf.TimeInForceId = ep.TimeInForceId
		    JOIN ord.ExecutionAlgorithm ea on ea.ExecutionAlgorithmId = ep.ExecutionAlgorithmId
			    JOIN ord.HandlingInstruction hi on hi.HandlingInstructionId = ep.HandlingInstructionId
				    JOIN ord.ExecutionChannel ec on ec.ExecutionChannelId = ep.ExecutionChannelId
					    JOIN ord.ExecutionAlgorithmParamSet ps on ps.ExecutionAlgorithmParamSetId = ep.ExecutionAlgorithmParamSetId
GO
/****** Object:  Table [ord].[OrderStatus_H]    Script Date: 23/08/2023 15:39:54 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [ord].[OrderStatus_H](
	[OrderStatusId] [int] NOT NULL,
	[Mnemonic] [nvarchar](10) NOT NULL,
	[Description] [nvarchar](200) NOT NULL,
	[ValidFrom] [datetime2](2) NOT NULL,
	[ValidTo] [datetime2](2) NOT NULL
) ON [PRIMARY]
WITH
(
DATA_COMPRESSION = PAGE
)
GO
/****** Object:  Index [ix_OrderStatus_H]    Script Date: 23/08/2023 15:39:54 ******/
CREATE CLUSTERED INDEX [ix_OrderStatus_H] ON [ord].[OrderStatus_H]
(
	[ValidTo] ASC,
	[ValidFrom] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, SORT_IN_TEMPDB = OFF, DROP_EXISTING = OFF, ONLINE = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF, DATA_COMPRESSION = PAGE) ON [PRIMARY]
GO
/****** Object:  Table [ord].[OrderStatus]    Script Date: 23/08/2023 15:39:54 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [ord].[OrderStatus](
	[OrderStatusId] [int] IDENTITY(1,1) NOT NULL,
	[Mnemonic] [nvarchar](10) NOT NULL,
	[Description] [nvarchar](200) NOT NULL,
	[ValidFrom] [datetime2](2) GENERATED ALWAYS AS ROW START NOT NULL,
	[ValidTo] [datetime2](2) GENERATED ALWAYS AS ROW END NOT NULL,
 CONSTRAINT [PK_OrderStatus] PRIMARY KEY CLUSTERED 
(
	[OrderStatusId] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY],
	PERIOD FOR SYSTEM_TIME ([ValidFrom], [ValidTo])
) ON [PRIMARY]
WITH
(
SYSTEM_VERSIONING = ON (HISTORY_TABLE = [ord].[OrderStatus_H])
)
GO
/****** Object:  Table [ord].[ExecutionProfileSelectionRule_H]    Script Date: 23/08/2023 15:39:54 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [ord].[ExecutionProfileSelectionRule_H](
	[ExecutionProfileSelectionRuleId] [int] NOT NULL,
	[PortfolioId] [tinyint] NOT NULL,
	[BrokerId] [int] NOT NULL,
	[InstrumentTypeId] [tinyint] NOT NULL,
	[TradeModeId] [tinyint] NOT NULL,
	[ExecutionProfileId] [int] NOT NULL,
	[ValidFrom] [datetime2](2) NOT NULL,
	[ValidTo] [datetime2](2) NOT NULL
) ON [PRIMARY]
WITH
(
DATA_COMPRESSION = PAGE
)
GO
/****** Object:  Index [ix_ExecutionProfileSelectionRule_H]    Script Date: 23/08/2023 15:39:54 ******/
CREATE CLUSTERED INDEX [ix_ExecutionProfileSelectionRule_H] ON [ord].[ExecutionProfileSelectionRule_H]
(
	[ValidTo] ASC,
	[ValidFrom] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, SORT_IN_TEMPDB = OFF, DROP_EXISTING = OFF, ONLINE = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF, DATA_COMPRESSION = PAGE) ON [PRIMARY]
GO
/****** Object:  Table [ord].[ExecutionProfileSelectionRule]    Script Date: 23/08/2023 15:39:54 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [ord].[ExecutionProfileSelectionRule](
	[ExecutionProfileSelectionRuleId] [int] IDENTITY(1,1) NOT NULL,
	[PortfolioId] [tinyint] NOT NULL,
	[BrokerId] [int] NOT NULL,
	[InstrumentTypeId] [tinyint] NOT NULL,
	[TradeModeId] [tinyint] NOT NULL,
	[ExecutionProfileId] [int] NOT NULL,
	[ValidFrom] [datetime2](2) GENERATED ALWAYS AS ROW START NOT NULL,
	[ValidTo] [datetime2](2) GENERATED ALWAYS AS ROW END NOT NULL,
 CONSTRAINT [PK_ExecutionProfileSelectionRule] PRIMARY KEY CLUSTERED 
(
	[ExecutionProfileSelectionRuleId] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY],
	PERIOD FOR SYSTEM_TIME ([ValidFrom], [ValidTo])
) ON [PRIMARY]
WITH
(
SYSTEM_VERSIONING = ON (HISTORY_TABLE = [ord].[ExecutionProfileSelectionRule_H])
)
GO
/****** Object:  View [rep].[VwExecutionProfileSelectionRule]    Script Date: 23/08/2023 15:39:54 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
/****** Script for SelectTopNRows command from SSMS  ******/

CREATE VIEW [rep].[VwExecutionProfileSelectionRule] as
SELECT  [ExecutionProfileSelectionRuleId]
      ,rl.PortfolioId
	  , pf.Mnemonic as Portfolio
	  , br.Code as Broker
	  , it.Mnemonic as InstrumentType
	  , tm.Mnemonic as TradeMode
	  , ep.*

   
  FROM [Trading].[ord].[ExecutionProfileSelectionRule] rl
        JOIN ord.Portfolio pf on pf.PortfolioId = rl.PortfolioId
  JOIN ord.Broker br on br.BrokerId = rl.BrokerId
  JOIN ord.InstrumentType it on it.InstrumentTypeId = rl.InstrumentTypeId
  JOIN ord.TradeMode tm on tm.TradeModeId = rl.TradeModeId
  JOIN rep.VwExecutionProfile ep on ep.ExecutionProfileId = rl.ExecutionProfileId
GO
/****** Object:  Table [wght].[TargetAllocation]    Script Date: 23/08/2023 15:39:54 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [wght].[TargetAllocation](
	[TargetAllocationId] [int] IDENTITY(1,1) NOT NULL,
	[PortfolioId] [tinyint] NOT NULL,
	[GeneratedOn] [datetime2](7) NOT NULL,
 CONSTRAINT [PK_TargeAllocationId] PRIMARY KEY CLUSTERED 
(
	[TargetAllocationId] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  Table [risk].[TargetAllocationCheck]    Script Date: 23/08/2023 15:39:54 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [risk].[TargetAllocationCheck](
	[TargetAllocationCheckId] [int] IDENTITY(1,1) NOT NULL,
	[TargetAllocationId] [int] NOT NULL,
	[IsBreach] [bit] NOT NULL,
	[CheckedOn] [datetime2](7) NOT NULL,
 CONSTRAINT [PK_TargetAllocationCheck] PRIMARY KEY CLUSTERED 
(
	[TargetAllocationCheckId] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  Table [risk].[Portfolio]    Script Date: 23/08/2023 15:39:54 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [risk].[Portfolio](
	[PortfolioId] [tinyint] NOT NULL,
	[Mnemonic] [nvarchar](6) NOT NULL,
	[Name] [nvarchar](50) NOT NULL,
	[Currency] [char](3) NOT NULL,
 CONSTRAINT [PK_PortfolioId] PRIMARY KEY CLUSTERED 
(
	[PortfolioId] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  View [rep].[VwTargetAllocationCheck]    Script Date: 23/08/2023 15:39:54 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

/****** Script for SelectTopNRows command from SSMS  ******/

CREATE VIEW [rep].[VwTargetAllocationCheck] as
SELECT [TargetAllocationCheckId]
      ,tac.[TargetAllocationId]
	  ,ta.GeneratedOn
	  ,ptf.Name
      ,[IsBreach]
      ,[CheckedOn]
  FROM [Trading].[risk].[TargetAllocationCheck] tac
  JOIN wght.TargetAllocation ta on ta.TargetAllocationId = tac.TargetAllocationId
  JOIN risk.Portfolio ptf on ptf.PortfolioId = ta.PortfolioId



GO
/****** Object:  Table [risk].[RelationalOperator_H]    Script Date: 23/08/2023 15:39:54 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [risk].[RelationalOperator_H](
	[RelationalOperatorId] [tinyint] NOT NULL,
	[Mnemonic] [nvarchar](20) NOT NULL,
	[Description] [nvarchar](50) NOT NULL,
	[ValidFrom] [datetime2](2) NOT NULL,
	[ValidTo] [datetime2](2) NOT NULL
) ON [PRIMARY]
WITH
(
DATA_COMPRESSION = PAGE
)
GO
/****** Object:  Index [ix_RelationalOperator_H]    Script Date: 23/08/2023 15:39:54 ******/
CREATE CLUSTERED INDEX [ix_RelationalOperator_H] ON [risk].[RelationalOperator_H]
(
	[ValidTo] ASC,
	[ValidFrom] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, SORT_IN_TEMPDB = OFF, DROP_EXISTING = OFF, ONLINE = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF, DATA_COMPRESSION = PAGE) ON [PRIMARY]
GO
/****** Object:  Table [risk].[RelationalOperator]    Script Date: 23/08/2023 15:39:54 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [risk].[RelationalOperator](
	[RelationalOperatorId] [tinyint] IDENTITY(1,1) NOT NULL,
	[Mnemonic] [nvarchar](20) NOT NULL,
	[Description] [nvarchar](50) NOT NULL,
	[ValidFrom] [datetime2](2) GENERATED ALWAYS AS ROW START NOT NULL,
	[ValidTo] [datetime2](2) GENERATED ALWAYS AS ROW END NOT NULL,
 CONSTRAINT [PK_RelationalOperatorId] PRIMARY KEY CLUSTERED 
(
	[RelationalOperatorId] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY],
 CONSTRAINT [UC_RelationalOperatorMnemonic] UNIQUE NONCLUSTERED 
(
	[Mnemonic] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY],
	PERIOD FOR SYSTEM_TIME ([ValidFrom], [ValidTo])
) ON [PRIMARY]
WITH
(
SYSTEM_VERSIONING = ON (HISTORY_TABLE = [risk].[RelationalOperator_H])
)
GO
/****** Object:  Table [risk].[ConstraintType_H]    Script Date: 23/08/2023 15:39:54 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [risk].[ConstraintType_H](
	[ConstraintTypeId] [smallint] NOT NULL,
	[Mnemonic] [nvarchar](10) NOT NULL,
	[Name] [nvarchar](50) NOT NULL,
	[Description] [nvarchar](200) NULL,
	[ValidFrom] [datetime2](2) NOT NULL,
	[ValidTo] [datetime2](2) NOT NULL
) ON [PRIMARY]
WITH
(
DATA_COMPRESSION = PAGE
)
GO
/****** Object:  Index [ix_ConstraintType_H]    Script Date: 23/08/2023 15:39:54 ******/
CREATE CLUSTERED INDEX [ix_ConstraintType_H] ON [risk].[ConstraintType_H]
(
	[ValidTo] ASC,
	[ValidFrom] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, SORT_IN_TEMPDB = OFF, DROP_EXISTING = OFF, ONLINE = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF, DATA_COMPRESSION = PAGE) ON [PRIMARY]
GO
/****** Object:  Table [risk].[ConstraintType]    Script Date: 23/08/2023 15:39:54 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [risk].[ConstraintType](
	[ConstraintTypeId] [smallint] IDENTITY(1,1) NOT NULL,
	[Mnemonic] [nvarchar](10) NOT NULL,
	[Name] [nvarchar](50) NOT NULL,
	[Description] [nvarchar](200) NULL,
	[ValidFrom] [datetime2](2) GENERATED ALWAYS AS ROW START NOT NULL,
	[ValidTo] [datetime2](2) GENERATED ALWAYS AS ROW END NOT NULL,
 CONSTRAINT [PK_ConstraintTypeId] PRIMARY KEY CLUSTERED 
(
	[ConstraintTypeId] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY],
 CONSTRAINT [UC_ConstraintTypeMnemonic] UNIQUE NONCLUSTERED 
(
	[Mnemonic] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY],
	PERIOD FOR SYSTEM_TIME ([ValidFrom], [ValidTo])
) ON [PRIMARY]
WITH
(
SYSTEM_VERSIONING = ON (HISTORY_TABLE = [risk].[ConstraintType_H])
)
GO
/****** Object:  Table [risk].[Constraint_H]    Script Date: 23/08/2023 15:39:54 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [risk].[Constraint_H](
	[ConstraintId] [int] NOT NULL,
	[ConstraintTypeId] [smallint] NOT NULL,
	[RelationalOperatorId] [tinyint] NOT NULL,
	[LimitValue] [decimal](12, 6) NOT NULL,
	[Description] [nvarchar](200) NULL,
	[FilterId] [int] NULL,
	[ValidFrom] [datetime2](2) NOT NULL,
	[ValidTo] [datetime2](2) NOT NULL
) ON [PRIMARY]
WITH
(
DATA_COMPRESSION = PAGE
)
GO
/****** Object:  Index [ix_Constraint_H]    Script Date: 23/08/2023 15:39:54 ******/
CREATE CLUSTERED INDEX [ix_Constraint_H] ON [risk].[Constraint_H]
(
	[ValidTo] ASC,
	[ValidFrom] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, SORT_IN_TEMPDB = OFF, DROP_EXISTING = OFF, ONLINE = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF, DATA_COMPRESSION = PAGE) ON [PRIMARY]
GO
/****** Object:  Table [risk].[Constraint]    Script Date: 23/08/2023 15:39:54 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [risk].[Constraint](
	[ConstraintId] [int] IDENTITY(1,1) NOT NULL,
	[ConstraintTypeId] [smallint] NOT NULL,
	[RelationalOperatorId] [tinyint] NOT NULL,
	[LimitValue] [decimal](12, 6) NOT NULL,
	[Description] [nvarchar](200) NULL,
	[FilterId] [int] NULL,
	[ValidFrom] [datetime2](2) GENERATED ALWAYS AS ROW START NOT NULL,
	[ValidTo] [datetime2](2) GENERATED ALWAYS AS ROW END NOT NULL,
 CONSTRAINT [PK_ConstraintId] PRIMARY KEY CLUSTERED 
(
	[ConstraintId] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY],
 CONSTRAINT [UC_Constraint] UNIQUE NONCLUSTERED 
(
	[ConstraintTypeId] ASC,
	[RelationalOperatorId] ASC,
	[LimitValue] ASC,
	[FilterId] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY],
	PERIOD FOR SYSTEM_TIME ([ValidFrom], [ValidTo])
) ON [PRIMARY]
WITH
(
SYSTEM_VERSIONING = ON (HISTORY_TABLE = [risk].[Constraint_H])
)
GO
/****** Object:  Table [risk].[ConstraintBreach]    Script Date: 23/08/2023 15:39:54 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [risk].[ConstraintBreach](
	[ConstraintBreachId] [int] IDENTITY(1,1) NOT NULL,
	[TargetAllocationCheckId] [int] NOT NULL,
	[ConstraintId] [int] NOT NULL,
	[LimitValue] [float] NOT NULL,
	[CheckedValue] [float] NOT NULL,
	[Message] [nvarchar](300) NOT NULL,
 CONSTRAINT [PK_ConstraintBreach] PRIMARY KEY CLUSTERED 
(
	[ConstraintBreachId] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  View [rep].[VwConstraintBreach]    Script Date: 23/08/2023 15:39:54 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

/****** Script for SelectTopNRows command from SSMS  ******/

CREATE VIEW [rep].[VwConstraintBreach] as
SELECT  [ConstraintBreachId]
      ,[TargetAllocationCheckId]
	      ,t.Description as  [Constraint Type]
      ,co.Description as [Constraint Description]
	


	
     
      ,[CheckedValue] as ComputedValue
	  ,ro.Description as [Relational Operator]
	   ,br.[LimitValue]
      ,[Message]
  FROM [Trading].[risk].[ConstraintBreach] br
  JOIN risk.[Constraint] co on co.ConstraintId = br.ConstraintId
  JOIN risk.ConstraintType t on t.ConstraintTypeId = co.ConstraintTypeId
  JOIN risk.RelationalOperator ro on ro.RelationalOperatorId = co.RelationalOperatorId
GO
/****** Object:  Table [ord].[BlockOrder]    Script Date: 23/08/2023 15:39:54 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [ord].[BlockOrder](
	[BlockOrderId] [int] IDENTITY(1,1) NOT NULL,
	[RebalancingSessionId] [int] NOT NULL,
	[BrokerId] [int] NOT NULL,
	[ExecutionProfileId] [int] NOT NULL,
	[TradeModeId] [tinyint] NOT NULL,
	[InstrumentId] [int] NOT NULL,
	[Quantity] [int] NOT NULL,
	[CreatedOn] [datetime] NULL,
 CONSTRAINT [PK_BlockOrderId] PRIMARY KEY CLUSTERED 
(
	[BlockOrderId] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  View [rep].[VwBlockOrders]    Script Date: 23/08/2023 15:39:54 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

/****** Script for SelectTopNRows command from SSMS  ******/

CREATE VIEW [rep].[VwBlockOrders] as
SELECT [BlockOrderId]
      ,[RebalancingSessionId]
	   , ins.Symbol
      ,br.Name
	  ,tm.Mnemonic
      ,[Quantity]
      ,[CreatedOn]
	  ,ep.OrderType
	  ,ep.TimeInForce
	  ,ep.ExecutionAlgorithm
	  ,ep.HandlingInstruction
	  ,ep.ExecutionChannel
  FROM [Trading].[ord].[BlockOrder]blo
  JOIN ord.Broker br on br.BrokerId = blo.BrokerId
  JOIN rep.VwExecutionProfile ep on ep.ExecutionProfileId = blo.ExecutionProfileId
  JOIN ord.TradeMode tm on tm.TradeModeId = blo.TradeModeId
  JOIN ord.Instrument ins on ins.InstrumentId = blo.InstrumentId
GO
/****** Object:  Table [ord].[AllocationOrder]    Script Date: 23/08/2023 15:39:54 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [ord].[AllocationOrder](
	[AllocationOrderId] [int] IDENTITY(1,1) NOT NULL,
	[BlockOrderId] [int] NOT NULL,
	[PortfolioId] [tinyint] NOT NULL,
	[Quantity] [int] NOT NULL,
	[TradingAccountId] [int] NOT NULL,
 CONSTRAINT [PK_AllocationOrderId] PRIMARY KEY CLUSTERED 
(
	[AllocationOrderId] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY],
 CONSTRAINT [UC_AllocationOrder] UNIQUE NONCLUSTERED 
(
	[BlockOrderId] ASC,
	[PortfolioId] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  View [rep].[VwAllocationOrder]    Script Date: 23/08/2023 15:39:54 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO


/****** Script for SelectTopNRows command from SSMS  ******/

CREATE VIEW [rep].[VwAllocationOrder] as
SELECT  [AllocationOrderId]
      
      ,ptf.Name as  Portfolio
      ,alloc.[Quantity] as AllocationQuantity
      ,ta.Code as TradingAccount
	  , bo.*
  FROM [Trading].[ord].[AllocationOrder] alloc
  JOIN rep.VwBlockOrders bo on bo.BlockOrderId = alloc.BlockOrderid
  JOIN ord.Portfolio ptf on ptf.PortfolioId = ptf.PortfolioId
  JOIN ord.TradingAccount ta on ta.TradingAccountId = alloc.TradingAccountId

GO
/****** Object:  Table [instr].[FutureContractMonth_H]    Script Date: 23/08/2023 15:39:54 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [instr].[FutureContractMonth_H](
	[FutureContractMonthId] [tinyint] NOT NULL,
	[Code] [varchar](1) NULL,
	[Name] [nvarchar](10) NULL,
	[ValidFrom] [datetime2](2) NOT NULL,
	[ValidTo] [datetime2](2) NOT NULL
) ON [PRIMARY]
WITH
(
DATA_COMPRESSION = PAGE
)
GO
/****** Object:  Index [ix_FutureContractMonth_H]    Script Date: 23/08/2023 15:39:54 ******/
CREATE CLUSTERED INDEX [ix_FutureContractMonth_H] ON [instr].[FutureContractMonth_H]
(
	[ValidTo] ASC,
	[ValidFrom] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, SORT_IN_TEMPDB = OFF, DROP_EXISTING = OFF, ONLINE = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF, DATA_COMPRESSION = PAGE) ON [PRIMARY]
GO
/****** Object:  Table [instr].[FutureContractMonth]    Script Date: 23/08/2023 15:39:54 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [instr].[FutureContractMonth](
	[FutureContractMonthId] [tinyint] IDENTITY(1,1) NOT NULL,
	[Code] [varchar](1) NULL,
	[Name] [nvarchar](10) NULL,
	[ValidFrom] [datetime2](2) GENERATED ALWAYS AS ROW START NOT NULL,
	[ValidTo] [datetime2](2) GENERATED ALWAYS AS ROW END NOT NULL,
 CONSTRAINT [PK_FutureContractMonthId] PRIMARY KEY CLUSTERED 
(
	[FutureContractMonthId] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY],
	PERIOD FOR SYSTEM_TIME ([ValidFrom], [ValidTo])
) ON [PRIMARY]
WITH
(
SYSTEM_VERSIONING = ON (HISTORY_TABLE = [instr].[FutureContractMonth_H])
)
GO
/****** Object:  Table [risk].[BooleanOperator_H]    Script Date: 23/08/2023 15:39:54 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [risk].[BooleanOperator_H](
	[BooleanOperatorId] [tinyint] NOT NULL,
	[Mnemonic] [nvarchar](20) NOT NULL,
	[ValidFrom] [datetime2](2) NOT NULL,
	[ValidTo] [datetime2](2) NOT NULL
) ON [PRIMARY]
WITH
(
DATA_COMPRESSION = PAGE
)
GO
/****** Object:  Index [ix_BooleanOperator_H]    Script Date: 23/08/2023 15:39:54 ******/
CREATE CLUSTERED INDEX [ix_BooleanOperator_H] ON [risk].[BooleanOperator_H]
(
	[ValidTo] ASC,
	[ValidFrom] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, SORT_IN_TEMPDB = OFF, DROP_EXISTING = OFF, ONLINE = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF, DATA_COMPRESSION = PAGE) ON [PRIMARY]
GO
/****** Object:  Table [risk].[BooleanOperator]    Script Date: 23/08/2023 15:39:54 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [risk].[BooleanOperator](
	[BooleanOperatorId] [tinyint] IDENTITY(1,1) NOT NULL,
	[Mnemonic] [nvarchar](20) NOT NULL,
	[ValidFrom] [datetime2](2) GENERATED ALWAYS AS ROW START NOT NULL,
	[ValidTo] [datetime2](2) GENERATED ALWAYS AS ROW END NOT NULL,
 CONSTRAINT [PK_BooleanOperatorId] PRIMARY KEY CLUSTERED 
(
	[BooleanOperatorId] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY],
 CONSTRAINT [UC_BooleanOperatorMnemonic] UNIQUE NONCLUSTERED 
(
	[Mnemonic] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY],
	PERIOD FOR SYSTEM_TIME ([ValidFrom], [ValidTo])
) ON [PRIMARY]
WITH
(
SYSTEM_VERSIONING = ON (HISTORY_TABLE = [risk].[BooleanOperator_H])
)
GO
/****** Object:  Table [instr].[MarketSector_H]    Script Date: 23/08/2023 15:39:54 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [instr].[MarketSector_H](
	[MarketSectorId] [tinyint] NOT NULL,
	[Mnemonic] [nvarchar](6) NOT NULL,
	[Name] [nvarchar](30) NOT NULL,
	[ValidFrom] [datetime2](2) NOT NULL,
	[ValidTo] [datetime2](2) NOT NULL
) ON [PRIMARY]
WITH
(
DATA_COMPRESSION = PAGE
)
GO
/****** Object:  Index [ix_MarketSector_H]    Script Date: 23/08/2023 15:39:54 ******/
CREATE CLUSTERED INDEX [ix_MarketSector_H] ON [instr].[MarketSector_H]
(
	[ValidTo] ASC,
	[ValidFrom] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, SORT_IN_TEMPDB = OFF, DROP_EXISTING = OFF, ONLINE = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF, DATA_COMPRESSION = PAGE) ON [PRIMARY]
GO
/****** Object:  Table [instr].[MarketSector]    Script Date: 23/08/2023 15:39:54 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [instr].[MarketSector](
	[MarketSectorId] [tinyint] IDENTITY(1,1) NOT NULL,
	[Mnemonic] [nvarchar](6) NOT NULL,
	[Name] [nvarchar](30) NOT NULL,
	[ValidFrom] [datetime2](2) GENERATED ALWAYS AS ROW START NOT NULL,
	[ValidTo] [datetime2](2) GENERATED ALWAYS AS ROW END NOT NULL,
 CONSTRAINT [PK_MarketSector] PRIMARY KEY CLUSTERED 
(
	[MarketSectorId] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY],
	PERIOD FOR SYSTEM_TIME ([ValidFrom], [ValidTo])
) ON [PRIMARY]
WITH
(
SYSTEM_VERSIONING = ON (HISTORY_TABLE = [instr].[MarketSector_H])
)
GO
/****** Object:  Table [risk].[FilterPartyType_H]    Script Date: 23/08/2023 15:39:54 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [risk].[FilterPartyType_H](
	[FilterPartyTypeId] [tinyint] NOT NULL,
	[Name] [nvarchar](100) NOT NULL,
	[Mnemonic] [nvarchar](5) NOT NULL,
	[ValidFrom] [datetime2](2) NOT NULL,
	[ValidTo] [datetime2](2) NOT NULL
) ON [PRIMARY]
WITH
(
DATA_COMPRESSION = PAGE
)
GO
/****** Object:  Index [ix_FilterPartyType_H]    Script Date: 23/08/2023 15:39:54 ******/
CREATE CLUSTERED INDEX [ix_FilterPartyType_H] ON [risk].[FilterPartyType_H]
(
	[ValidTo] ASC,
	[ValidFrom] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, SORT_IN_TEMPDB = OFF, DROP_EXISTING = OFF, ONLINE = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF, DATA_COMPRESSION = PAGE) ON [PRIMARY]
GO
/****** Object:  Table [risk].[FilterPartyType]    Script Date: 23/08/2023 15:39:54 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [risk].[FilterPartyType](
	[FilterPartyTypeId] [tinyint] IDENTITY(1,1) NOT NULL,
	[Name] [nvarchar](100) NOT NULL,
	[Mnemonic] [nvarchar](5) NOT NULL,
	[ValidFrom] [datetime2](2) GENERATED ALWAYS AS ROW START NOT NULL,
	[ValidTo] [datetime2](2) GENERATED ALWAYS AS ROW END NOT NULL,
 CONSTRAINT [PK_FilterPartyTypeId] PRIMARY KEY CLUSTERED 
(
	[FilterPartyTypeId] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY],
	PERIOD FOR SYSTEM_TIME ([ValidFrom], [ValidTo])
) ON [PRIMARY]
WITH
(
SYSTEM_VERSIONING = ON (HISTORY_TABLE = [risk].[FilterPartyType_H])
)
GO
/****** Object:  Table [rout].[FutureContract_H]    Script Date: 23/08/2023 15:39:54 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [rout].[FutureContract_H](
	[FutureContractId] [int] NOT NULL,
	[Symbol] [nvarchar](30) NOT NULL,
	[GenericFutureId] [int] NOT NULL,
	[FutureContractMonth] [char](1) NOT NULL,
	[ContractYear] [int] NOT NULL,
	[LastTradeDate] [date] NOT NULL,
	[FirstNoticeDate] [date] NOT NULL,
	[IsCurrent] [bit] NOT NULL,
	[ValidFrom] [datetime2](2) NOT NULL,
	[ValidTo] [datetime2](2) NOT NULL
) ON [PRIMARY]
WITH
(
DATA_COMPRESSION = PAGE
)
GO
/****** Object:  Index [ix_FutureContract_H]    Script Date: 23/08/2023 15:39:54 ******/
CREATE CLUSTERED INDEX [ix_FutureContract_H] ON [rout].[FutureContract_H]
(
	[ValidTo] ASC,
	[ValidFrom] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, SORT_IN_TEMPDB = OFF, DROP_EXISTING = OFF, ONLINE = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF, DATA_COMPRESSION = PAGE) ON [PRIMARY]
GO
/****** Object:  Table [roll].[FutureContract]    Script Date: 23/08/2023 15:39:54 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [roll].[FutureContract](
	[FutureContractId] [int] NOT NULL,
	[Symbol] [nvarchar](30) NOT NULL,
	[GenericFutureId] [int] NOT NULL,
	[FutureContractMonth] [char](1) NOT NULL,
	[ContractYear] [int] NOT NULL,
	[LastTradeDate] [date] NOT NULL,
	[FirstNoticeDate] [date] NOT NULL,
	[IsCurrent] [bit] NOT NULL,
	[ValidFrom] [datetime2](2) GENERATED ALWAYS AS ROW START NOT NULL,
	[ValidTo] [datetime2](2) GENERATED ALWAYS AS ROW END NOT NULL,
 CONSTRAINT [PK_FutureContractId] PRIMARY KEY CLUSTERED 
(
	[FutureContractId] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY],
 CONSTRAINT [UC_FutureContract_Symbol] UNIQUE NONCLUSTERED 
(
	[Symbol] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY],
	PERIOD FOR SYSTEM_TIME ([ValidFrom], [ValidTo])
) ON [PRIMARY]
WITH
(
SYSTEM_VERSIONING = ON (HISTORY_TABLE = [rout].[FutureContract_H])
)
GO
/****** Object:  Table [ord].[BrokerSelectionRule_H]    Script Date: 23/08/2023 15:39:54 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [ord].[BrokerSelectionRule_H](
	[BrokerSelectionRuleId] [int] NOT NULL,
	[PortfolioId] [tinyint] NOT NULL,
	[InstrumentTypeId] [tinyint] NOT NULL,
	[BrokerId] [int] NOT NULL,
	[ValidFrom] [datetime2](2) NOT NULL,
	[ValidTo] [datetime2](2) NOT NULL
) ON [PRIMARY]
WITH
(
DATA_COMPRESSION = PAGE
)
GO
/****** Object:  Index [ix_BrokerSelectionRule_H]    Script Date: 23/08/2023 15:39:54 ******/
CREATE CLUSTERED INDEX [ix_BrokerSelectionRule_H] ON [ord].[BrokerSelectionRule_H]
(
	[ValidTo] ASC,
	[ValidFrom] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, SORT_IN_TEMPDB = OFF, DROP_EXISTING = OFF, ONLINE = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF, DATA_COMPRESSION = PAGE) ON [PRIMARY]
GO
/****** Object:  Table [ord].[BrokerSelectionRule]    Script Date: 23/08/2023 15:39:54 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [ord].[BrokerSelectionRule](
	[BrokerSelectionRuleId] [int] IDENTITY(1,1) NOT NULL,
	[PortfolioId] [tinyint] NOT NULL,
	[InstrumentTypeId] [tinyint] NOT NULL,
	[BrokerId] [int] NOT NULL,
	[ValidFrom] [datetime2](2) GENERATED ALWAYS AS ROW START NOT NULL,
	[ValidTo] [datetime2](2) GENERATED ALWAYS AS ROW END NOT NULL,
 CONSTRAINT [PK_BrokerSelectionRule] PRIMARY KEY CLUSTERED 
(
	[BrokerSelectionRuleId] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY],
	PERIOD FOR SYSTEM_TIME ([ValidFrom], [ValidTo])
) ON [PRIMARY]
WITH
(
SYSTEM_VERSIONING = ON (HISTORY_TABLE = [ord].[BrokerSelectionRule_H])
)
GO
/****** Object:  Table [rout].[ForwardContract_H]    Script Date: 23/08/2023 15:39:54 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [rout].[ForwardContract_H](
	[ForwardContractId] [int] NOT NULL,
	[CurrencyPairId] [int] NOT NULL,
	[Symbol] [nvarchar](30) NOT NULL,
	[MaturityDate] [date] NOT NULL,
	[IsCurrent] [bit] NOT NULL,
	[ValidFrom] [datetime2](2) NOT NULL,
	[ValidTo] [datetime2](2) NOT NULL
) ON [PRIMARY]
WITH
(
DATA_COMPRESSION = PAGE
)
GO
/****** Object:  Index [ix_ForwardContract_H]    Script Date: 23/08/2023 15:39:54 ******/
CREATE CLUSTERED INDEX [ix_ForwardContract_H] ON [rout].[ForwardContract_H]
(
	[ValidTo] ASC,
	[ValidFrom] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, SORT_IN_TEMPDB = OFF, DROP_EXISTING = OFF, ONLINE = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF, DATA_COMPRESSION = PAGE) ON [PRIMARY]
GO
/****** Object:  Table [roll].[ForwardContract]    Script Date: 23/08/2023 15:39:54 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [roll].[ForwardContract](
	[ForwardContractId] [int] NOT NULL,
	[CurrencyPairId] [int] NOT NULL,
	[Symbol] [nvarchar](30) NOT NULL,
	[MaturityDate] [date] NOT NULL,
	[IsCurrent] [bit] NOT NULL,
	[ValidFrom] [datetime2](2) GENERATED ALWAYS AS ROW START NOT NULL,
	[ValidTo] [datetime2](2) GENERATED ALWAYS AS ROW END NOT NULL,
 CONSTRAINT [PK_ForwardContract] PRIMARY KEY CLUSTERED 
(
	[ForwardContractId] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY],
 CONSTRAINT [UC_ForwardContract_CurrencyPair_Maturity] UNIQUE NONCLUSTERED 
(
	[CurrencyPairId] ASC,
	[MaturityDate] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY],
 CONSTRAINT [UC_ForwardContract_Symbol] UNIQUE NONCLUSTERED 
(
	[Symbol] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY],
	PERIOD FOR SYSTEM_TIME ([ValidFrom], [ValidTo])
) ON [PRIMARY]
WITH
(
SYSTEM_VERSIONING = ON (HISTORY_TABLE = [rout].[ForwardContract_H])
)
GO
/****** Object:  Table [risk].[FilterOperator_H]    Script Date: 23/08/2023 15:39:54 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [risk].[FilterOperator_H](
	[FilterOperatorId] [tinyint] NOT NULL,
	[Mnemonic] [nvarchar](20) NOT NULL,
	[Description] [nvarchar](20) NOT NULL,
	[ValidFrom] [datetime2](2) NOT NULL,
	[ValidTo] [datetime2](2) NOT NULL
) ON [PRIMARY]
WITH
(
DATA_COMPRESSION = PAGE
)
GO
/****** Object:  Index [ix_FilterOperator_H]    Script Date: 23/08/2023 15:39:54 ******/
CREATE CLUSTERED INDEX [ix_FilterOperator_H] ON [risk].[FilterOperator_H]
(
	[ValidTo] ASC,
	[ValidFrom] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, SORT_IN_TEMPDB = OFF, DROP_EXISTING = OFF, ONLINE = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF, DATA_COMPRESSION = PAGE) ON [PRIMARY]
GO
/****** Object:  Table [risk].[FilterOperator]    Script Date: 23/08/2023 15:39:54 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [risk].[FilterOperator](
	[FilterOperatorId] [tinyint] IDENTITY(1,1) NOT NULL,
	[Mnemonic] [nvarchar](20) NOT NULL,
	[Description] [nvarchar](20) NOT NULL,
	[ValidFrom] [datetime2](2) GENERATED ALWAYS AS ROW START NOT NULL,
	[ValidTo] [datetime2](2) GENERATED ALWAYS AS ROW END NOT NULL,
 CONSTRAINT [PK_FilterOperatorId] PRIMARY KEY CLUSTERED 
(
	[FilterOperatorId] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY],
 CONSTRAINT [UC_FilterOperatorMnemonic] UNIQUE NONCLUSTERED 
(
	[Mnemonic] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY],
	PERIOD FOR SYSTEM_TIME ([ValidFrom], [ValidTo])
) ON [PRIMARY]
WITH
(
SYSTEM_VERSIONING = ON (HISTORY_TABLE = [risk].[FilterOperator_H])
)
GO
/****** Object:  Table [instr].[Date_H]    Script Date: 23/08/2023 15:39:54 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [instr].[Date_H](
	[DateId] [int] NOT NULL,
	[Value] [date] NOT NULL,
	[IsIMM] [bit] NOT NULL,
	[IsForwardMaturity] [bit] NOT NULL,
	[IsWeekend] [bit] NOT NULL,
	[ValidFrom] [datetime2](2) NOT NULL,
	[ValidTo] [datetime2](2) NOT NULL
) ON [PRIMARY]
WITH
(
DATA_COMPRESSION = PAGE
)
GO
/****** Object:  Index [ix_Date_H]    Script Date: 23/08/2023 15:39:54 ******/
CREATE CLUSTERED INDEX [ix_Date_H] ON [instr].[Date_H]
(
	[ValidTo] ASC,
	[ValidFrom] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, SORT_IN_TEMPDB = OFF, DROP_EXISTING = OFF, ONLINE = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF, DATA_COMPRESSION = PAGE) ON [PRIMARY]
GO
/****** Object:  Table [instr].[Date]    Script Date: 23/08/2023 15:39:54 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [instr].[Date](
	[DateId] [int] IDENTITY(1,1) NOT NULL,
	[Value] [date] NOT NULL,
	[IsIMM] [bit] NOT NULL,
	[IsForwardMaturity] [bit] NOT NULL,
	[IsWeekend] [bit] NOT NULL,
	[ValidFrom] [datetime2](2) GENERATED ALWAYS AS ROW START NOT NULL,
	[ValidTo] [datetime2](2) GENERATED ALWAYS AS ROW END NOT NULL,
 CONSTRAINT [PK_Date] PRIMARY KEY CLUSTERED 
(
	[DateId] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY],
 CONSTRAINT [UC_Date] UNIQUE NONCLUSTERED 
(
	[Value] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY],
	PERIOD FOR SYSTEM_TIME ([ValidFrom], [ValidTo])
) ON [PRIMARY]
WITH
(
SYSTEM_VERSIONING = ON (HISTORY_TABLE = [instr].[Date_H])
)
GO
/****** Object:  Table [risk].[Filter_H]    Script Date: 23/08/2023 15:39:54 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [risk].[Filter_H](
	[FilterId] [int] NOT NULL,
	[FilterCriterion1Id] [int] NOT NULL,
	[BooleanOperatorId] [tinyint] NULL,
	[FilterCriterion2Id] [int] NULL,
	[ValidFrom] [datetime2](2) NOT NULL,
	[ValidTo] [datetime2](2) NOT NULL
) ON [PRIMARY]
WITH
(
DATA_COMPRESSION = PAGE
)
GO
/****** Object:  Index [ix_Filter_H]    Script Date: 23/08/2023 15:39:54 ******/
CREATE CLUSTERED INDEX [ix_Filter_H] ON [risk].[Filter_H]
(
	[ValidTo] ASC,
	[ValidFrom] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, SORT_IN_TEMPDB = OFF, DROP_EXISTING = OFF, ONLINE = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF, DATA_COMPRESSION = PAGE) ON [PRIMARY]
GO
/****** Object:  Table [risk].[Filter]    Script Date: 23/08/2023 15:39:54 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [risk].[Filter](
	[FilterId] [int] IDENTITY(1,1) NOT NULL,
	[FilterCriterion1Id] [int] NOT NULL,
	[BooleanOperatorId] [tinyint] NULL,
	[FilterCriterion2Id] [int] NULL,
	[ValidFrom] [datetime2](2) GENERATED ALWAYS AS ROW START NOT NULL,
	[ValidTo] [datetime2](2) GENERATED ALWAYS AS ROW END NOT NULL,
 CONSTRAINT [PK_FilterId] PRIMARY KEY CLUSTERED 
(
	[FilterId] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY],
 CONSTRAINT [UC_Filter] UNIQUE NONCLUSTERED 
(
	[FilterCriterion1Id] ASC,
	[BooleanOperatorId] ASC,
	[FilterCriterion2Id] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY],
	PERIOD FOR SYSTEM_TIME ([ValidFrom], [ValidTo])
) ON [PRIMARY]
WITH
(
SYSTEM_VERSIONING = ON (HISTORY_TABLE = [risk].[Filter_H])
)
GO
/****** Object:  Table [instr].[Calendar_H]    Script Date: 23/08/2023 15:39:54 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [instr].[Calendar_H](
	[CalendarDate] [date] NOT NULL,
	[DayOfMonthNum] [tinyint] NOT NULL,
	[DaySuffix] [char](2) NOT NULL,
	[DayOfWeekName] [nvarchar](9) NOT NULL,
	[DayOfWeekNum] [tinyint] NOT NULL,
	[DayOfWeekInMonthNum] [tinyint] NOT NULL,
	[DayOfYearNum] [smallint] NOT NULL,
	[IsWeekend] [bit] NOT NULL,
	[WeekOfYearNum] [tinyint] NOT NULL,
	[ISOWeekOfYearNum] [tinyint] NOT NULL,
	[FirstDateOfWeek] [date] NOT NULL,
	[LastDateOfWeek] [date] NOT NULL,
	[WeekOfMonthNum] [tinyint] NOT NULL,
	[MonthOfTheYearNum] [tinyint] NOT NULL,
	[MonthOfYearName] [nvarchar](9) NOT NULL,
	[FirstDateOfMonth] [date] NOT NULL,
	[LastDateOfMonth] [date] NOT NULL,
	[FirstDateOfNextMonth] [date] NOT NULL,
	[LastDateOfNextMonth] [date] NOT NULL,
	[QuarterNum] [tinyint] NOT NULL,
	[FirstDateOfQuarter] [date] NOT NULL,
	[LastDateOfQuarter] [date] NOT NULL,
	[CalendarYear] [smallint] NULL,
	[ISOCalendarYearValue] [smallint] NULL,
	[FirstDateOfYear] [date] NOT NULL,
	[LastDateOfYear] [date] NOT NULL,
	[IsLeapYear] [bit] NOT NULL,
	[Has53Weeks] [bit] NOT NULL,
	[Has53ISOWeeks] [bit] NOT NULL,
	[IsIMMDate] [bit] NOT NULL,
	[ValidFrom] [datetime2](2) NOT NULL,
	[ValidTo] [datetime2](2) NOT NULL
) ON [PRIMARY]
WITH
(
DATA_COMPRESSION = PAGE
)
GO
/****** Object:  Index [ix_Calendar_H]    Script Date: 23/08/2023 15:39:54 ******/
CREATE CLUSTERED INDEX [ix_Calendar_H] ON [instr].[Calendar_H]
(
	[ValidTo] ASC,
	[ValidFrom] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, SORT_IN_TEMPDB = OFF, DROP_EXISTING = OFF, ONLINE = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF, DATA_COMPRESSION = PAGE) ON [PRIMARY]
GO
/****** Object:  Table [instr].[Calendar]    Script Date: 23/08/2023 15:39:54 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [instr].[Calendar](
	[CalendarDate] [date] NOT NULL,
	[DayOfMonthNum] [tinyint] NOT NULL,
	[DaySuffix] [char](2) NOT NULL,
	[DayOfWeekName] [nvarchar](9) NOT NULL,
	[DayOfWeekNum] [tinyint] NOT NULL,
	[DayOfWeekInMonthNum] [tinyint] NOT NULL,
	[DayOfYearNum] [smallint] NOT NULL,
	[IsWeekend] [bit] NOT NULL,
	[WeekOfYearNum] [tinyint] NOT NULL,
	[ISOWeekOfYearNum] [tinyint] NOT NULL,
	[FirstDateOfWeek] [date] NOT NULL,
	[LastDateOfWeek] [date] NOT NULL,
	[WeekOfMonthNum] [tinyint] NOT NULL,
	[MonthOfTheYearNum] [tinyint] NOT NULL,
	[MonthOfYearName] [nvarchar](9) NOT NULL,
	[FirstDateOfMonth] [date] NOT NULL,
	[LastDateOfMonth] [date] NOT NULL,
	[FirstDateOfNextMonth] [date] NOT NULL,
	[LastDateOfNextMonth] [date] NOT NULL,
	[QuarterNum] [tinyint] NOT NULL,
	[FirstDateOfQuarter] [date] NOT NULL,
	[LastDateOfQuarter] [date] NOT NULL,
	[CalendarYear] [smallint] NULL,
	[ISOCalendarYearValue] [smallint] NULL,
	[FirstDateOfYear] [date] NOT NULL,
	[LastDateOfYear] [date] NOT NULL,
	[IsLeapYear] [bit] NOT NULL,
	[Has53Weeks] [bit] NOT NULL,
	[Has53ISOWeeks] [bit] NOT NULL,
	[IsIMMDate] [bit] NOT NULL,
	[ValidFrom] [datetime2](2) GENERATED ALWAYS AS ROW START NOT NULL,
	[ValidTo] [datetime2](2) GENERATED ALWAYS AS ROW END NOT NULL,
 CONSTRAINT [PK_Calendar] PRIMARY KEY CLUSTERED 
(
	[CalendarDate] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY],
	PERIOD FOR SYSTEM_TIME ([ValidFrom], [ValidTo])
) ON [PRIMARY]
WITH
(
SYSTEM_VERSIONING = ON (HISTORY_TABLE = [instr].[Calendar_H])
)
GO
/****** Object:  Table [conv].[InstrumentMappingType_H]    Script Date: 23/08/2023 15:39:54 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [conv].[InstrumentMappingType_H](
	[InstrumentMappingTypeId] [tinyint] NOT NULL,
	[Mnemonic] [nvarchar](30) NOT NULL,
	[ValidFrom] [datetime2](2) NOT NULL,
	[ValidTo] [datetime2](2) NOT NULL
) ON [PRIMARY]
WITH
(
DATA_COMPRESSION = PAGE
)
GO
/****** Object:  Index [ix_InstrumentMappingType_H]    Script Date: 23/08/2023 15:39:54 ******/
CREATE CLUSTERED INDEX [ix_InstrumentMappingType_H] ON [conv].[InstrumentMappingType_H]
(
	[ValidTo] ASC,
	[ValidFrom] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, SORT_IN_TEMPDB = OFF, DROP_EXISTING = OFF, ONLINE = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF, DATA_COMPRESSION = PAGE) ON [PRIMARY]
GO
/****** Object:  Table [conv].[InstrumentMappingType]    Script Date: 23/08/2023 15:39:54 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [conv].[InstrumentMappingType](
	[InstrumentMappingTypeId] [tinyint] IDENTITY(1,1) NOT NULL,
	[Mnemonic] [nvarchar](30) NOT NULL,
	[ValidFrom] [datetime2](2) GENERATED ALWAYS AS ROW START NOT NULL,
	[ValidTo] [datetime2](2) GENERATED ALWAYS AS ROW END NOT NULL,
 CONSTRAINT [PK_InstrumentMappingType] PRIMARY KEY CLUSTERED 
(
	[InstrumentMappingTypeId] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY],
 CONSTRAINT [UC_InstrumentType_Mnemonic] UNIQUE NONCLUSTERED 
(
	[Mnemonic] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY],
	PERIOD FOR SYSTEM_TIME ([ValidFrom], [ValidTo])
) ON [PRIMARY]
WITH
(
SYSTEM_VERSIONING = ON (HISTORY_TABLE = [conv].[InstrumentMappingType_H])
)
GO
/****** Object:  Table [risk].[PortfolioConstraint_H]    Script Date: 23/08/2023 15:39:54 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [risk].[PortfolioConstraint_H](
	[PortfolioConstraintId] [int] NOT NULL,
	[PortfolioId] [tinyint] NOT NULL,
	[ConstraintId] [int] NOT NULL,
	[ValidFrom] [datetime2](2) NOT NULL,
	[ValidTo] [datetime2](2) NOT NULL
) ON [PRIMARY]
WITH
(
DATA_COMPRESSION = PAGE
)
GO
/****** Object:  Index [ix_PortfolioConstraint_H]    Script Date: 23/08/2023 15:39:54 ******/
CREATE CLUSTERED INDEX [ix_PortfolioConstraint_H] ON [risk].[PortfolioConstraint_H]
(
	[ValidTo] ASC,
	[ValidFrom] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, SORT_IN_TEMPDB = OFF, DROP_EXISTING = OFF, ONLINE = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF, DATA_COMPRESSION = PAGE) ON [PRIMARY]
GO
/****** Object:  Table [risk].[PortfolioConstraint]    Script Date: 23/08/2023 15:39:54 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [risk].[PortfolioConstraint](
	[PortfolioConstraintId] [int] IDENTITY(1,1) NOT NULL,
	[PortfolioId] [tinyint] NOT NULL,
	[ConstraintId] [int] NOT NULL,
	[ValidFrom] [datetime2](2) GENERATED ALWAYS AS ROW START NOT NULL,
	[ValidTo] [datetime2](2) GENERATED ALWAYS AS ROW END NOT NULL,
 CONSTRAINT [PK_PortfolioConstraint] PRIMARY KEY CLUSTERED 
(
	[PortfolioConstraintId] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY],
 CONSTRAINT [UC_PortfolioConstraint] UNIQUE NONCLUSTERED 
(
	[PortfolioId] ASC,
	[ConstraintId] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY],
	PERIOD FOR SYSTEM_TIME ([ValidFrom], [ValidTo])
) ON [PRIMARY]
WITH
(
SYSTEM_VERSIONING = ON (HISTORY_TABLE = [risk].[PortfolioConstraint_H])
)
GO
/****** Object:  Table [rout].[Account_H]    Script Date: 23/08/2023 15:39:54 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [rout].[Account_H](
	[AccountId] [int] NOT NULL,
	[Code] [nvarchar](50) NOT NULL,
	[ValidFrom] [datetime2](2) NOT NULL,
	[ValidTo] [datetime2](2) NOT NULL
) ON [PRIMARY]
WITH
(
DATA_COMPRESSION = PAGE
)
GO
/****** Object:  Index [ix_Account_H]    Script Date: 23/08/2023 15:39:54 ******/
CREATE CLUSTERED INDEX [ix_Account_H] ON [rout].[Account_H]
(
	[ValidTo] ASC,
	[ValidFrom] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, SORT_IN_TEMPDB = OFF, DROP_EXISTING = OFF, ONLINE = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF, DATA_COMPRESSION = PAGE) ON [PRIMARY]
GO
/****** Object:  Table [rout].[Account]    Script Date: 23/08/2023 15:39:54 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [rout].[Account](
	[AccountId] [int] IDENTITY(1,1) NOT NULL,
	[Code] [nvarchar](50) NOT NULL,
	[ValidFrom] [datetime2](2) GENERATED ALWAYS AS ROW START NOT NULL,
	[ValidTo] [datetime2](2) GENERATED ALWAYS AS ROW END NOT NULL,
 CONSTRAINT [PK_Account] PRIMARY KEY CLUSTERED 
(
	[AccountId] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY],
	PERIOD FOR SYSTEM_TIME ([ValidFrom], [ValidTo])
) ON [PRIMARY]
WITH
(
SYSTEM_VERSIONING = ON (HISTORY_TABLE = [rout].[Account_H])
)
GO
/****** Object:  Table [conv].[InstrumentMapping_H]    Script Date: 23/08/2023 15:39:54 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [conv].[InstrumentMapping_H](
	[FromInstrumentId] [int] NOT NULL,
	[ToInstrumentId] [int] NOT NULL,
	[InstrumentMappingTypeId] [tinyint] NOT NULL,
	[ValidFrom] [datetime2](2) NOT NULL,
	[ValidTo] [datetime2](2) NOT NULL
) ON [PRIMARY]
WITH
(
DATA_COMPRESSION = PAGE
)
GO
/****** Object:  Index [ix_InstrumentMapping_H]    Script Date: 23/08/2023 15:39:54 ******/
CREATE CLUSTERED INDEX [ix_InstrumentMapping_H] ON [conv].[InstrumentMapping_H]
(
	[ValidTo] ASC,
	[ValidFrom] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, SORT_IN_TEMPDB = OFF, DROP_EXISTING = OFF, ONLINE = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF, DATA_COMPRESSION = PAGE) ON [PRIMARY]
GO
/****** Object:  Table [conv].[InstrumentMapping]    Script Date: 23/08/2023 15:39:54 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [conv].[InstrumentMapping](
	[FromInstrumentId] [int] NOT NULL,
	[ToInstrumentId] [int] NOT NULL,
	[InstrumentMappingTypeId] [tinyint] NOT NULL,
	[ValidFrom] [datetime2](2) GENERATED ALWAYS AS ROW START NOT NULL,
	[ValidTo] [datetime2](2) GENERATED ALWAYS AS ROW END NOT NULL,
 CONSTRAINT [PK_InstrumentMapping] PRIMARY KEY CLUSTERED 
(
	[FromInstrumentId] ASC,
	[InstrumentMappingTypeId] ASC,
	[ToInstrumentId] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY],
	PERIOD FOR SYSTEM_TIME ([ValidFrom], [ValidTo])
) ON [PRIMARY]
WITH
(
SYSTEM_VERSIONING = ON (HISTORY_TABLE = [conv].[InstrumentMapping_H])
)
GO
/****** Object:  Table [rout].[AccountSelectionRule_H]    Script Date: 23/08/2023 15:39:54 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [rout].[AccountSelectionRule_H](
	[AccountSelectionRuleId] [int] NOT NULL,
	[BrokerId] [int] NOT NULL,
	[InstrumentTypeId] [tinyint] NOT NULL,
	[AccountId] [int] NOT NULL,
	[ValidFrom] [datetime2](2) NOT NULL,
	[ValidTo] [datetime2](2) NOT NULL
) ON [PRIMARY]
WITH
(
DATA_COMPRESSION = PAGE
)
GO
/****** Object:  Index [ix_AccountSelectionRule_H]    Script Date: 23/08/2023 15:39:54 ******/
CREATE CLUSTERED INDEX [ix_AccountSelectionRule_H] ON [rout].[AccountSelectionRule_H]
(
	[ValidTo] ASC,
	[ValidFrom] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, SORT_IN_TEMPDB = OFF, DROP_EXISTING = OFF, ONLINE = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF, DATA_COMPRESSION = PAGE) ON [PRIMARY]
GO
/****** Object:  Table [rout].[AccountSelectionRule]    Script Date: 23/08/2023 15:39:54 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [rout].[AccountSelectionRule](
	[AccountSelectionRuleId] [int] IDENTITY(1,1) NOT NULL,
	[BrokerId] [int] NOT NULL,
	[InstrumentTypeId] [tinyint] NOT NULL,
	[AccountId] [int] NOT NULL,
	[ValidFrom] [datetime2](2) GENERATED ALWAYS AS ROW START NOT NULL,
	[ValidTo] [datetime2](2) GENERATED ALWAYS AS ROW END NOT NULL,
 CONSTRAINT [PK_AccountSelectionRule] PRIMARY KEY CLUSTERED 
(
	[AccountSelectionRuleId] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY],
	PERIOD FOR SYSTEM_TIME ([ValidFrom], [ValidTo])
) ON [PRIMARY]
WITH
(
SYSTEM_VERSIONING = ON (HISTORY_TABLE = [rout].[AccountSelectionRule_H])
)
GO
/****** Object:  Table [conv].[CurrencyPairConversionRule_H]    Script Date: 23/08/2023 15:39:54 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [conv].[CurrencyPairConversionRule_H](
	[CurrencyPairConversionRuleId] [int] NOT NULL,
	[PortfolioId] [tinyint] NULL,
	[InvertCurrencyPair] [bit] NOT NULL,
	[ConvertToForward] [bit] NOT NULL,
	[ValidFrom] [datetime2](2) NOT NULL,
	[ValidTo] [datetime2](2) NOT NULL
) ON [PRIMARY]
WITH
(
DATA_COMPRESSION = PAGE
)
GO
/****** Object:  Index [ix_CurrencyPairConversionRule_H]    Script Date: 23/08/2023 15:39:54 ******/
CREATE CLUSTERED INDEX [ix_CurrencyPairConversionRule_H] ON [conv].[CurrencyPairConversionRule_H]
(
	[ValidTo] ASC,
	[ValidFrom] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, SORT_IN_TEMPDB = OFF, DROP_EXISTING = OFF, ONLINE = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF, DATA_COMPRESSION = PAGE) ON [PRIMARY]
GO
/****** Object:  Table [conv].[CurrencyPairConversionRule]    Script Date: 23/08/2023 15:39:54 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [conv].[CurrencyPairConversionRule](
	[CurrencyPairConversionRuleId] [int] IDENTITY(1,1) NOT NULL,
	[PortfolioId] [tinyint] NULL,
	[InvertCurrencyPair] [bit] NOT NULL,
	[ConvertToForward] [bit] NOT NULL,
	[ValidFrom] [datetime2](2) GENERATED ALWAYS AS ROW START NOT NULL,
	[ValidTo] [datetime2](2) GENERATED ALWAYS AS ROW END NOT NULL,
 CONSTRAINT [PK_CurrencyPairConversionRule] PRIMARY KEY CLUSTERED 
(
	[CurrencyPairConversionRuleId] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY],
	PERIOD FOR SYSTEM_TIME ([ValidFrom], [ValidTo])
) ON [PRIMARY]
WITH
(
SYSTEM_VERSIONING = ON (HISTORY_TABLE = [conv].[CurrencyPairConversionRule_H])
)
GO
/****** Object:  Table [instr].[CurrencyPair_H]    Script Date: 23/08/2023 15:39:54 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [instr].[CurrencyPair_H](
	[CurrencyPairId] [int] NOT NULL,
	[BaseCurrencyId] [tinyint] NOT NULL,
	[QuoteCurrencyId] [tinyint] NOT NULL,
	[ValidFrom] [datetime2](2) NOT NULL,
	[ValidTo] [datetime2](2) NOT NULL
) ON [PRIMARY]
WITH
(
DATA_COMPRESSION = PAGE
)
GO
/****** Object:  Index [ix_CurrencyPair_H]    Script Date: 23/08/2023 15:39:54 ******/
CREATE CLUSTERED INDEX [ix_CurrencyPair_H] ON [instr].[CurrencyPair_H]
(
	[ValidTo] ASC,
	[ValidFrom] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, SORT_IN_TEMPDB = OFF, DROP_EXISTING = OFF, ONLINE = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF, DATA_COMPRESSION = PAGE) ON [PRIMARY]
GO
/****** Object:  Table [instr].[CurrencyPair]    Script Date: 23/08/2023 15:39:54 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [instr].[CurrencyPair](
	[CurrencyPairId] [int] NOT NULL,
	[BaseCurrencyId] [tinyint] NOT NULL,
	[QuoteCurrencyId] [tinyint] NOT NULL,
	[ValidFrom] [datetime2](2) GENERATED ALWAYS AS ROW START NOT NULL,
	[ValidTo] [datetime2](2) GENERATED ALWAYS AS ROW END NOT NULL,
 CONSTRAINT [PK_CurrencyPair] PRIMARY KEY CLUSTERED 
(
	[CurrencyPairId] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY],
 CONSTRAINT [UC_CurrencyPair_CurrencyPair] UNIQUE NONCLUSTERED 
(
	[BaseCurrencyId] ASC,
	[QuoteCurrencyId] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY],
	PERIOD FOR SYSTEM_TIME ([ValidFrom], [ValidTo])
) ON [PRIMARY]
WITH
(
SYSTEM_VERSIONING = ON (HISTORY_TABLE = [instr].[CurrencyPair_H])
)
GO
/****** Object:  Table [exec].[ExecutionAlgorithm_H]    Script Date: 23/08/2023 15:39:54 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [exec].[ExecutionAlgorithm_H](
	[ExecutionAlgorithmId] [int] NOT NULL,
	[Mnmemonic] [nvarchar](10) NOT NULL,
	[Name] [nvarchar](50) NOT NULL,
	[ValidFrom] [datetime2](2) NOT NULL,
	[ValidTo] [datetime2](2) NOT NULL
) ON [PRIMARY]
WITH
(
DATA_COMPRESSION = PAGE
)
GO
/****** Object:  Index [ix_ExecutionAlgorithm_H]    Script Date: 23/08/2023 15:39:54 ******/
CREATE CLUSTERED INDEX [ix_ExecutionAlgorithm_H] ON [exec].[ExecutionAlgorithm_H]
(
	[ValidTo] ASC,
	[ValidFrom] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, SORT_IN_TEMPDB = OFF, DROP_EXISTING = OFF, ONLINE = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF, DATA_COMPRESSION = PAGE) ON [PRIMARY]
GO
/****** Object:  Table [exec].[ExecutionAlgorithm]    Script Date: 23/08/2023 15:39:54 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [exec].[ExecutionAlgorithm](
	[ExecutionAlgorithmId] [int] IDENTITY(1,1) NOT NULL,
	[Mnmemonic] [nvarchar](10) NOT NULL,
	[Name] [nvarchar](50) NOT NULL,
	[ValidFrom] [datetime2](2) GENERATED ALWAYS AS ROW START NOT NULL,
	[ValidTo] [datetime2](2) GENERATED ALWAYS AS ROW END NOT NULL,
 CONSTRAINT [PK_ExecutionAlgorithm] PRIMARY KEY CLUSTERED 
(
	[ExecutionAlgorithmId] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY],
	PERIOD FOR SYSTEM_TIME ([ValidFrom], [ValidTo])
) ON [PRIMARY]
WITH
(
SYSTEM_VERSIONING = ON (HISTORY_TABLE = [exec].[ExecutionAlgorithm_H])
)
GO
/****** Object:  Table [exec].[OrderType_H]    Script Date: 23/08/2023 15:39:54 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [exec].[OrderType_H](
	[OrderTypeId] [int] NOT NULL,
	[Mnemonic] [nvarchar](10) NOT NULL,
	[Name] [nvarchar](50) NOT NULL,
	[Description] [nvarchar](200) NOT NULL,
	[ValidFrom] [datetime2](2) NOT NULL,
	[ValidTo] [datetime2](2) NOT NULL
) ON [PRIMARY]
WITH
(
DATA_COMPRESSION = PAGE
)
GO
/****** Object:  Index [ix_OrderType_H]    Script Date: 23/08/2023 15:39:54 ******/
CREATE CLUSTERED INDEX [ix_OrderType_H] ON [exec].[OrderType_H]
(
	[ValidTo] ASC,
	[ValidFrom] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, SORT_IN_TEMPDB = OFF, DROP_EXISTING = OFF, ONLINE = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF, DATA_COMPRESSION = PAGE) ON [PRIMARY]
GO
/****** Object:  Table [exec].[OrderType]    Script Date: 23/08/2023 15:39:54 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [exec].[OrderType](
	[OrderTypeId] [int] IDENTITY(1,1) NOT NULL,
	[Mnemonic] [nvarchar](10) NOT NULL,
	[Name] [nvarchar](50) NOT NULL,
	[Description] [nvarchar](200) NOT NULL,
	[ValidFrom] [datetime2](2) GENERATED ALWAYS AS ROW START NOT NULL,
	[ValidTo] [datetime2](2) GENERATED ALWAYS AS ROW END NOT NULL,
 CONSTRAINT [PK_OrderType] PRIMARY KEY CLUSTERED 
(
	[OrderTypeId] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY],
	PERIOD FOR SYSTEM_TIME ([ValidFrom], [ValidTo])
) ON [PRIMARY]
WITH
(
SYSTEM_VERSIONING = ON (HISTORY_TABLE = [exec].[OrderType_H])
)
GO
/****** Object:  Table [ord].[OrderSide_H]    Script Date: 23/08/2023 15:39:54 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [ord].[OrderSide_H](
	[OrderSideId] [int] NOT NULL,
	[Mnemonic] [nvarchar](10) NULL,
	[Name] [nvarchar](50) NOT NULL,
	[ValidFrom] [datetime2](2) NOT NULL,
	[ValidTo] [datetime2](2) NOT NULL
) ON [PRIMARY]
WITH
(
DATA_COMPRESSION = PAGE
)
GO
/****** Object:  Index [ix_OrderSide_H]    Script Date: 23/08/2023 15:39:54 ******/
CREATE CLUSTERED INDEX [ix_OrderSide_H] ON [ord].[OrderSide_H]
(
	[ValidTo] ASC,
	[ValidFrom] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, SORT_IN_TEMPDB = OFF, DROP_EXISTING = OFF, ONLINE = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF, DATA_COMPRESSION = PAGE) ON [PRIMARY]
GO
/****** Object:  Table [ord].[OrderSide]    Script Date: 23/08/2023 15:39:54 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [ord].[OrderSide](
	[OrderSideId] [int] IDENTITY(1,1) NOT NULL,
	[Mnemonic] [nvarchar](10) NULL,
	[Name] [nvarchar](50) NOT NULL,
	[ValidFrom] [datetime2](2) GENERATED ALWAYS AS ROW START NOT NULL,
	[ValidTo] [datetime2](2) GENERATED ALWAYS AS ROW END NOT NULL,
 CONSTRAINT [PK_OrderSide] PRIMARY KEY CLUSTERED 
(
	[OrderSideId] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY],
	PERIOD FOR SYSTEM_TIME ([ValidFrom], [ValidTo])
) ON [PRIMARY]
WITH
(
SYSTEM_VERSIONING = ON (HISTORY_TABLE = [ord].[OrderSide_H])
)
GO
/****** Object:  Table [instr].[FxForward_H]    Script Date: 23/08/2023 15:39:54 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [instr].[FxForward_H](
	[FxForwardId] [int] NOT NULL,
	[CurrencyPairId] [int] NOT NULL,
	[MaturityDate] [date] NOT NULL,
	[ValidFrom] [datetime2](2) NOT NULL,
	[ValidTo] [datetime2](2) NOT NULL
) ON [PRIMARY]
WITH
(
DATA_COMPRESSION = PAGE
)
GO
/****** Object:  Index [ix_FxForward_H]    Script Date: 23/08/2023 15:39:54 ******/
CREATE CLUSTERED INDEX [ix_FxForward_H] ON [instr].[FxForward_H]
(
	[ValidTo] ASC,
	[ValidFrom] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, SORT_IN_TEMPDB = OFF, DROP_EXISTING = OFF, ONLINE = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF, DATA_COMPRESSION = PAGE) ON [PRIMARY]
GO
/****** Object:  Table [instr].[FxForward]    Script Date: 23/08/2023 15:39:54 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [instr].[FxForward](
	[FxForwardId] [int] NOT NULL,
	[CurrencyPairId] [int] NOT NULL,
	[MaturityDate] [date] NOT NULL,
	[ValidFrom] [datetime2](2) GENERATED ALWAYS AS ROW START NOT NULL,
	[ValidTo] [datetime2](2) GENERATED ALWAYS AS ROW END NOT NULL,
 CONSTRAINT [PK_FxForward] PRIMARY KEY CLUSTERED 
(
	[FxForwardId] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY],
 CONSTRAINT [UC_FxForward] UNIQUE NONCLUSTERED 
(
	[CurrencyPairId] ASC,
	[MaturityDate] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY],
	PERIOD FOR SYSTEM_TIME ([ValidFrom], [ValidTo])
) ON [PRIMARY]
WITH
(
SYSTEM_VERSIONING = ON (HISTORY_TABLE = [instr].[FxForward_H])
)
GO
/****** Object:  Table [exec].[TimeInForce_H]    Script Date: 23/08/2023 15:39:54 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [exec].[TimeInForce_H](
	[TimeInForceId] [int] NOT NULL,
	[Mnemonic] [nvarchar](10) NOT NULL,
	[Name] [nvarchar](50) NOT NULL,
	[Description] [nvarchar](200) NOT NULL,
	[ValidFrom] [datetime2](2) NOT NULL,
	[ValidTo] [datetime2](2) NOT NULL
) ON [PRIMARY]
WITH
(
DATA_COMPRESSION = PAGE
)
GO
/****** Object:  Index [ix_TimeInForce_H]    Script Date: 23/08/2023 15:39:54 ******/
CREATE CLUSTERED INDEX [ix_TimeInForce_H] ON [exec].[TimeInForce_H]
(
	[ValidTo] ASC,
	[ValidFrom] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, SORT_IN_TEMPDB = OFF, DROP_EXISTING = OFF, ONLINE = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF, DATA_COMPRESSION = PAGE) ON [PRIMARY]
GO
/****** Object:  Table [exec].[TimeInForce]    Script Date: 23/08/2023 15:39:54 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [exec].[TimeInForce](
	[TimeInForceId] [int] IDENTITY(1,1) NOT NULL,
	[Mnemonic] [nvarchar](10) NOT NULL,
	[Name] [nvarchar](50) NOT NULL,
	[Description] [nvarchar](200) NOT NULL,
	[ValidFrom] [datetime2](2) GENERATED ALWAYS AS ROW START NOT NULL,
	[ValidTo] [datetime2](2) GENERATED ALWAYS AS ROW END NOT NULL,
 CONSTRAINT [PK_TimeInForce] PRIMARY KEY CLUSTERED 
(
	[TimeInForceId] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY],
	PERIOD FOR SYSTEM_TIME ([ValidFrom], [ValidTo])
) ON [PRIMARY]
WITH
(
SYSTEM_VERSIONING = ON (HISTORY_TABLE = [exec].[TimeInForce_H])
)
GO
/****** Object:  Table [exec].[HandlingInstruction_H]    Script Date: 23/08/2023 15:39:54 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [exec].[HandlingInstruction_H](
	[HandlingInstructionId] [int] NOT NULL,
	[Code] [nvarchar](10) NOT NULL,
	[Description] [nvarchar](200) NULL,
	[ValidFrom] [datetime2](2) NOT NULL,
	[ValidTo] [datetime2](2) NOT NULL
) ON [PRIMARY]
WITH
(
DATA_COMPRESSION = PAGE
)
GO
/****** Object:  Index [ix_HandlingInstruction_H]    Script Date: 23/08/2023 15:39:54 ******/
CREATE CLUSTERED INDEX [ix_HandlingInstruction_H] ON [exec].[HandlingInstruction_H]
(
	[ValidTo] ASC,
	[ValidFrom] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, SORT_IN_TEMPDB = OFF, DROP_EXISTING = OFF, ONLINE = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF, DATA_COMPRESSION = PAGE) ON [PRIMARY]
GO
/****** Object:  Table [exec].[HandlingInstruction]    Script Date: 23/08/2023 15:39:54 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [exec].[HandlingInstruction](
	[HandlingInstructionId] [int] IDENTITY(1,1) NOT NULL,
	[Code] [nvarchar](10) NOT NULL,
	[Description] [nvarchar](200) NULL,
	[ValidFrom] [datetime2](2) GENERATED ALWAYS AS ROW START NOT NULL,
	[ValidTo] [datetime2](2) GENERATED ALWAYS AS ROW END NOT NULL,
 CONSTRAINT [PK_HandlingInstruction] PRIMARY KEY CLUSTERED 
(
	[HandlingInstructionId] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY],
	PERIOD FOR SYSTEM_TIME ([ValidFrom], [ValidTo])
) ON [PRIMARY]
WITH
(
SYSTEM_VERSIONING = ON (HISTORY_TABLE = [exec].[HandlingInstruction_H])
)
GO
/****** Object:  Table [instr].[Instrument_H]    Script Date: 23/08/2023 15:39:54 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [instr].[Instrument_H](
	[InstrumentId] [int] NOT NULL,
	[InstrumentTypeId] [tinyint] NOT NULL,
	[Symbol] [nvarchar](30) NOT NULL,
	[Name] [nvarchar](100) NOT NULL,
	[CurrencyId] [tinyint] NOT NULL,
	[ExchangeId] [smallint] NULL,
	[ValidFrom] [datetime2](2) NOT NULL,
	[ValidTo] [datetime2](2) NOT NULL,
	[MarketSectorId] [tinyint] NULL
) ON [PRIMARY]
WITH
(
DATA_COMPRESSION = PAGE
)
GO
/****** Object:  Index [ix_Instrument_H]    Script Date: 23/08/2023 15:39:55 ******/
CREATE CLUSTERED INDEX [ix_Instrument_H] ON [instr].[Instrument_H]
(
	[ValidTo] ASC,
	[ValidFrom] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, SORT_IN_TEMPDB = OFF, DROP_EXISTING = OFF, ONLINE = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF, DATA_COMPRESSION = PAGE) ON [PRIMARY]
GO
/****** Object:  Table [instr].[Instrument]    Script Date: 23/08/2023 15:39:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [instr].[Instrument](
	[InstrumentId] [int] IDENTITY(1,1) NOT NULL,
	[InstrumentTypeId] [tinyint] NOT NULL,
	[Symbol] [nvarchar](30) NOT NULL,
	[Name] [nvarchar](100) NOT NULL,
	[CurrencyId] [tinyint] NOT NULL,
	[ExchangeId] [smallint] NULL,
	[ValidFrom] [datetime2](2) GENERATED ALWAYS AS ROW START NOT NULL,
	[ValidTo] [datetime2](2) GENERATED ALWAYS AS ROW END NOT NULL,
	[MarketSectorId] [tinyint] NULL,
 CONSTRAINT [PK_InstrumentId] PRIMARY KEY CLUSTERED 
(
	[InstrumentId] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY],
	PERIOD FOR SYSTEM_TIME ([ValidFrom], [ValidTo])
) ON [PRIMARY]
WITH
(
SYSTEM_VERSIONING = ON (HISTORY_TABLE = [instr].[Instrument_H])
)
GO
/****** Object:  Table [instr].[ConstinuousFuture_H]    Script Date: 23/08/2023 15:39:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [instr].[ConstinuousFuture_H](
	[GenericFutureId] [int] NOT NULL,
	[RootSymbol] [nvarchar](5) NOT NULL,
	[ContractSize] [decimal](18, 6) NOT NULL,
	[TickSize] [decimal](12, 6) NOT NULL,
	[TickValue] [decimal](12, 6) NOT NULL,
	[PointValue] [decimal](14, 6) NOT NULL,
	[ValidFrom] [datetime2](2) NOT NULL,
	[ValidTo] [datetime2](2) NOT NULL
) ON [PRIMARY]
WITH
(
DATA_COMPRESSION = PAGE
)
GO
/****** Object:  Index [ix_ConstinuousFuture_H]    Script Date: 23/08/2023 15:39:55 ******/
CREATE CLUSTERED INDEX [ix_ConstinuousFuture_H] ON [instr].[ConstinuousFuture_H]
(
	[ValidTo] ASC,
	[ValidFrom] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, SORT_IN_TEMPDB = OFF, DROP_EXISTING = OFF, ONLINE = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF, DATA_COMPRESSION = PAGE) ON [PRIMARY]
GO
/****** Object:  Table [instr].[GenericFuture]    Script Date: 23/08/2023 15:39:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [instr].[GenericFuture](
	[GenericFutureId] [int] NOT NULL,
	[RootSymbol] [nvarchar](5) NOT NULL,
	[ContractSize] [decimal](18, 6) NOT NULL,
	[TickSize] [decimal](12, 6) NOT NULL,
	[TickValue] [decimal](12, 6) NOT NULL,
	[PointValue] [decimal](14, 6) NOT NULL,
	[ValidFrom] [datetime2](2) GENERATED ALWAYS AS ROW START NOT NULL,
	[ValidTo] [datetime2](2) GENERATED ALWAYS AS ROW END NOT NULL,
 CONSTRAINT [PK_GenericFutureId] PRIMARY KEY CLUSTERED 
(
	[GenericFutureId] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY],
	PERIOD FOR SYSTEM_TIME ([ValidFrom], [ValidTo])
) ON [PRIMARY]
WITH
(
SYSTEM_VERSIONING = ON (HISTORY_TABLE = [instr].[ConstinuousFuture_H])
)
GO
/****** Object:  Table [port].[Portfolio_H]    Script Date: 23/08/2023 15:39:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [port].[Portfolio_H](
	[PortfolioId] [tinyint] NOT NULL,
	[Mnemonic] [nvarchar](6) NOT NULL,
	[Name] [nvarchar](50) NOT NULL,
	[Currency] [char](3) NOT NULL,
	[ValidFrom] [datetime2](2) NOT NULL,
	[ValidTo] [datetime2](2) NOT NULL
) ON [PRIMARY]
WITH
(
DATA_COMPRESSION = PAGE
)
GO
/****** Object:  Index [ix_Portfolio_H]    Script Date: 23/08/2023 15:39:55 ******/
CREATE CLUSTERED INDEX [ix_Portfolio_H] ON [port].[Portfolio_H]
(
	[ValidTo] ASC,
	[ValidFrom] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, SORT_IN_TEMPDB = OFF, DROP_EXISTING = OFF, ONLINE = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF, DATA_COMPRESSION = PAGE) ON [PRIMARY]
GO
/****** Object:  Table [port].[Portfolio]    Script Date: 23/08/2023 15:39:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [port].[Portfolio](
	[PortfolioId] [tinyint] IDENTITY(1,1) NOT NULL,
	[Mnemonic] [nvarchar](6) NOT NULL,
	[Name] [nvarchar](50) NOT NULL,
	[Currency] [char](3) NOT NULL,
	[ValidFrom] [datetime2](2) GENERATED ALWAYS AS ROW START NOT NULL,
	[ValidTo] [datetime2](2) GENERATED ALWAYS AS ROW END NOT NULL,
 CONSTRAINT [PK_PortfolioId] PRIMARY KEY CLUSTERED 
(
	[PortfolioId] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY],
 CONSTRAINT [UC_Portfolio_Mnemonic] UNIQUE NONCLUSTERED 
(
	[Mnemonic] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY],
	PERIOD FOR SYSTEM_TIME ([ValidFrom], [ValidTo])
) ON [PRIMARY]
WITH
(
SYSTEM_VERSIONING = ON (HISTORY_TABLE = [port].[Portfolio_H])
)
GO
/****** Object:  Table [port].[Position_H]    Script Date: 23/08/2023 15:39:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [port].[Position_H](
	[PositionId] [int] NOT NULL,
	[PortfolioId] [tinyint] NOT NULL,
	[InstrumentId] [int] NOT NULL,
	[Quantity] [int] NOT NULL,
	[AvgEntryPrice] [decimal](12, 6) NOT NULL,
	[LastTradeDate] [datetime2](7) NOT NULL,
	[ValidFrom] [datetime2](2) NOT NULL,
	[ValidTo] [datetime2](2) NOT NULL
) ON [PRIMARY]
WITH
(
DATA_COMPRESSION = PAGE
)
GO
/****** Object:  Index [ix_Position_H]    Script Date: 23/08/2023 15:39:55 ******/
CREATE CLUSTERED INDEX [ix_Position_H] ON [port].[Position_H]
(
	[ValidTo] ASC,
	[ValidFrom] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, SORT_IN_TEMPDB = OFF, DROP_EXISTING = OFF, ONLINE = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF, DATA_COMPRESSION = PAGE) ON [PRIMARY]
GO
/****** Object:  Table [port].[Position]    Script Date: 23/08/2023 15:39:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [port].[Position](
	[PositionId] [int] IDENTITY(1,1) NOT NULL,
	[PortfolioId] [tinyint] NOT NULL,
	[InstrumentId] [int] NOT NULL,
	[Quantity] [int] NOT NULL,
	[AvgEntryPrice] [decimal](12, 6) NOT NULL,
	[LastTradeDate] [datetime2](7) NOT NULL,
	[ValidFrom] [datetime2](2) GENERATED ALWAYS AS ROW START NOT NULL,
	[ValidTo] [datetime2](2) GENERATED ALWAYS AS ROW END NOT NULL,
 CONSTRAINT [PK_PositionId] PRIMARY KEY CLUSTERED 
(
	[PositionId] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY],
 CONSTRAINT [UC_Position] UNIQUE NONCLUSTERED 
(
	[PortfolioId] ASC,
	[InstrumentId] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY],
	PERIOD FOR SYSTEM_TIME ([ValidFrom], [ValidTo])
) ON [PRIMARY]
WITH
(
SYSTEM_VERSIONING = ON (HISTORY_TABLE = [port].[Position_H])
)
GO
/****** Object:  Table [exec].[ExecutionInfoSelectionRule_H]    Script Date: 23/08/2023 15:39:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [exec].[ExecutionInfoSelectionRule_H](
	[ExecutionInfoSelectionRuleId] [int] NOT NULL,
	[BrokerId] [int] NOT NULL,
	[InstrumentTypeId] [tinyint] NOT NULL,
	[AccountId] [int] NOT NULL,
	[ExecutionAlgorithmId] [int] NOT NULL,
	[OrderTypeId] [int] NOT NULL,
	[TimeInForceId] [int] NOT NULL,
	[HandlingInstructionId] [int] NOT NULL,
	[ValidFrom] [datetime2](2) NOT NULL,
	[ValidTo] [datetime2](2) NOT NULL
) ON [PRIMARY]
WITH
(
DATA_COMPRESSION = PAGE
)
GO
/****** Object:  Index [ix_ExecutionInfoSelectionRule_H]    Script Date: 23/08/2023 15:39:55 ******/
CREATE CLUSTERED INDEX [ix_ExecutionInfoSelectionRule_H] ON [exec].[ExecutionInfoSelectionRule_H]
(
	[ValidTo] ASC,
	[ValidFrom] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, SORT_IN_TEMPDB = OFF, DROP_EXISTING = OFF, ONLINE = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF, DATA_COMPRESSION = PAGE) ON [PRIMARY]
GO
/****** Object:  Table [exec].[ExecutionInfoSelectionRule]    Script Date: 23/08/2023 15:39:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [exec].[ExecutionInfoSelectionRule](
	[ExecutionInfoSelectionRuleId] [int] IDENTITY(1,1) NOT NULL,
	[BrokerId] [int] NOT NULL,
	[InstrumentTypeId] [tinyint] NOT NULL,
	[AccountId] [int] NOT NULL,
	[ExecutionAlgorithmId] [int] NOT NULL,
	[OrderTypeId] [int] NOT NULL,
	[TimeInForceId] [int] NOT NULL,
	[HandlingInstructionId] [int] NOT NULL,
	[ValidFrom] [datetime2](2) GENERATED ALWAYS AS ROW START NOT NULL,
	[ValidTo] [datetime2](2) GENERATED ALWAYS AS ROW END NOT NULL,
 CONSTRAINT [PK_ExecutionInfoSelectionRule] PRIMARY KEY CLUSTERED 
(
	[ExecutionInfoSelectionRuleId] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY],
 CONSTRAINT [UC_ExecutionInfoSelectionRule] UNIQUE NONCLUSTERED 
(
	[BrokerId] ASC,
	[InstrumentTypeId] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY],
	PERIOD FOR SYSTEM_TIME ([ValidFrom], [ValidTo])
) ON [PRIMARY]
WITH
(
SYSTEM_VERSIONING = ON (HISTORY_TABLE = [exec].[ExecutionInfoSelectionRule_H])
)
GO
/****** Object:  Table [blpapi].[Country]    Script Date: 23/08/2023 15:39:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [blpapi].[Country](
	[CountryId] [smallint] IDENTITY(1,1) NOT NULL,
	[Name] [nvarchar](200) NOT NULL,
	[IsoAlpha2Code] [char](2) NOT NULL
) ON [PRIMARY]
GO
/****** Object:  Table [blpapi].[CurrencyPair]    Script Date: 23/08/2023 15:39:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [blpapi].[CurrencyPair](
	[Symbol] [nvarchar](30) NOT NULL,
	[BaseCurrency] [char](3) NULL,
	[QuoteCurrency] [char](3) NULL,
PRIMARY KEY CLUSTERED 
(
	[Symbol] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  Table [blpapi].[FxForward]    Script Date: 23/08/2023 15:39:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [blpapi].[FxForward](
	[Symbol] [nvarchar](30) NOT NULL,
	[BaseCurrency] [nvarchar](3) NOT NULL,
	[QuoteCurrency] [nvarchar](3) NOT NULL,
	[MaturityDate] [date] NOT NULL,
	[CurrencyPairSymbol] [nvarchar](30) NOT NULL,
PRIMARY KEY CLUSTERED 
(
	[Symbol] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  Table [blpapi].[Currency]    Script Date: 23/08/2023 15:39:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [blpapi].[Currency](
	[CurrencyId] [tinyint] IDENTITY(1,1) NOT NULL,
	[Code] [char](3) NULL,
	[Name] [nvarchar](200) NOT NULL
) ON [PRIMARY]
GO
/****** Object:  Table [blpapi].[Exchange]    Script Date: 23/08/2023 15:39:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [blpapi].[Exchange](
	[ExchangeId] [smallint] IDENTITY(1,1) NOT NULL,
	[Symbol] [nvarchar](5) NOT NULL,
	[Name] [nvarchar](150) NOT NULL,
	[CountryId] [smallint] NOT NULL,
	[CurrencyId] [tinyint] NOT NULL,
	[TimeZoneId] [smallint] NOT NULL,
	[FirstSessionStartTime] [time](7) NOT NULL,
	[LastSessionEndTime] [time](7) NOT NULL,
	[ValidFrom] [datetime2](2) NOT NULL,
	[ValidTo] [datetime2](2) NOT NULL
) ON [PRIMARY]
GO
/****** Object:  Table [blpapi].[FutureContract]    Script Date: 23/08/2023 15:39:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [blpapi].[FutureContract](
	[FutureContractId] [int] NOT NULL,
	[GenericSymbol] [nvarchar](13) NOT NULL,
	[Symbol] [nvarchar](30) NOT NULL,
	[ContractMonth] [varchar](1) NOT NULL,
	[ContractYear] [int] NOT NULL,
	[LastTradeDate] [date] NOT NULL,
	[FirstNoticeDate] [date] NOT NULL,
PRIMARY KEY CLUSTERED 
(
	[Symbol] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  Table [blpapi].[FxRate]    Script Date: 23/08/2023 15:39:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [blpapi].[FxRate](
	[BaseCurrency] [char](3) NOT NULL,
	[QuoteCurrency] [char](3) NOT NULL,
	[Value] [decimal](12, 6) NOT NULL,
	[Date] [date] NOT NULL,
 CONSTRAINT [PK_FxRate] PRIMARY KEY CLUSTERED 
(
	[BaseCurrency] ASC,
	[QuoteCurrency] ASC,
	[Date] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  Table [blpapi].[GenericFuture]    Script Date: 23/08/2023 15:39:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [blpapi].[GenericFuture](
	[GenericFutureId] [int] NOT NULL,
	[Symbol] [nvarchar](30) NOT NULL,
	[Name] [nvarchar](50) NOT NULL,
	[RootSymbol] [nvarchar](5) NOT NULL,
	[MarketSector] [nvarchar](6) NOT NULL,
	[Currency] [char](3) NOT NULL,
	[ContractSize] [decimal](18, 6) NOT NULL,
	[TickSize] [decimal](12, 6) NOT NULL,
	[TickValue] [decimal](12, 6) NOT NULL,
	[PointValue] [decimal](14, 6) NOT NULL,
PRIMARY KEY CLUSTERED 
(
	[Symbol] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  Table [blpapi].[Instrument]    Script Date: 23/08/2023 15:39:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [blpapi].[Instrument](
	[Symbol] [nvarchar](30) NOT NULL,
	[Name] [nvarchar](100) NOT NULL,
	[Currency] [char](3) NOT NULL,
	[Exchange] [nvarchar](5) NULL,
	[MarketSector] [nvarchar](6) NOT NULL,
PRIMARY KEY CLUSTERED 
(
	[Symbol] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  Table [blpapi].[MarketSector]    Script Date: 23/08/2023 15:39:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [blpapi].[MarketSector](
	[MarketSectorId] [tinyint] IDENTITY(1,1) NOT NULL,
	[Mnemonic] [nvarchar](6) NOT NULL,
	[Name] [nvarchar](30) NOT NULL
) ON [PRIMARY]
GO
/****** Object:  Table [blpapi].[Price]    Script Date: 23/08/2023 15:39:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [blpapi].[Price](
	[PriceId] [int] IDENTITY(1,1) NOT NULL,
	[Symbol] [nvarchar](30) NOT NULL,
	[Value] [float] NOT NULL,
	[Currency] [char](3) NOT NULL,
	[Date] [date] NOT NULL,
PRIMARY KEY CLUSTERED 
(
	[PriceId] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  Table [conv].[Instrument]    Script Date: 23/08/2023 15:39:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [conv].[Instrument](
	[InstrumentId] [int] NOT NULL,
	[Symbol] [nvarchar](30) NOT NULL,
	[InstrumentType] [nvarchar](10) NOT NULL,
 CONSTRAINT [PK_InstrumentId] PRIMARY KEY CLUSTERED 
(
	[InstrumentId] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  Table [conv].[Portfolio]    Script Date: 23/08/2023 15:39:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [conv].[Portfolio](
	[PortfolioId] [tinyint] NOT NULL,
	[Mnemonic] [nvarchar](6) NOT NULL,
	[Name] [nvarchar](50) NOT NULL,
 CONSTRAINT [PK_PortfolioId] PRIMARY KEY CLUSTERED 
(
	[PortfolioId] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  Table [conv].[TargetAllocationConversion]    Script Date: 23/08/2023 15:39:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [conv].[TargetAllocationConversion](
	[TargetAllocationConversionId] [int] IDENTITY(1,1) NOT NULL,
	[TargetAllocationId] [int] NOT NULL,
	[ConvertedOn] [datetime2](7) NOT NULL,
 CONSTRAINT [PK_TargetAllocationConversion] PRIMARY KEY CLUSTERED 
(
	[TargetAllocationConversionId] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  Table [conv].[TargetWeightConversion]    Script Date: 23/08/2023 15:39:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [conv].[TargetWeightConversion](
	[TargetWeightConversionId] [int] IDENTITY(1,1) NOT NULL,
	[TargetAllocationConversionId] [int] NOT NULL,
	[FromInstrumentId] [int] NOT NULL,
	[FromSymbol] [int] NOT NULL,
	[FromWeight] [decimal](18, 6) NOT NULL,
	[ToInstrumentId] [int] NOT NULL,
	[ToSymbol] [int] NOT NULL,
	[ToWeight] [decimal](18, 6) NOT NULL,
 CONSTRAINT [PK_TargetWeightConversionId] PRIMARY KEY CLUSTERED 
(
	[TargetWeightConversionId] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[All_HistoricalData]    Script Date: 23/08/2023 15:39:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[All_HistoricalData](
	[Symbol] [nvarchar](50) NOT NULL,
	[Date] [date] NOT NULL,
	[Open] [float] NOT NULL,
	[High] [float] NOT NULL,
	[Low] [float] NOT NULL,
	[Close] [float] NOT NULL,
	[Adj_Close] [float] NOT NULL,
	[Volume] [tinyint] NOT NULL
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[Barchart_FutSpecs]    Script Date: 23/08/2023 15:39:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[Barchart_FutSpecs](
	[BloomTicker] [nvarchar](50) NOT NULL,
	[Symbol] [nvarchar](50) NOT NULL,
	[Contract] [nvarchar](100) NULL,
	[Exchange] [nvarchar](50) NULL,
	[ContractSize] [nvarchar](50) NULL,
	[TickSize] [nvarchar](150) NULL,
	[PointValue] [nvarchar](50) NULL
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[bloom_futspecs]    Script Date: 23/08/2023 15:39:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[bloom_futspecs](
	[BloombergTicker] [nvarchar](50) NOT NULL,
	[Price] [float] NULL,
	[PointValue] [float] NOT NULL,
	[Currency] [nvarchar](50) NOT NULL
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[countries]    Script Date: 23/08/2023 15:39:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[countries](
	[Name] [nvarchar](50) NOT NULL,
	[AlphaCode2] [nvarchar](50) NOT NULL,
	[AlphaCode3] [nvarchar](50) NOT NULL
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[currencies]    Script Date: 23/08/2023 15:39:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[currencies](
	[code] [nvarchar](50) NOT NULL,
	[name] [nvarchar](100) NOT NULL
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[data_fede]    Script Date: 23/08/2023 15:39:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[data_fede](
	[date] [date] NOT NULL,
	[securityid] [int] NOT NULL,
	[close] [float] NOT NULL,
	[bloombergticker] [nvarchar](50) NOT NULL,
	[Name] [nvarchar](50) NOT NULL,
	[SecurityType2] [nvarchar](50) NOT NULL,
	[SectorName] [nvarchar](50) NOT NULL
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[EQ_routing]    Script Date: 23/08/2023 15:39:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[EQ_routing](
	[Exchange] [nvarchar](50) NOT NULL,
	[BbgTimeZoneCity] [nvarchar](50) NOT NULL,
	[EMSBroker] [nvarchar](50) NOT NULL,
	[Account] [nvarchar](50) NOT NULL,
	[Strategy] [nvarchar](50) NOT NULL,
	[IsActive] [tinyint] NOT NULL,
	[OrderType] [nvarchar](50) NOT NULL,
	[Limit] [nvarchar](1) NULL,
	[TIF] [nvarchar](50) NOT NULL,
	[HandlingInsx] [nvarchar](50) NOT NULL,
	[Instructions] [nvarchar](50) NOT NULL,
	[StartTime] [time](7) NULL,
	[EndTime] [time](7) NULL,
	[Notes] [nvarchar](1) NULL,
	[Algo] [nvarchar](50) NOT NULL,
	[NbParam] [tinyint] NOT NULL,
	[P1] [nvarchar](50) NOT NULL,
	[V1] [time](7) NULL,
	[F1] [nvarchar](50) NULL,
	[P2] [nvarchar](50) NOT NULL,
	[V2] [nvarchar](50) NULL,
	[F2] [nvarchar](1) NULL,
	[P3] [nvarchar](50) NOT NULL,
	[V3] [nvarchar](50) NULL,
	[F3] [nvarchar](1) NULL,
	[P4] [nvarchar](50) NULL,
	[V4] [nvarchar](50) NULL,
	[F4] [nvarchar](1) NULL,
	[P5] [nvarchar](50) NULL,
	[V5] [nvarchar](1) NULL,
	[F5] [nvarchar](1) NULL,
	[P6] [nvarchar](50) NULL,
	[V6] [nvarchar](1) NULL,
	[F6] [nvarchar](1) NULL,
	[P7] [nvarchar](50) NULL,
	[V7] [nvarchar](1) NULL,
	[F7] [nvarchar](1) NULL,
	[P8] [nvarchar](50) NULL,
	[V8] [nvarchar](1) NULL,
	[F8] [nvarchar](1) NULL,
	[P9] [nvarchar](50) NULL,
	[V9] [nvarchar](1) NULL,
	[F9] [nvarchar](1) NULL,
	[P10] [nvarchar](50) NULL,
	[V10] [nvarchar](1) NULL,
	[F10] [nvarchar](1) NULL,
	[P11] [nvarchar](50) NULL,
	[V11] [nvarchar](1) NULL,
	[F11] [nvarchar](1) NULL,
	[P12] [nvarchar](50) NULL,
	[V12] [nvarchar](1) NULL,
	[F12] [nvarchar](1) NULL,
	[P13] [nvarchar](50) NULL,
	[V13] [nvarchar](1) NULL,
	[F13] [nvarchar](1) NULL,
	[P14] [nvarchar](1) NULL,
	[V14] [nvarchar](1) NULL,
	[F14] [nvarchar](1) NULL,
	[P15] [nvarchar](1) NULL,
	[V15] [nvarchar](1) NULL,
	[F15] [nvarchar](1) NULL,
	[P16] [nvarchar](1) NULL,
	[V16] [nvarchar](1) NULL,
	[F16] [nvarchar](1) NULL,
	[P17] [nvarchar](1) NULL,
	[V17] [nvarchar](1) NULL,
	[F17] [nvarchar](1) NULL,
	[P18] [nvarchar](1) NULL,
	[V18] [nvarchar](1) NULL,
	[F18] [nvarchar](1) NULL,
	[P19] [nvarchar](1) NULL,
	[V19] [nvarchar](1) NULL,
	[F19] [nvarchar](1) NULL,
	[P20] [nvarchar](1) NULL,
	[V20] [nvarchar](1) NULL,
	[F20] [nvarchar](1) NULL
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[exchange2]    Script Date: 23/08/2023 15:39:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[exchange2](
	[Exchange] [nvarchar](100) NULL,
	[code] [nvarchar](5) NULL,
	[name] [nvarchar](100) NULL,
	[Country_Code] [nvarchar](50) NULL,
	[Countryid] [smallint] NOT NULL,
	[CurrencyId] [tinyint] NOT NULL,
	[Currency_Code] [nvarchar](50) NULL,
	[Days_of_the_Week] [nvarchar](150) NULL,
	[Time_Zone] [nvarchar](50) NULL,
	[offset] [nvarchar](5) NULL,
	[First_Session] [time](7) NULL,
	[Last_Session] [nvarchar](50) NULL
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[exchanges]    Script Date: 23/08/2023 15:39:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[exchanges](
	[Exchange] [nvarchar](100) NULL,
	[code] [nvarchar](5) NULL,
	[Country_Code] [nvarchar](50) NULL,
	[Countryid] [smallint] NOT NULL,
	[CurrencyId] [tinyint] NOT NULL,
	[Currency_Code] [nvarchar](50) NULL,
	[Days_of_the_Week] [nvarchar](150) NULL,
	[Time_Zone] [nvarchar](50) NULL,
	[offset] [nvarchar](5) NULL,
	[First_Session] [time](7) NULL,
	[Last_Session] [nvarchar](50) NULL
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[figi_results]    Script Date: 23/08/2023 15:39:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[figi_results](
	[idType] [nvarchar](50) NOT NULL,
	[idValue] [nvarchar](50) NOT NULL,
	[exchCode] [nvarchar](50) NOT NULL
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[FUT_routing]    Script Date: 23/08/2023 15:39:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[FUT_routing](
	[TickerGeneric] [nvarchar](50) NULL,
	[YellowKey] [nvarchar](50) NULL,
	[NameGeneric] [nvarchar](50) NULL,
	[BbgTimeZoneCity] [nvarchar](50) NULL,
	[TasTicker] [nvarchar](50) NULL,
	[EMSBroker] [nvarchar](50) NULL,
	[Account] [nvarchar](50) NULL,
	[Strategy] [nvarchar](50) NULL,
	[IsActive] [bit] NULL,
	[OrderType] [nvarchar](50) NULL,
	[Limit] [int] NULL,
	[TIF] [nvarchar](50) NULL,
	[HandlingInsx] [nvarchar](50) NULL,
	[Instructions] [nvarchar](100) NULL,
	[StartTime] [time](7) NULL,
	[EndTime] [time](7) NULL,
	[Notes] [nvarchar](800) NULL,
	[TheoSettlementPxCalc] [nvarchar](1250) NULL,
	[Algo] [nvarchar](50) NULL,
	[NbParam] [tinyint] NULL,
	[P1] [nvarchar](50) NULL,
	[V1] [nvarchar](50) NULL,
	[F1] [nvarchar](1) NULL,
	[P2] [nvarchar](50) NULL,
	[V2] [time](7) NULL,
	[F2] [nvarchar](1) NULL,
	[P3] [nvarchar](50) NULL,
	[V3] [nvarchar](50) NULL,
	[F3] [nvarchar](50) NULL,
	[P4] [nvarchar](50) NULL,
	[V4] [tinyint] NULL,
	[F4] [nvarchar](1) NULL,
	[P5] [nvarchar](50) NULL,
	[V5] [nvarchar](1) NULL,
	[F5] [nvarchar](1) NULL,
	[P6] [nvarchar](50) NULL,
	[V6] [nvarchar](50) NULL,
	[F6] [nvarchar](1) NULL,
	[P7] [nvarchar](50) NULL,
	[V7] [tinyint] NULL,
	[F7] [nvarchar](1) NULL,
	[P8] [nvarchar](50) NULL,
	[V8] [nvarchar](1) NULL,
	[F8] [nvarchar](1) NULL,
	[P9] [nvarchar](1) NULL,
	[V9] [nvarchar](1) NULL,
	[F9] [nvarchar](1) NULL,
	[P10] [nvarchar](1) NULL,
	[V10] [nvarchar](1) NULL,
	[F10] [nvarchar](1) NULL,
	[P11] [nvarchar](1) NULL,
	[V11] [nvarchar](1) NULL,
	[F11] [nvarchar](1) NULL,
	[P12] [nvarchar](1) NULL,
	[V12] [nvarchar](1) NULL,
	[F12] [nvarchar](1) NULL,
	[P13] [nvarchar](1) NULL,
	[V13] [nvarchar](1) NULL,
	[F13] [nvarchar](1) NULL,
	[P14] [nvarchar](1) NULL,
	[V14] [nvarchar](1) NULL,
	[F14] [nvarchar](1) NULL,
	[P15] [nvarchar](1) NULL,
	[V15] [nvarchar](1) NULL,
	[F15] [nvarchar](1) NULL,
	[P16] [nvarchar](1) NULL,
	[V16] [nvarchar](1) NULL,
	[F16] [nvarchar](1) NULL,
	[P17] [nvarchar](1) NULL,
	[V17] [nvarchar](1) NULL,
	[F17] [nvarchar](1) NULL,
	[P18] [nvarchar](1) NULL,
	[V18] [nvarchar](1) NULL,
	[F18] [nvarchar](1) NULL,
	[P19] [nvarchar](1) NULL,
	[V19] [nvarchar](1) NULL,
	[F19] [nvarchar](1) NULL,
	[P20] [nvarchar](1) NULL,
	[V20] [nvarchar](1) NULL,
	[F20] [nvarchar](1) NULL
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[FutureContracts]    Script Date: 23/08/2023 15:39:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[FutureContracts](
	[FutureContractId] [smallint] NOT NULL,
	[ContractMonth] [nvarchar](50) NOT NULL,
	[FutureContractSpecificationId] [tinyint] NOT NULL,
	[RootSymbol] [nvarchar](50) NOT NULL,
	[Name] [nvarchar](50) NOT NULL,
	[UnderlyingTypeId] [tinyint] NOT NULL,
	[CurrencyId] [tinyint] NOT NULL,
	[ContractSize] [float] NOT NULL,
	[TickSize] [float] NOT NULL,
	[TickValue] [float] NOT NULL,
	[PointValue] [float] NOT NULL,
	[ContractYearDigit] [tinyint] NOT NULL,
	[ValidFrom] [datetime2](7) NOT NULL,
	[ValidTo] [datetime2](7) NOT NULL,
	[ExchangeSymbol] [nvarchar](50) NOT NULL,
	[Currency] [nvarchar](50) NOT NULL,
	[Mnemonic] [nvarchar](50) NOT NULL,
	[ContractYear] [smallint] NOT NULL,
	[LastTradeDate] [date] NOT NULL,
	[FirstNoticeDate] [date] NOT NULL
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[FutureContractSpec]    Script Date: 23/08/2023 15:39:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[FutureContractSpec](
	[FutureContractSpecificationId] [tinyint] NOT NULL,
	[RootSymbol] [nvarchar](50) NOT NULL,
	[Name] [nvarchar](50) NOT NULL,
	[UnderlyingTypeId] [tinyint] NOT NULL,
	[CurrencyId] [tinyint] NOT NULL,
	[ContractSize] [float] NOT NULL,
	[TickSize] [nvarchar](50) NOT NULL,
	[TickValue] [nvarchar](50) NOT NULL,
	[PointValue] [nvarchar](50) NOT NULL,
	[ContractYearDigit] [tinyint] NOT NULL,
	[ValidFrom] [datetime2](7) NOT NULL,
	[ValidTo] [datetime2](7) NOT NULL,
	[ExchangeSymbol] [nvarchar](50) NOT NULL
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[futures_exchanges]    Script Date: 23/08/2023 15:39:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[futures_exchanges](
	[Exchange] [nvarchar](100) NULL,
	[Country_Code] [nvarchar](50) NULL,
	[Currency_Code] [nvarchar](50) NULL,
	[Days_of_the_Week] [nvarchar](150) NULL,
	[Time_Zone] [nvarchar](50) NULL,
	[First_Session] [time](7) NULL,
	[Last_Session] [nvarchar](50) NULL
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[Industries]    Script Date: 23/08/2023 15:39:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[Industries](
	[IndustryName] [nvarchar](50) NULL
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[phu_quantities]    Script Date: 23/08/2023 15:39:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[phu_quantities](
	[column1] [nvarchar](50) NOT NULL,
	[column2] [float] NOT NULL,
	[column3] [smallint] NULL
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[sec_tony]    Script Date: 23/08/2023 15:39:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[sec_tony](
	[id] [int] NOT NULL,
	[BloombergTicker] [nvarchar](50) NOT NULL
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[Sectors]    Script Date: 23/08/2023 15:39:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[Sectors](
	[SectorName] [nvarchar](50) NULL
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[Securities]    Script Date: 23/08/2023 15:39:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[Securities](
	[Id] [int] NOT NULL,
	[BloombergTicker] [nvarchar](50) NULL,
	[Name] [nvarchar](150) NULL,
	[NameFS] [nvarchar](150) NULL,
	[BloombergUniqueId] [nvarchar](50) NULL,
	[ISIN] [nvarchar](50) NULL,
	[SEDOL] [nvarchar](50) NULL,
	[CountryId] [tinyint] NULL,
	[FactsetId] [nvarchar](50) NULL,
	[CurrencyId] [tinyint] NULL,
	[SectorName] [nvarchar](50) NULL,
	[IndustryName] [nvarchar](50) NULL,
	[CompositeTicker] [nvarchar](50) NULL,
	[CurrencyString] [nvarchar](50) NULL,
	[SecurityType2] [nvarchar](50) NULL,
	[IsActive] [bit] NULL,
	[IsActiveFS] [bit] NULL,
	[gics_ig_id] [int] NULL,
	[gics_sector_id] [tinyint] NULL,
	[CDS_ticker_current] [nvarchar](1) NULL,
	[fds_entity_id] [nvarchar](50) NULL,
	[bbg_entity_id] [nvarchar](1) NULL,
	[rav_id] [nvarchar](50) NULL,
	[parent_sec_id] [nvarchar](1) NULL,
	[trading_timezone_id] [tinyint] NULL,
	[classif01] [nvarchar](50) NULL,
	[classif02] [nvarchar](50) NULL,
	[Tt_id] [nvarchar](50) NULL,
	[TT_market] [nvarchar](50) NULL,
	[TT_marketId] [nvarchar](1) NULL,
	[FX_string_region] [nvarchar](50) NULL,
	[is_constituent] [tinyint] NULL,
	[efa_mnemonic] [nvarchar](50) NULL,
	[ram_id_custom] [nvarchar](1) NULL,
 CONSTRAINT [PK_Securities2] PRIMARY KEY CLUSTERED 
(
	[Id] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[TargetWeights_JPM2]    Script Date: 23/08/2023 15:39:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[TargetWeights_JPM2](
	[symbol] [nvarchar](50) NOT NULL,
	[weight] [decimal](18, 10) NOT NULL
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[timezone_code_mapping]    Script Date: 23/08/2023 15:39:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[timezone_code_mapping](
	[code] [nvarchar](50) NOT NULL,
	[name] [nvarchar](50) NOT NULL
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[timezones]    Script Date: 23/08/2023 15:39:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[timezones](
	[column1] [nvarchar](50) NOT NULL,
	[column2] [nvarchar](50) NOT NULL
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[Weights_Long_20230207]    Script Date: 23/08/2023 15:39:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[Weights_Long_20230207](
	[Une] [nvarchar](50) NOT NULL,
	[poule] [nvarchar](50) NOT NULL,
	[sur_un] [nvarchar](50) NOT NULL,
	[mur] [float] NOT NULL
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[Weights_Short_20230207]    Script Date: 23/08/2023 15:39:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[Weights_Short_20230207](
	[Qui] [nvarchar](50) NOT NULL,
	[picote] [nvarchar](50) NOT NULL,
	[du_pain] [nvarchar](50) NOT NULL,
	[dur] [float] NOT NULL
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[WeightsFFandFX_20230207]    Script Date: 23/08/2023 15:39:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[WeightsFFandFX_20230207](
	[column1] [nvarchar](50) NOT NULL,
	[column2] [float] NOT NULL
) ON [PRIMARY]
GO
/****** Object:  Table [instr].[FutureContract]    Script Date: 23/08/2023 15:39:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [instr].[FutureContract](
	[FutureContractId] [int] NOT NULL,
	[GenericFutureId] [int] NOT NULL,
	[FutureContractMonthId] [tinyint] NOT NULL,
	[ContractYear] [int] NOT NULL,
	[LastTradeDate] [date] NOT NULL,
	[FirstNoticeDate] [date] NOT NULL,
 CONSTRAINT [PK_FutureContractId] PRIMARY KEY CLUSTERED 
(
	[FutureContractId] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY],
 CONSTRAINT [UC_FutureContract] UNIQUE NONCLUSTERED 
(
	[GenericFutureId] ASC,
	[FutureContractMonthId] ASC,
	[ContractYear] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  Table [mktdata].[FxRate]    Script Date: 23/08/2023 15:39:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [mktdata].[FxRate](
	[FxRateId] [int] NOT NULL,
	[BaseCurrency] [char](3) NOT NULL,
	[QuoteCurrency] [char](3) NOT NULL,
	[Value] [decimal](12, 6) NOT NULL,
	[Time] [datetime2](7) NOT NULL,
 CONSTRAINT [PK_FxRateId] PRIMARY KEY CLUSTERED 
(
	[FxRateId] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  Table [ord].[Broker_H]    Script Date: 23/08/2023 15:39:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [ord].[Broker_H](
	[BrokerId] [int] NOT NULL,
	[Name] [nvarchar](30) NOT NULL,
	[ValidFrom] [datetime2](2) NOT NULL,
	[ValidTo] [datetime2](2) NOT NULL,
	[CODE] [nvarchar](10) NULL
) ON [PRIMARY]
WITH
(
DATA_COMPRESSION = PAGE
)
GO
/****** Object:  Index [ix_Broker_H]    Script Date: 23/08/2023 15:39:55 ******/
CREATE CLUSTERED INDEX [ix_Broker_H] ON [ord].[Broker_H]
(
	[ValidTo] ASC,
	[ValidFrom] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, SORT_IN_TEMPDB = OFF, DROP_EXISTING = OFF, ONLINE = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF, DATA_COMPRESSION = PAGE) ON [PRIMARY]
GO
/****** Object:  Table [ord].[EndOfDayPrice]    Script Date: 23/08/2023 15:39:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [ord].[EndOfDayPrice](
	[InstrumentId] [int] NOT NULL,
	[Price] [decimal](12, 6) NOT NULL,
	[Currency] [char](3) NOT NULL,
PRIMARY KEY CLUSTERED 
(
	[InstrumentId] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  Table [port].[Instrument]    Script Date: 23/08/2023 15:39:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [port].[Instrument](
	[InstrumentId] [int] NOT NULL,
	[Symbol] [nvarchar](30) NOT NULL,
	[Name] [nvarchar](100) NOT NULL,
	[InstrumentType] [nvarchar](8) NOT NULL,
	[MarketSector] [nvarchar](6) NOT NULL,
	[Currency] [char](3) NOT NULL,
 CONSTRAINT [PK_InstrumentId] PRIMARY KEY CLUSTERED 
(
	[InstrumentId] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  Table [port].[Trade]    Script Date: 23/08/2023 15:39:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [port].[Trade](
	[TradeId] [int] IDENTITY(1,1) NOT NULL,
	[PortfolioId] [tinyint] NOT NULL,
	[SecurityId] [int] NOT NULL,
	[Quantity] [int] NOT NULL,
	[ExecutionPrice] [decimal](12, 4) NOT NULL,
	[Currency] [nchar](3) NOT NULL,
	[ExecutedOn] [datetime2](7) NOT NULL,
 CONSTRAINT [PK_TradeId] PRIMARY KEY CLUSTERED 
(
	[TradeId] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY],
 CONSTRAINT [UC_Trade] UNIQUE NONCLUSTERED 
(
	[SecurityId] ASC,
	[PortfolioId] ASC,
	[ExecutedOn] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  Table [prc].[FxRate]    Script Date: 23/08/2023 15:39:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [prc].[FxRate](
	[FxRateId] [int] IDENTITY(1,1) NOT NULL,
	[BaseCurrency] [char](3) NOT NULL,
	[QuoteCurrency] [char](3) NOT NULL,
	[Value] [decimal](12, 6) NOT NULL,
	[Time] [datetime2](7) NOT NULL,
 CONSTRAINT [PK_FxRateId] PRIMARY KEY CLUSTERED 
(
	[FxRateId] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  Table [prc].[InstrumentPricing]    Script Date: 23/08/2023 15:39:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [prc].[InstrumentPricing](
	[InstrumentPricingId] [int] IDENTITY(1,1) NOT NULL,
	[InstrumentId] [int] NOT NULL,
	[Price] [decimal](12, 6) NOT NULL,
	[Currency] [char](3) NOT NULL,
	[Time] [datetime2](7) NOT NULL,
 CONSTRAINT [PK_InstrumentPricingId] PRIMARY KEY CLUSTERED 
(
	[InstrumentPricingId] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  Table [pricing].[EndOfDayPrice]    Script Date: 23/08/2023 15:39:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [pricing].[EndOfDayPrice](
	[InstrumentId] [int] NOT NULL,
	[Price] [decimal](12, 6) NOT NULL,
	[Currency] [char](3) NOT NULL,
	[Date] [date] NOT NULL,
 CONSTRAINT [PK_EndOfDayPrice] PRIMARY KEY CLUSTERED 
(
	[InstrumentId] ASC,
	[Date] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  Table [pricing].[FxRate]    Script Date: 23/08/2023 15:39:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [pricing].[FxRate](
	[FxRateId] [int] IDENTITY(1,1) NOT NULL,
	[BaseCurrency] [char](3) NOT NULL,
	[QuoteCurrency] [char](3) NOT NULL,
	[Value] [decimal](12, 6) NOT NULL,
	[Date] [date] NOT NULL,
 CONSTRAINT [PK_FxRateId] PRIMARY KEY CLUSTERED 
(
	[FxRateId] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  Table [pricing].[Instrument]    Script Date: 23/08/2023 15:39:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [pricing].[Instrument](
	[InstrumentId] [int] NOT NULL,
	[Symbol] [nvarchar](30) NOT NULL,
	[Exchange] [nvarchar](5) NULL,
	[Currency] [char](3) NOT NULL,
 CONSTRAINT [PK_InstrumentId] PRIMARY KEY CLUSTERED 
(
	[InstrumentId] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  Table [rebal].[Instrument]    Script Date: 23/08/2023 15:39:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [rebal].[Instrument](
	[InstrumentId] [int] NOT NULL,
	[Symbol] [nvarchar](30) NOT NULL,
	[InstrumentType] [nvarchar](30) NOT NULL,
	[Currency] [char](3) NOT NULL,
 CONSTRAINT [PK_InstrumentId] PRIMARY KEY CLUSTERED 
(
	[InstrumentId] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  Table [rebal].[Portfolio]    Script Date: 23/08/2023 15:39:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [rebal].[Portfolio](
	[PortfolioId] [tinyint] NOT NULL,
	[Mnemonic] [nvarchar](6) NOT NULL,
	[Name] [nvarchar](50) NOT NULL,
	[Currency] [char](3) NOT NULL,
 CONSTRAINT [PK_PortfolioId] PRIMARY KEY CLUSTERED 
(
	[PortfolioId] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  Table [rebal].[PortfolioDrift]    Script Date: 23/08/2023 15:39:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [rebal].[PortfolioDrift](
	[PortfolioDriftId] [int] IDENTITY(1,1) NOT NULL,
	[PortfolioValuationId] [int] NOT NULL,
	[TargetAllocationValuationId] [int] NOT NULL,
	[NetExposureDrift] [decimal](18, 6) NOT NULL,
	[GrossExposureDrift] [decimal](18, 6) NOT NULL,
	[ComputedOn] [datetime2](7) NOT NULL,
 CONSTRAINT [PK_PortfolioDrift] PRIMARY KEY CLUSTERED 
(
	[PortfolioDriftId] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  Table [rebal].[PortfolioValuation]    Script Date: 23/08/2023 15:39:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [rebal].[PortfolioValuation](
	[PortfolioValuationId] [int] NOT NULL,
	[PortfolioId] [tinyint] NOT NULL,
	[TotalValue] [decimal](18, 6) NOT NULL,
	[GrossExposure] [decimal](18, 6) NOT NULL,
	[NetExposure] [decimal](18, 6) NOT NULL,
	[Currency] [char](3) NOT NULL,
	[ValuationDate] [datetime] NOT NULL,
 CONSTRAINT [PK_PortfolioValuationId] PRIMARY KEY CLUSTERED 
(
	[PortfolioValuationId] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  Table [rebal].[PositionDrift]    Script Date: 23/08/2023 15:39:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [rebal].[PositionDrift](
	[PortfolioDriftId] [int] NOT NULL,
	[InstrumentId] [int] NOT NULL,
	[TargetWeight] [decimal](18, 6) NOT NULL,
	[CurrentWeight] [decimal](18, 6) NOT NULL,
	[WeightDrift] [decimal](18, 6) NOT NULL,
	[TargetQuantity] [int] NOT NULL,
	[CurrentQuantity] [int] NOT NULL,
	[QuantityDrift] [int] NOT NULL,
 CONSTRAINT [PK_PositionDrift] PRIMARY KEY CLUSTERED 
(
	[PortfolioDriftId] ASC,
	[InstrumentId] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  Table [rebal].[PositionValuation]    Script Date: 23/08/2023 15:39:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [rebal].[PositionValuation](
	[PortfolioValuationId] [int] NOT NULL,
	[InstrumentId] [int] NOT NULL,
	[Quantity] [int] NOT NULL,
	[Weight] [decimal](18, 6) NOT NULL,
 CONSTRAINT [PK_PositionValuation] PRIMARY KEY CLUSTERED 
(
	[PortfolioValuationId] ASC,
	[InstrumentId] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  Table [rebal].[RebalancingSession]    Script Date: 23/08/2023 15:39:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [rebal].[RebalancingSession](
	[RebalancingSessionId] [int] IDENTITY(1,1) NOT NULL,
	[Status] [nvarchar](20) NOT NULL,
	[StatusReason] [nvarchar](40) NOT NULL,
	[StartedOn] [datetime2](7) NOT NULL,
	[EndedOn] [datetime2](7) NULL,
	[StartedBy] [nvarchar](50) NOT NULL,
 CONSTRAINT [PK_RebalancingSession] PRIMARY KEY CLUSTERED 
(
	[RebalancingSessionId] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  Table [rebal].[RebalancingSessionPortfolioDrift]    Script Date: 23/08/2023 15:39:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [rebal].[RebalancingSessionPortfolioDrift](
	[RebalancingSessionId] [int] NOT NULL,
	[PortfolioDriftId] [int] NOT NULL,
 CONSTRAINT [PK_RebalancingSessionPortfolioDrift] PRIMARY KEY CLUSTERED 
(
	[RebalancingSessionId] ASC,
	[PortfolioDriftId] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  Table [rebal].[TargetAllocationValuation]    Script Date: 23/08/2023 15:39:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [rebal].[TargetAllocationValuation](
	[TargetAllocationValuationId] [int] NOT NULL,
	[TargetAllocationId] [int] NOT NULL,
	[PortfolioId] [tinyint] NOT NULL,
	[ValuationCurrency] [char](3) NOT NULL,
	[PortfolioValue] [decimal](18, 6) NOT NULL,
	[TargetNetExposure] [decimal](18, 6) NOT NULL,
	[TargetGrossExposure] [decimal](18, 6) NOT NULL,
	[TotalWeight] [decimal](18, 6) NOT NULL,
	[ValuatedOn] [datetime2](7) NOT NULL,
 CONSTRAINT [PK_TargetAllocationValuationId] PRIMARY KEY CLUSTERED 
(
	[TargetAllocationValuationId] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY],
 CONSTRAINT [UC_TargetAllocationValuation] UNIQUE NONCLUSTERED 
(
	[TargetAllocationId] ASC,
	[ValuatedOn] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  Table [rebal].[TargetWeightValuation]    Script Date: 23/08/2023 15:39:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [rebal].[TargetWeightValuation](
	[TargetAllocationValuationId] [int] NOT NULL,
	[InstrumentId] [int] NOT NULL,
	[Weight] [decimal](12, 6) NOT NULL,
	[TargetQuantity] [int] NOT NULL,
 CONSTRAINT [PK_TargetWeightValuation] PRIMARY KEY CLUSTERED 
(
	[TargetAllocationValuationId] ASC,
	[InstrumentId] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  Table [risk].[FilterCriterion]    Script Date: 23/08/2023 15:39:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [risk].[FilterCriterion](
	[FilterCriterionId] [int] IDENTITY(1,1) NOT NULL,
	[FilterPartyTypeId] [tinyint] NOT NULL,
	[FilterOperatorId] [tinyint] NOT NULL,
	[FilterPartyId] [int] NOT NULL,
 CONSTRAINT [PK_FilterCriterionId] PRIMARY KEY CLUSTERED 
(
	[FilterCriterionId] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY],
 CONSTRAINT [UC_FilterCriterion] UNIQUE NONCLUSTERED 
(
	[FilterPartyTypeId] ASC,
	[FilterOperatorId] ASC,
	[FilterPartyId] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  Table [risk].[FilterParty]    Script Date: 23/08/2023 15:39:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [risk].[FilterParty](
	[FilterPartyId] [int] NOT NULL,
	[FilterPartyTypeId] [tinyint] NOT NULL,
 CONSTRAINT [PK_ContractPartyId] PRIMARY KEY CLUSTERED 
(
	[FilterPartyId] ASC,
	[FilterPartyTypeId] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  Table [risk].[Instrument]    Script Date: 23/08/2023 15:39:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [risk].[Instrument](
	[InstrumentId] [int] NOT NULL,
	[Symbol] [nvarchar](30) NOT NULL,
	[InstrumentType] [nvarchar](30) NOT NULL,
	[Currency] [char](3) NOT NULL,
 CONSTRAINT [PK_InstrumentId] PRIMARY KEY CLUSTERED 
(
	[InstrumentId] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  Table [roll].[ForwardContractChain]    Script Date: 23/08/2023 15:39:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [roll].[ForwardContractChain](
	[CurrencyPairId] [int] NOT NULL,
	[CurrencyPairSymbol] [nvarchar](30) NOT NULL,
 CONSTRAINT [PK_ForwardContractChain] PRIMARY KEY CLUSTERED 
(
	[CurrencyPairId] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY],
 CONSTRAINT [UCForwardContractChain_CurrencyPairSymbol] UNIQUE NONCLUSTERED 
(
	[CurrencyPairSymbol] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  Table [roll].[FutureContractChain]    Script Date: 23/08/2023 15:39:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [roll].[FutureContractChain](
	[GenericFutureId] [int] NOT NULL,
	[GenericSymbol] [nvarchar](30) NOT NULL,
 CONSTRAINT [PK_FutureContractChain] PRIMARY KEY CLUSTERED 
(
	[GenericFutureId] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY],
 CONSTRAINT [UC_FutureContractChain_GenericSymbol] UNIQUE NONCLUSTERED 
(
	[GenericSymbol] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  Table [strats].[Calendar]    Script Date: 23/08/2023 15:39:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [strats].[Calendar](
	[Date] [date] NOT NULL,
	[IsMonthlyCalendar] [bit] NOT NULL,
	[IsMonthlyBusiness] [bit] NOT NULL,
	[IsWeeklyFri] [bit] NOT NULL,
	[IsWeeklyWed] [bit] NOT NULL,
	[IsBusinessFutures] [bit] NOT NULL,
 CONSTRAINT [PK_Calendar] PRIMARY KEY CLUSTERED 
(
	[Date] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  Table [strats].[Price]    Script Date: 23/08/2023 15:39:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [strats].[Price](
	[Date] [date] NOT NULL,
	[SecurityId] [int] NOT NULL,
	[Value] [decimal](18, 6) NULL,
 CONSTRAINT [PK_Price] PRIMARY KEY CLUSTERED 
(
	[Date] ASC,
	[SecurityId] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  Table [strats].[Security]    Script Date: 23/08/2023 15:39:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [strats].[Security](
	[SecurityId] [int] NOT NULL,
	[Symbol] [nvarchar](50) NOT NULL,
 CONSTRAINT [PK_Security] PRIMARY KEY CLUSTERED 
(
	[SecurityId] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  Table [strats].[SubUniverse]    Script Date: 23/08/2023 15:39:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [strats].[SubUniverse](
	[SubUniverseId] [int] NOT NULL,
	[Name] [nvarchar](100) NOT NULL,
	[IsCore] [bit] NOT NULL,
	[UniverseId] [int] NOT NULL,
 CONSTRAINT [PK_SubUniverse] PRIMARY KEY CLUSTERED 
(
	[SubUniverseId] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  Table [strats].[SubUniverseConstituent]    Script Date: 23/08/2023 15:39:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [strats].[SubUniverseConstituent](
	[SubUniverseConstituentId] [int] NOT NULL,
	[SubUniverseId] [int] NOT NULL,
	[SecurityId] [int] NOT NULL,
 CONSTRAINT [PK_SubUniverseConstituent] PRIMARY KEY CLUSTERED 
(
	[SubUniverseConstituentId] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY],
 CONSTRAINT [UC_InstrumentType_Mnemonic] UNIQUE NONCLUSTERED 
(
	[SubUniverseId] ASC,
	[SecurityId] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  Table [strats].[Universe]    Script Date: 23/08/2023 15:39:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [strats].[Universe](
	[UniverseId] [int] NOT NULL,
	[Name] [nvarchar](100) NOT NULL,
	[Description] [nvarchar](100) NULL,
 CONSTRAINT [PK_Universe] PRIMARY KEY CLUSTERED 
(
	[UniverseId] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  Table [strats].[UniverseConstituent]    Script Date: 23/08/2023 15:39:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [strats].[UniverseConstituent](
	[SecurityId] [int] NOT NULL,
	[Date] [date] NOT NULL,
	[UniverseId] [int] NOT NULL,
 CONSTRAINT [PK_UniverseConstituent] PRIMARY KEY CLUSTERED 
(
	[SecurityId] ASC,
	[UniverseId] ASC,
	[Date] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  Table [val].[FutureContract]    Script Date: 23/08/2023 15:39:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [val].[FutureContract](
	[FutureContractId] [int] NOT NULL,
	[PointValue] [decimal](14, 6) NOT NULL,
	[PointValueCurrency] [char](3) NOT NULL,
 CONSTRAINT [PK_FutureContractId] PRIMARY KEY CLUSTERED 
(
	[FutureContractId] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  Table [val].[FxRate]    Script Date: 23/08/2023 15:39:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [val].[FxRate](
	[BaseCurrency] [char](3) NOT NULL,
	[QuoteCurrency] [char](3) NOT NULL,
	[Value] [decimal](12, 6) NOT NULL,
	[Date] [date] NOT NULL,
 CONSTRAINT [PK_FxRate] PRIMARY KEY CLUSTERED 
(
	[BaseCurrency] ASC,
	[QuoteCurrency] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  Table [val].[Instrument]    Script Date: 23/08/2023 15:39:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [val].[Instrument](
	[InstrumentId] [int] NOT NULL,
	[Symbol] [nvarchar](30) NOT NULL,
	[InstrumentType] [nvarchar](10) NOT NULL,
	[Currency] [char](3) NOT NULL,
 CONSTRAINT [PK_InstrumentId] PRIMARY KEY CLUSTERED 
(
	[InstrumentId] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  Table [val].[InstrumentPricing]    Script Date: 23/08/2023 15:39:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [val].[InstrumentPricing](
	[InstrumentId] [int] NOT NULL,
	[Price] [decimal](18, 6) NOT NULL,
	[Currency] [char](3) NOT NULL,
	[Date] [date] NOT NULL,
 CONSTRAINT [PK_InstrumentPricing] PRIMARY KEY CLUSTERED 
(
	[InstrumentId] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  Table [val].[Portfolio]    Script Date: 23/08/2023 15:39:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [val].[Portfolio](
	[PortfolioId] [tinyint] NOT NULL,
	[Mnemonic] [nvarchar](6) NOT NULL,
	[Name] [nvarchar](50) NOT NULL,
	[TotalValue] [decimal](18, 6) NOT NULL,
	[Currency] [char](3) NOT NULL,
 CONSTRAINT [PK_PortfolioId] PRIMARY KEY CLUSTERED 
(
	[PortfolioId] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  Table [val].[PortfolioValuation]    Script Date: 23/08/2023 15:39:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [val].[PortfolioValuation](
	[PortfolioValuationId] [int] IDENTITY(1,1) NOT NULL,
	[PortfolioId] [tinyint] NOT NULL,
	[TotalValue] [decimal](18, 6) NOT NULL,
	[GrossExposure] [decimal](18, 6) NOT NULL,
	[NetExposure] [decimal](18, 6) NOT NULL,
	[PnL] [decimal](18, 6) NOT NULL,
	[ROI] [decimal](18, 6) NOT NULL,
	[Currency] [char](3) NOT NULL,
	[ValuationDate] [datetime] NOT NULL,
 CONSTRAINT [PK_PortfolioValuationId] PRIMARY KEY CLUSTERED 
(
	[PortfolioValuationId] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  Table [val].[Position]    Script Date: 23/08/2023 15:39:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [val].[Position](
	[PositionId] [int] NOT NULL,
	[PortfolioId] [tinyint] NOT NULL,
	[InstrumentId] [int] NOT NULL,
	[Quantity] [int] NOT NULL,
	[AverageEntryPrice] [decimal](18, 6) NOT NULL,
	[AverageEntryFxRate] [decimal](18, 6) NOT NULL,
	[UpdatedOn] [datetime2](7) NOT NULL,
 CONSTRAINT [PK_Position] PRIMARY KEY CLUSTERED 
(
	[PositionId] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  Table [val].[PositionValuation]    Script Date: 23/08/2023 15:39:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [val].[PositionValuation](
	[PositionValuationId] [int] IDENTITY(1,1) NOT NULL,
	[PortfolioValuationId] [int] NOT NULL,
	[InstrumentId] [int] NOT NULL,
	[Quantity] [int] NOT NULL,
	[InstrumentValue] [decimal](18, 6) NOT NULL,
	[InstrumentPrice] [decimal](18, 6) NOT NULL,
	[InstrumentPriceDate] [datetime2](7) NOT NULL,
	[InstrumentPriceCurrency] [char](3) NOT NULL,
	[ValuationCurrency] [char](3) NOT NULL,
	[FxRate] [decimal](12, 6) NOT NULL,
	[NetExposure] [decimal](18, 6) NOT NULL,
	[GrossExposure] [decimal](18, 6) NOT NULL,
	[PnL] [decimal](18, 6) NOT NULL,
	[ROI] [decimal](18, 6) NOT NULL,
	[Weight] [decimal](18, 6) NOT NULL,
 CONSTRAINT [PK_PositionValuation] PRIMARY KEY CLUSTERED 
(
	[PositionValuationId] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY],
 CONSTRAINT [UC_PositionValuation] UNIQUE NONCLUSTERED 
(
	[PortfolioValuationId] ASC,
	[InstrumentId] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  Table [val].[TargetAllocation]    Script Date: 23/08/2023 15:39:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [val].[TargetAllocation](
	[TargetAllocationId] [int] NOT NULL,
	[PortfolioId] [tinyint] NOT NULL,
	[GeneratedOn] [datetime2](7) NOT NULL,
 CONSTRAINT [PK_TargetAllocationId] PRIMARY KEY CLUSTERED 
(
	[TargetAllocationId] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  Table [val].[TargetAllocationValuation]    Script Date: 23/08/2023 15:39:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [val].[TargetAllocationValuation](
	[TargetAllocationValuationId] [int] IDENTITY(1,1) NOT NULL,
	[TargetAllocationId] [int] NOT NULL,
	[ValuationCurrency] [char](3) NOT NULL,
	[PortfolioValue] [decimal](18, 6) NOT NULL,
	[TargetNetExposure] [decimal](18, 6) NOT NULL,
	[TargetGrossExposure] [decimal](18, 6) NOT NULL,
	[TotalWeight] [decimal](18, 6) NOT NULL,
	[ValuatedOn] [datetime2](7) NOT NULL,
 CONSTRAINT [PK_TargetAllocationValuationId] PRIMARY KEY CLUSTERED 
(
	[TargetAllocationValuationId] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY],
 CONSTRAINT [UC_TargetAllocationValuation] UNIQUE NONCLUSTERED 
(
	[TargetAllocationId] ASC,
	[ValuatedOn] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  Table [val].[TargetWeight]    Script Date: 23/08/2023 15:39:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [val].[TargetWeight](
	[TargetWeightId] [int] IDENTITY(1,1) NOT NULL,
	[TargetAllocationId] [int] NOT NULL,
	[InstrumentId] [int] NOT NULL,
	[Weight] [decimal](9, 6) NOT NULL,
 CONSTRAINT [PK_TargetWeightId] PRIMARY KEY CLUSTERED 
(
	[TargetWeightId] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY],
 CONSTRAINT [UC_TargetWeight] UNIQUE NONCLUSTERED 
(
	[TargetWeightId] ASC,
	[InstrumentId] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  Table [val].[TargetWeightValuation]    Script Date: 23/08/2023 15:39:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [val].[TargetWeightValuation](
	[TargetWeightValuationId] [int] IDENTITY(1,1) NOT NULL,
	[TargetAllocationValuationId] [int] NOT NULL,
	[InstrumentId] [int] NOT NULL,
	[Weight] [decimal](12, 6) NOT NULL,
	[Price] [decimal](18, 6) NOT NULL,
	[PricedOn] [datetime2](7) NOT NULL,
	[PriceCurrency] [char](3) NOT NULL,
	[InstrumentValue] [decimal](18, 6) NOT NULL,
	[TargetQuantity] [int] NOT NULL,
	[TargetNetExposure] [decimal](18, 6) NOT NULL,
	[TargetGrossExposure] [decimal](18, 6) NOT NULL,
 CONSTRAINT [PK_TargetWeightValuation] PRIMARY KEY CLUSTERED 
(
	[TargetWeightValuationId] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY],
 CONSTRAINT [UC_TargetWeightValuation] UNIQUE NONCLUSTERED 
(
	[TargetAllocationValuationId] ASC,
	[InstrumentId] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  Table [wght].[Instrument]    Script Date: 23/08/2023 15:39:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [wght].[Instrument](
	[InstrumentId] [int] NOT NULL,
	[Symbol] [nvarchar](30) NOT NULL,
 CONSTRAINT [PK_InstrumentId] PRIMARY KEY CLUSTERED 
(
	[InstrumentId] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  Table [wght].[TargetWeight]    Script Date: 23/08/2023 15:39:55 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [wght].[TargetWeight](
	[TargetAllocationId] [int] NOT NULL,
	[InstrumentId] [int] NOT NULL,
	[Weight] [decimal](9, 6) NOT NULL,
 CONSTRAINT [PK_TargetWeightId] PRIMARY KEY CLUSTERED 
(
	[InstrumentId] ASC,
	[TargetAllocationId] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]
) ON [PRIMARY]
GO
SET ANSI_PADDING ON
GO
/****** Object:  Index [Idx_Price_Symbol_Date]    Script Date: 23/08/2023 15:39:55 ******/
CREATE NONCLUSTERED INDEX [Idx_Price_Symbol_Date] ON [blpapi].[Price]
(
	[Symbol] ASC,
	[Date] ASC
)
INCLUDE([Value]) WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, SORT_IN_TEMPDB = OFF, DROP_EXISTING = OFF, ONLINE = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]
GO
SET ANSI_PADDING ON
GO
/****** Object:  Index [idx_Symbol]    Script Date: 23/08/2023 15:39:55 ******/
CREATE NONCLUSTERED INDEX [idx_Symbol] ON [blpapi].[Price]
(
	[Symbol] ASC
)
INCLUDE([Value],[Currency],[Date]) WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, SORT_IN_TEMPDB = OFF, DROP_EXISTING = OFF, ONLINE = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]
GO
/****** Object:  Index [Idx_ComputedOn]    Script Date: 23/08/2023 15:39:55 ******/
CREATE NONCLUSTERED INDEX [Idx_ComputedOn] ON [rebal].[PortfolioDrift]
(
	[ComputedOn] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, SORT_IN_TEMPDB = OFF, DROP_EXISTING = OFF, ONLINE = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]
GO
ALTER TABLE [ord].[BlockOrder] ADD  CONSTRAINT [DF_Order_CreatedOn]  DEFAULT (getdate()) FOR [CreatedOn]
GO
ALTER TABLE [rebal].[PortfolioDrift] ADD  DEFAULT (getutcdate()) FOR [ComputedOn]
GO
ALTER TABLE [rebal].[RebalancingSession] ADD  DEFAULT (suser_sname()) FOR [StartedBy]
GO
ALTER TABLE [blpapi].[CurrencyPair]  WITH NOCHECK ADD  CONSTRAINT [FK_CurrencyPair_Instrument] FOREIGN KEY([Symbol])
REFERENCES [blpapi].[Instrument] ([Symbol])
ON DELETE CASCADE
GO
ALTER TABLE [blpapi].[CurrencyPair] CHECK CONSTRAINT [FK_CurrencyPair_Instrument]
GO
ALTER TABLE [blpapi].[FxForward]  WITH NOCHECK ADD  CONSTRAINT [FK_FxForward_Instrument] FOREIGN KEY([Symbol])
REFERENCES [blpapi].[Instrument] ([Symbol])
ON DELETE CASCADE
GO
ALTER TABLE [blpapi].[FxForward] CHECK CONSTRAINT [FK_FxForward_Instrument]
GO
ALTER TABLE [blpapi].[FutureContract]  WITH NOCHECK ADD  CONSTRAINT [FK_FutureContract_Instrument] FOREIGN KEY([Symbol])
REFERENCES [blpapi].[Instrument] ([Symbol])
ON DELETE CASCADE
GO
ALTER TABLE [blpapi].[FutureContract] CHECK CONSTRAINT [FK_FutureContract_Instrument]
GO
ALTER TABLE [blpapi].[GenericFuture]  WITH NOCHECK ADD  CONSTRAINT [FK_GenericFuture_Instrument] FOREIGN KEY([Symbol])
REFERENCES [blpapi].[Instrument] ([Symbol])
ON DELETE CASCADE
GO
ALTER TABLE [blpapi].[GenericFuture] CHECK CONSTRAINT [FK_GenericFuture_Instrument]
GO
ALTER TABLE [conv].[InstrumentMapping]  WITH NOCHECK ADD  CONSTRAINT [FK_InstrumentMapping_FromInstrument] FOREIGN KEY([FromInstrumentId])
REFERENCES [conv].[Instrument] ([InstrumentId])
GO
ALTER TABLE [conv].[InstrumentMapping] CHECK CONSTRAINT [FK_InstrumentMapping_FromInstrument]
GO
ALTER TABLE [conv].[InstrumentMapping]  WITH NOCHECK ADD  CONSTRAINT [FK_InstrumentMapping_InstrumentMappingType] FOREIGN KEY([InstrumentMappingTypeId])
REFERENCES [conv].[InstrumentMappingType] ([InstrumentMappingTypeId])
ON DELETE CASCADE
GO
ALTER TABLE [conv].[InstrumentMapping] CHECK CONSTRAINT [FK_InstrumentMapping_InstrumentMappingType]
GO
ALTER TABLE [conv].[InstrumentMapping]  WITH NOCHECK ADD  CONSTRAINT [FK_InstrumentMapping_ToInstrument] FOREIGN KEY([ToInstrumentId])
REFERENCES [conv].[Instrument] ([InstrumentId])
GO
ALTER TABLE [conv].[InstrumentMapping] CHECK CONSTRAINT [FK_InstrumentMapping_ToInstrument]
GO
ALTER TABLE [conv].[TargetWeightConversion]  WITH NOCHECK ADD  CONSTRAINT [FK_TargetWeightConversion_FromInstrument] FOREIGN KEY([FromInstrumentId])
REFERENCES [conv].[Instrument] ([InstrumentId])
GO
ALTER TABLE [conv].[TargetWeightConversion] CHECK CONSTRAINT [FK_TargetWeightConversion_FromInstrument]
GO
ALTER TABLE [conv].[TargetWeightConversion]  WITH NOCHECK ADD  CONSTRAINT [FK_TargetWeightConversion_TargetAllocationConversion] FOREIGN KEY([TargetAllocationConversionId])
REFERENCES [conv].[TargetAllocationConversion] ([TargetAllocationConversionId])
GO
ALTER TABLE [conv].[TargetWeightConversion] CHECK CONSTRAINT [FK_TargetWeightConversion_TargetAllocationConversion]
GO
ALTER TABLE [conv].[TargetWeightConversion]  WITH NOCHECK ADD  CONSTRAINT [FK_TargetWeightConversion_ToInstrument] FOREIGN KEY([ToInstrumentId])
REFERENCES [conv].[Instrument] ([InstrumentId])
GO
ALTER TABLE [conv].[TargetWeightConversion] CHECK CONSTRAINT [FK_TargetWeightConversion_ToInstrument]
GO
ALTER TABLE [exec].[ExecutionInfoSelectionRule]  WITH NOCHECK ADD  CONSTRAINT [FK_ExecutionInfoSelectionRule_ExecutionAlgorithm] FOREIGN KEY([ExecutionAlgorithmId])
REFERENCES [exec].[ExecutionAlgorithm] ([ExecutionAlgorithmId])
GO
ALTER TABLE [exec].[ExecutionInfoSelectionRule] CHECK CONSTRAINT [FK_ExecutionInfoSelectionRule_ExecutionAlgorithm]
GO
ALTER TABLE [exec].[ExecutionInfoSelectionRule]  WITH NOCHECK ADD  CONSTRAINT [FK_ExecutionInfoSelectionRule_HandlingInstruction] FOREIGN KEY([HandlingInstructionId])
REFERENCES [exec].[HandlingInstruction] ([HandlingInstructionId])
GO
ALTER TABLE [exec].[ExecutionInfoSelectionRule] CHECK CONSTRAINT [FK_ExecutionInfoSelectionRule_HandlingInstruction]
GO
ALTER TABLE [exec].[ExecutionInfoSelectionRule]  WITH NOCHECK ADD  CONSTRAINT [FK_ExecutionInfoSelectionRule_OrderType] FOREIGN KEY([OrderTypeId])
REFERENCES [exec].[OrderType] ([OrderTypeId])
GO
ALTER TABLE [exec].[ExecutionInfoSelectionRule] CHECK CONSTRAINT [FK_ExecutionInfoSelectionRule_OrderType]
GO
ALTER TABLE [exec].[ExecutionInfoSelectionRule]  WITH NOCHECK ADD  CONSTRAINT [FK_ExecutionInfoSelectionRule_TimeInForce] FOREIGN KEY([TimeInForceId])
REFERENCES [exec].[TimeInForce] ([TimeInForceId])
GO
ALTER TABLE [exec].[ExecutionInfoSelectionRule] CHECK CONSTRAINT [FK_ExecutionInfoSelectionRule_TimeInForce]
GO
ALTER TABLE [instr].[Cfd]  WITH NOCHECK ADD  CONSTRAINT [FK_Cfd_Instrument] FOREIGN KEY([CfdId])
REFERENCES [instr].[Instrument] ([InstrumentId])
ON DELETE CASCADE
GO
ALTER TABLE [instr].[Cfd] CHECK CONSTRAINT [FK_Cfd_Instrument]
GO
ALTER TABLE [instr].[Cfd]  WITH NOCHECK ADD  CONSTRAINT [FK_Cfd_UnderlyingInstrument] FOREIGN KEY([UnderlyingInstrumentId])
REFERENCES [instr].[Instrument] ([InstrumentId])
GO
ALTER TABLE [instr].[Cfd] CHECK CONSTRAINT [FK_Cfd_UnderlyingInstrument]
GO
ALTER TABLE [instr].[CurrencyPair]  WITH NOCHECK ADD  CONSTRAINT [FK_CurrencyPair_BaseCurrency] FOREIGN KEY([BaseCurrencyId])
REFERENCES [instr].[Currency] ([CurrencyId])
GO
ALTER TABLE [instr].[CurrencyPair] CHECK CONSTRAINT [FK_CurrencyPair_BaseCurrency]
GO
ALTER TABLE [instr].[CurrencyPair]  WITH NOCHECK ADD  CONSTRAINT [FK_CurrencyPair_Instrument] FOREIGN KEY([CurrencyPairId])
REFERENCES [instr].[Instrument] ([InstrumentId])
ON DELETE CASCADE
GO
ALTER TABLE [instr].[CurrencyPair] CHECK CONSTRAINT [FK_CurrencyPair_Instrument]
GO
ALTER TABLE [instr].[CurrencyPair]  WITH NOCHECK ADD  CONSTRAINT [FK_CurrencyPair_QuoteCurrency] FOREIGN KEY([QuoteCurrencyId])
REFERENCES [instr].[Currency] ([CurrencyId])
GO
ALTER TABLE [instr].[CurrencyPair] CHECK CONSTRAINT [FK_CurrencyPair_QuoteCurrency]
GO
ALTER TABLE [instr].[FxForward]  WITH NOCHECK ADD  CONSTRAINT [FK_FxForward_CurrencyPair] FOREIGN KEY([CurrencyPairId])
REFERENCES [instr].[CurrencyPair] ([CurrencyPairId])
GO
ALTER TABLE [instr].[FxForward] CHECK CONSTRAINT [FK_FxForward_CurrencyPair]
GO
ALTER TABLE [instr].[FxForward]  WITH NOCHECK ADD  CONSTRAINT [FK_FxForward_Instrument] FOREIGN KEY([FxForwardId])
REFERENCES [instr].[Instrument] ([InstrumentId])
ON DELETE CASCADE
GO
ALTER TABLE [instr].[FxForward] CHECK CONSTRAINT [FK_FxForward_Instrument]
GO
ALTER TABLE [instr].[CurrencyPair]  WITH NOCHECK ADD  CONSTRAINT [FK_CurrencyPair_BaseCurrency] FOREIGN KEY([BaseCurrencyId])
REFERENCES [instr].[Currency] ([CurrencyId])
GO
ALTER TABLE [instr].[CurrencyPair] CHECK CONSTRAINT [FK_CurrencyPair_BaseCurrency]
GO
ALTER TABLE [instr].[CurrencyPair]  WITH NOCHECK ADD  CONSTRAINT [FK_CurrencyPair_Instrument] FOREIGN KEY([CurrencyPairId])
REFERENCES [instr].[Instrument] ([InstrumentId])
ON DELETE CASCADE
GO
ALTER TABLE [instr].[CurrencyPair] CHECK CONSTRAINT [FK_CurrencyPair_Instrument]
GO
ALTER TABLE [instr].[CurrencyPair]  WITH NOCHECK ADD  CONSTRAINT [FK_CurrencyPair_QuoteCurrency] FOREIGN KEY([QuoteCurrencyId])
REFERENCES [instr].[Currency] ([CurrencyId])
GO
ALTER TABLE [instr].[CurrencyPair] CHECK CONSTRAINT [FK_CurrencyPair_QuoteCurrency]
GO
ALTER TABLE [instr].[FutureContract]  WITH NOCHECK ADD  CONSTRAINT [FK_FutureContract_FutureContractMonth] FOREIGN KEY([FutureContractMonthId])
REFERENCES [instr].[FutureContractMonth] ([FutureContractMonthId])
GO
ALTER TABLE [instr].[FutureContract] CHECK CONSTRAINT [FK_FutureContract_FutureContractMonth]
GO
ALTER TABLE [instr].[FutureContract]  WITH NOCHECK ADD  CONSTRAINT [FK_FutureContract_GenericFuture] FOREIGN KEY([GenericFutureId])
REFERENCES [instr].[GenericFuture] ([GenericFutureId])
GO
ALTER TABLE [instr].[FutureContract] CHECK CONSTRAINT [FK_FutureContract_GenericFuture]
GO
ALTER TABLE [instr].[FutureContract]  WITH NOCHECK ADD  CONSTRAINT [FK_FutureContract_Instrument] FOREIGN KEY([FutureContractId])
REFERENCES [instr].[Instrument] ([InstrumentId])
ON DELETE CASCADE
GO
ALTER TABLE [instr].[FutureContract] CHECK CONSTRAINT [FK_FutureContract_Instrument]
GO
ALTER TABLE [instr].[GenericFuture]  WITH NOCHECK ADD  CONSTRAINT [FK_GenericFuture_Instrument] FOREIGN KEY([GenericFutureId])
REFERENCES [instr].[Instrument] ([InstrumentId])
ON DELETE CASCADE
GO
ALTER TABLE [instr].[GenericFuture] CHECK CONSTRAINT [FK_GenericFuture_Instrument]
GO
ALTER TABLE [instr].[Instrument]  WITH NOCHECK ADD  CONSTRAINT [FK_Instrument_Currency] FOREIGN KEY([CurrencyId])
REFERENCES [instr].[Currency] ([CurrencyId])
GO
ALTER TABLE [instr].[Instrument] CHECK CONSTRAINT [FK_Instrument_Currency]
GO
ALTER TABLE [instr].[Instrument]  WITH NOCHECK ADD  CONSTRAINT [FK_Instrument_Exchange] FOREIGN KEY([ExchangeId])
REFERENCES [instr].[Exchange] ([ExchangeId])
GO
ALTER TABLE [instr].[Instrument] CHECK CONSTRAINT [FK_Instrument_Exchange]
GO
ALTER TABLE [instr].[Instrument]  WITH NOCHECK ADD  CONSTRAINT [FK_Instrument_InstrumentType] FOREIGN KEY([InstrumentTypeId])
REFERENCES [instr].[InstrumentType] ([InstrumentTypeId])
GO
ALTER TABLE [instr].[Instrument] CHECK CONSTRAINT [FK_Instrument_InstrumentType]
GO
ALTER TABLE [instr].[Instrument]  WITH NOCHECK ADD  CONSTRAINT [FK_Instrument_MarketSector] FOREIGN KEY([MarketSectorId])
REFERENCES [instr].[MarketSector] ([MarketSectorId])
GO
ALTER TABLE [instr].[Instrument] CHECK CONSTRAINT [FK_Instrument_MarketSector]
GO
ALTER TABLE [ord].[AllocationOrder]  WITH NOCHECK ADD  CONSTRAINT [FK_AllocationOrder_BlockOrder] FOREIGN KEY([BlockOrderId])
REFERENCES [ord].[BlockOrder] ([BlockOrderId])
ON DELETE CASCADE
GO
ALTER TABLE [ord].[AllocationOrder] CHECK CONSTRAINT [FK_AllocationOrder_BlockOrder]
GO
ALTER TABLE [ord].[AllocationOrder]  WITH NOCHECK ADD  CONSTRAINT [FK_AllocationOrder_Portfolio] FOREIGN KEY([PortfolioId])
REFERENCES [ord].[Portfolio] ([PortfolioId])
GO
ALTER TABLE [ord].[AllocationOrder] CHECK CONSTRAINT [FK_AllocationOrder_Portfolio]
GO
ALTER TABLE [ord].[AllocationOrder]  WITH NOCHECK ADD  CONSTRAINT [FK_AllocationOrder_TradingAccount] FOREIGN KEY([TradingAccountId])
REFERENCES [ord].[TradingAccount] ([TradingAccountId])
GO
ALTER TABLE [ord].[AllocationOrder] CHECK CONSTRAINT [FK_AllocationOrder_TradingAccount]
GO
ALTER TABLE [ord].[BlockOrder]  WITH NOCHECK ADD  CONSTRAINT [FK_BlockOrder_Broker] FOREIGN KEY([BrokerId])
REFERENCES [ord].[Broker] ([BrokerId])
GO
ALTER TABLE [ord].[BlockOrder] NOCHECK CONSTRAINT [FK_BlockOrder_Broker]
GO
ALTER TABLE [ord].[BlockOrder]  WITH NOCHECK ADD  CONSTRAINT [FK_BlockOrder_ExecutionProfile] FOREIGN KEY([ExecutionProfileId])
REFERENCES [ord].[ExecutionProfile] ([ExecutionProfileId])
GO
ALTER TABLE [ord].[BlockOrder] CHECK CONSTRAINT [FK_BlockOrder_ExecutionProfile]
GO
ALTER TABLE [ord].[BlockOrder]  WITH NOCHECK ADD  CONSTRAINT [FK_BlockOrder_Instrument] FOREIGN KEY([InstrumentId])
REFERENCES [ord].[Instrument] ([InstrumentId])
GO
ALTER TABLE [ord].[BlockOrder] CHECK CONSTRAINT [FK_BlockOrder_Instrument]
GO
ALTER TABLE [ord].[BlockOrder]  WITH NOCHECK ADD  CONSTRAINT [FK_BlockOrder_TradeMode] FOREIGN KEY([TradeModeId])
REFERENCES [ord].[TradeMode] ([TradeModeId])
GO
ALTER TABLE [ord].[BlockOrder] CHECK CONSTRAINT [FK_BlockOrder_TradeMode]
GO
ALTER TABLE [ord].[BrokerSelectionRule]  WITH NOCHECK ADD  CONSTRAINT [FK_BrokerSelectionRule_Broker] FOREIGN KEY([BrokerId])
REFERENCES [ord].[Broker] ([BrokerId])
GO
ALTER TABLE [ord].[BrokerSelectionRule] NOCHECK CONSTRAINT [FK_BrokerSelectionRule_Broker]
GO
ALTER TABLE [ord].[BrokerSelectionRule]  WITH NOCHECK ADD  CONSTRAINT [FK_BrokerSelectionRule_InstrumentType] FOREIGN KEY([InstrumentTypeId])
REFERENCES [ord].[InstrumentType] ([InstrumentTypeId])
GO
ALTER TABLE [ord].[BrokerSelectionRule] CHECK CONSTRAINT [FK_BrokerSelectionRule_InstrumentType]
GO
ALTER TABLE [ord].[BrokerSelectionRule]  WITH NOCHECK ADD  CONSTRAINT [FK_BrokerSelectionRule_Portfolio] FOREIGN KEY([PortfolioId])
REFERENCES [ord].[Portfolio] ([PortfolioId])
GO
ALTER TABLE [ord].[BrokerSelectionRule] CHECK CONSTRAINT [FK_BrokerSelectionRule_Portfolio]
GO
ALTER TABLE [ord].[EndOfDayPrice]  WITH NOCHECK ADD  CONSTRAINT [FK_EndOfDayPrice_Instrument] FOREIGN KEY([InstrumentId])
REFERENCES [ord].[Instrument] ([InstrumentId])
ON DELETE CASCADE
GO
ALTER TABLE [ord].[EndOfDayPrice] CHECK CONSTRAINT [FK_EndOfDayPrice_Instrument]
GO
ALTER TABLE [ord].[ExecutionAlgorithmParamSet]  WITH NOCHECK ADD  CONSTRAINT [FK_ExecutionAlgorithmParamSet_ExecutionAlgorithm] FOREIGN KEY([ExecutionAlgorithmId])
REFERENCES [ord].[ExecutionAlgorithm] ([ExecutionAlgorithmId])
GO
ALTER TABLE [ord].[ExecutionAlgorithmParamSet] CHECK CONSTRAINT [FK_ExecutionAlgorithmParamSet_ExecutionAlgorithm]
GO
ALTER TABLE [ord].[ExecutionProfile]  WITH NOCHECK ADD  CONSTRAINT [FK_ExecutionProfile_ExecutionAlgorithm] FOREIGN KEY([ExecutionAlgorithmId])
REFERENCES [ord].[ExecutionAlgorithm] ([ExecutionAlgorithmId])
GO
ALTER TABLE [ord].[ExecutionProfile] CHECK CONSTRAINT [FK_ExecutionProfile_ExecutionAlgorithm]
GO
ALTER TABLE [ord].[ExecutionProfile]  WITH NOCHECK ADD  CONSTRAINT [FK_ExecutionProfile_ExecutionAlgorithmParamSet] FOREIGN KEY([ExecutionAlgorithmParamSetId])
REFERENCES [ord].[ExecutionAlgorithmParamSet] ([ExecutionAlgorithmParamSetId])
GO
ALTER TABLE [ord].[ExecutionProfile] CHECK CONSTRAINT [FK_ExecutionProfile_ExecutionAlgorithmParamSet]
GO
ALTER TABLE [ord].[ExecutionProfile]  WITH NOCHECK ADD  CONSTRAINT [FK_ExecutionProfile_ExecutionChannel] FOREIGN KEY([ExecutionChannelId])
REFERENCES [ord].[ExecutionChannel] ([ExecutionChannelId])
GO
ALTER TABLE [ord].[ExecutionProfile] CHECK CONSTRAINT [FK_ExecutionProfile_ExecutionChannel]
GO
ALTER TABLE [ord].[ExecutionProfile]  WITH NOCHECK ADD  CONSTRAINT [FK_ExecutionProfile_HandlingInstruction] FOREIGN KEY([HandlingInstructionId])
REFERENCES [ord].[HandlingInstruction] ([HandlingInstructionId])
GO
ALTER TABLE [ord].[ExecutionProfile] CHECK CONSTRAINT [FK_ExecutionProfile_HandlingInstruction]
GO
ALTER TABLE [ord].[ExecutionProfile]  WITH NOCHECK ADD  CONSTRAINT [FK_ExecutionProfile_OrderType] FOREIGN KEY([OrderTypeId])
REFERENCES [ord].[OrderType] ([OrderTypeId])
GO
ALTER TABLE [ord].[ExecutionProfile] CHECK CONSTRAINT [FK_ExecutionProfile_OrderType]
GO
ALTER TABLE [ord].[ExecutionProfile]  WITH NOCHECK ADD  CONSTRAINT [FK_ExecutionProfile_TimeInForce] FOREIGN KEY([TimeInForceId])
REFERENCES [ord].[TimeInForce] ([TimeInForceId])
GO
ALTER TABLE [ord].[ExecutionProfile] CHECK CONSTRAINT [FK_ExecutionProfile_TimeInForce]
GO
ALTER TABLE [ord].[ExecutionProfileSelectionRule]  WITH NOCHECK ADD  CONSTRAINT [FK_ExecutionProfileSelectionRule_Broker] FOREIGN KEY([BrokerId])
REFERENCES [ord].[Broker] ([BrokerId])
GO
ALTER TABLE [ord].[ExecutionProfileSelectionRule] NOCHECK CONSTRAINT [FK_ExecutionProfileSelectionRule_Broker]
GO
ALTER TABLE [ord].[ExecutionProfileSelectionRule]  WITH NOCHECK ADD  CONSTRAINT [FK_ExecutionProfileSelectionRule_ExecutionProfile] FOREIGN KEY([ExecutionProfileId])
REFERENCES [ord].[ExecutionProfile] ([ExecutionProfileId])
GO
ALTER TABLE [ord].[ExecutionProfileSelectionRule] CHECK CONSTRAINT [FK_ExecutionProfileSelectionRule_ExecutionProfile]
GO
ALTER TABLE [ord].[ExecutionProfileSelectionRule]  WITH NOCHECK ADD  CONSTRAINT [FK_ExecutionProfileSelectionRule_InstrumentType] FOREIGN KEY([InstrumentTypeId])
REFERENCES [ord].[InstrumentType] ([InstrumentTypeId])
GO
ALTER TABLE [ord].[ExecutionProfileSelectionRule] CHECK CONSTRAINT [FK_ExecutionProfileSelectionRule_InstrumentType]
GO
ALTER TABLE [ord].[ExecutionProfileSelectionRule]  WITH NOCHECK ADD  CONSTRAINT [FK_ExecutionProfileSelectionRule_Portfolio] FOREIGN KEY([PortfolioId])
REFERENCES [ord].[Portfolio] ([PortfolioId])
GO
ALTER TABLE [ord].[ExecutionProfileSelectionRule] CHECK CONSTRAINT [FK_ExecutionProfileSelectionRule_Portfolio]
GO
ALTER TABLE [ord].[ExecutionProfileSelectionRule]  WITH NOCHECK ADD  CONSTRAINT [FK_ExecutionProfileSelectionRule_TradeMode] FOREIGN KEY([TradeModeId])
REFERENCES [ord].[TradeMode] ([TradeModeId])
GO
ALTER TABLE [ord].[ExecutionProfileSelectionRule] CHECK CONSTRAINT [FK_ExecutionProfileSelectionRule_TradeMode]
GO
ALTER TABLE [ord].[Instrument]  WITH NOCHECK ADD  CONSTRAINT [FK_Instrument_InstrumentType] FOREIGN KEY([InstrumentTypeId])
REFERENCES [ord].[InstrumentType] ([InstrumentTypeId])
GO
ALTER TABLE [ord].[Instrument] CHECK CONSTRAINT [FK_Instrument_InstrumentType]
GO
ALTER TABLE [ord].[TradeModeSelectionRule]  WITH NOCHECK ADD  CONSTRAINT [FK_TradeModeSelectionRule_Broker] FOREIGN KEY([BrokerId])
REFERENCES [ord].[Broker] ([BrokerId])
GO
ALTER TABLE [ord].[TradeModeSelectionRule] NOCHECK CONSTRAINT [FK_TradeModeSelectionRule_Broker]
GO
ALTER TABLE [ord].[TradeModeSelectionRule]  WITH NOCHECK ADD  CONSTRAINT [FK_TradeModeSelectionRule_Instrument] FOREIGN KEY([InstrumentId])
REFERENCES [ord].[Instrument] ([InstrumentId])
GO
ALTER TABLE [ord].[TradeModeSelectionRule] CHECK CONSTRAINT [FK_TradeModeSelectionRule_Instrument]
GO
ALTER TABLE [ord].[TradeModeSelectionRule]  WITH NOCHECK ADD  CONSTRAINT [FK_TradeModeSelectionRule_Portfolio] FOREIGN KEY([PortfolioId])
REFERENCES [ord].[Portfolio] ([PortfolioId])
GO
ALTER TABLE [ord].[TradeModeSelectionRule] CHECK CONSTRAINT [FK_TradeModeSelectionRule_Portfolio]
GO
ALTER TABLE [ord].[TradeModeSelectionRule]  WITH NOCHECK ADD  CONSTRAINT [FK_TradeModeSelectionRule_TradeMode] FOREIGN KEY([TradeModeId])
REFERENCES [ord].[TradeMode] ([TradeModeId])
GO
ALTER TABLE [ord].[TradeModeSelectionRule] CHECK CONSTRAINT [FK_TradeModeSelectionRule_TradeMode]
GO
ALTER TABLE [ord].[TradingAccountSelectionRule]  WITH NOCHECK ADD  CONSTRAINT [FK_TradingAccountSelectionRule_Broker] FOREIGN KEY([BrokerId])
REFERENCES [ord].[Broker] ([BrokerId])
GO
ALTER TABLE [ord].[TradingAccountSelectionRule] NOCHECK CONSTRAINT [FK_TradingAccountSelectionRule_Broker]
GO
ALTER TABLE [ord].[TradingAccountSelectionRule]  WITH NOCHECK ADD  CONSTRAINT [FK_TradingAccountSelectionRule_InstrumentType] FOREIGN KEY([InstrumentTypeId])
REFERENCES [ord].[InstrumentType] ([InstrumentTypeId])
GO
ALTER TABLE [ord].[TradingAccountSelectionRule] CHECK CONSTRAINT [FK_TradingAccountSelectionRule_InstrumentType]
GO
ALTER TABLE [ord].[TradingAccountSelectionRule]  WITH NOCHECK ADD  CONSTRAINT [FK_TradingAccountSelectionRule_Portfolio] FOREIGN KEY([PortfolioId])
REFERENCES [ord].[Portfolio] ([PortfolioId])
GO
ALTER TABLE [ord].[TradingAccountSelectionRule] CHECK CONSTRAINT [FK_TradingAccountSelectionRule_Portfolio]
GO
ALTER TABLE [ord].[TradingAccountSelectionRule]  WITH NOCHECK ADD  CONSTRAINT [FK_TradingAccountSelectionRule_TradeMode] FOREIGN KEY([TradeModeId])
REFERENCES [ord].[TradeMode] ([TradeModeId])
GO
ALTER TABLE [ord].[TradingAccountSelectionRule] CHECK CONSTRAINT [FK_TradingAccountSelectionRule_TradeMode]
GO
ALTER TABLE [ord].[TradingAccountSelectionRule]  WITH NOCHECK ADD  CONSTRAINT [FK_TradingAccountSelectionRule_TradingAccount] FOREIGN KEY([TradingAccountId])
REFERENCES [ord].[TradingAccount] ([TradingAccountId])
GO
ALTER TABLE [ord].[TradingAccountSelectionRule] CHECK CONSTRAINT [FK_TradingAccountSelectionRule_TradingAccount]
GO
ALTER TABLE [port].[Position]  WITH NOCHECK ADD  CONSTRAINT [FK_Position_Instrument] FOREIGN KEY([InstrumentId])
REFERENCES [port].[Instrument] ([InstrumentId])
GO
ALTER TABLE [port].[Position] CHECK CONSTRAINT [FK_Position_Instrument]
GO
ALTER TABLE [port].[Position]  WITH NOCHECK ADD  CONSTRAINT [FK_Position_Portfolio] FOREIGN KEY([PortfolioId])
REFERENCES [port].[Portfolio] ([PortfolioId])
ON DELETE CASCADE
GO
ALTER TABLE [port].[Position] CHECK CONSTRAINT [FK_Position_Portfolio]
GO
ALTER TABLE [prc].[InstrumentPricing]  WITH NOCHECK ADD  CONSTRAINT [FK_InstrumentPricing_Instrument] FOREIGN KEY([InstrumentId])
REFERENCES [instr].[Instrument] ([InstrumentId])
ON DELETE CASCADE
GO
ALTER TABLE [prc].[InstrumentPricing] CHECK CONSTRAINT [FK_InstrumentPricing_Instrument]
GO
ALTER TABLE [pricing].[EndOfDayPrice]  WITH NOCHECK ADD  CONSTRAINT [FK_EndOfDayPrice_Instrument] FOREIGN KEY([InstrumentId])
REFERENCES [pricing].[Instrument] ([InstrumentId])
ON DELETE CASCADE
GO
ALTER TABLE [pricing].[EndOfDayPrice] CHECK CONSTRAINT [FK_EndOfDayPrice_Instrument]
GO
ALTER TABLE [rebal].[PortfolioDrift]  WITH NOCHECK ADD  CONSTRAINT [FK_PortfolioDrift_PortfolioValuation] FOREIGN KEY([PortfolioValuationId])
REFERENCES [rebal].[PortfolioValuation] ([PortfolioValuationId])
ON DELETE CASCADE
GO
ALTER TABLE [rebal].[PortfolioDrift] CHECK CONSTRAINT [FK_PortfolioDrift_PortfolioValuation]
GO
ALTER TABLE [rebal].[PortfolioDrift]  WITH NOCHECK ADD  CONSTRAINT [FK_PortfolioDrift_TargetAllocationValuation] FOREIGN KEY([TargetAllocationValuationId])
REFERENCES [rebal].[TargetAllocationValuation] ([TargetAllocationValuationId])
ON DELETE CASCADE
GO
ALTER TABLE [rebal].[PortfolioDrift] CHECK CONSTRAINT [FK_PortfolioDrift_TargetAllocationValuation]
GO
ALTER TABLE [rebal].[PositionDrift]  WITH NOCHECK ADD  CONSTRAINT [FK_PositionDrift_PortfolioDrift] FOREIGN KEY([PortfolioDriftId])
REFERENCES [rebal].[PortfolioDrift] ([PortfolioDriftId])
ON DELETE CASCADE
GO
ALTER TABLE [rebal].[PositionDrift] CHECK CONSTRAINT [FK_PositionDrift_PortfolioDrift]
GO
ALTER TABLE [rebal].[PositionValuation]  WITH NOCHECK ADD  CONSTRAINT [FK_PositionValuation_PortfolioValuation] FOREIGN KEY([PortfolioValuationId])
REFERENCES [rebal].[PortfolioValuation] ([PortfolioValuationId])
ON DELETE CASCADE
GO
ALTER TABLE [rebal].[PositionValuation] CHECK CONSTRAINT [FK_PositionValuation_PortfolioValuation]
GO
ALTER TABLE [rebal].[RebalancingSessionPortfolioDrift]  WITH NOCHECK ADD  CONSTRAINT [FK_RebalancingSessionPortfolioDrift_PortfolioDrift] FOREIGN KEY([PortfolioDriftId])
REFERENCES [rebal].[PortfolioDrift] ([PortfolioDriftId])
GO
ALTER TABLE [rebal].[RebalancingSessionPortfolioDrift] CHECK CONSTRAINT [FK_RebalancingSessionPortfolioDrift_PortfolioDrift]
GO
ALTER TABLE [rebal].[RebalancingSessionPortfolioDrift]  WITH NOCHECK ADD  CONSTRAINT [FK_RebalancingSessionPortfolioDrift_RebalancingSession] FOREIGN KEY([RebalancingSessionId])
REFERENCES [rebal].[RebalancingSession] ([RebalancingSessionId])
GO
ALTER TABLE [rebal].[RebalancingSessionPortfolioDrift] CHECK CONSTRAINT [FK_RebalancingSessionPortfolioDrift_RebalancingSession]
GO
ALTER TABLE [rebal].[TargetWeightValuation]  WITH NOCHECK ADD  CONSTRAINT [FK_TargetWeightValuation_TargetAllocationValuation] FOREIGN KEY([TargetAllocationValuationId])
REFERENCES [rebal].[TargetAllocationValuation] ([TargetAllocationValuationId])
ON DELETE CASCADE
GO
ALTER TABLE [rebal].[TargetWeightValuation] CHECK CONSTRAINT [FK_TargetWeightValuation_TargetAllocationValuation]
GO
ALTER TABLE [risk].[Constraint]  WITH NOCHECK ADD  CONSTRAINT [FK_Constraint_ConstraintType] FOREIGN KEY([ConstraintTypeId])
REFERENCES [risk].[ConstraintType] ([ConstraintTypeId])
GO
ALTER TABLE [risk].[Constraint] CHECK CONSTRAINT [FK_Constraint_ConstraintType]
GO
ALTER TABLE [risk].[Constraint]  WITH NOCHECK ADD  CONSTRAINT [FK_Constraint_Filter] FOREIGN KEY([FilterId])
REFERENCES [risk].[Filter] ([FilterId])
GO
ALTER TABLE [risk].[Constraint] CHECK CONSTRAINT [FK_Constraint_Filter]
GO
ALTER TABLE [risk].[Constraint]  WITH NOCHECK ADD  CONSTRAINT [FK_Constraint_RelationalOperator] FOREIGN KEY([RelationalOperatorId])
REFERENCES [risk].[RelationalOperator] ([RelationalOperatorId])
GO
ALTER TABLE [risk].[Constraint] CHECK CONSTRAINT [FK_Constraint_RelationalOperator]
GO
ALTER TABLE [risk].[ConstraintBreach]  WITH NOCHECK ADD  CONSTRAINT [FK_ConstraintBreach_Constraint] FOREIGN KEY([ConstraintId])
REFERENCES [risk].[Constraint] ([ConstraintId])
GO
ALTER TABLE [risk].[ConstraintBreach] CHECK CONSTRAINT [FK_ConstraintBreach_Constraint]
GO
ALTER TABLE [risk].[ConstraintBreach]  WITH NOCHECK ADD  CONSTRAINT [FK_ConstraintBreach_TargetAllocationCheck] FOREIGN KEY([TargetAllocationCheckId])
REFERENCES [risk].[TargetAllocationCheck] ([TargetAllocationCheckId])
GO
ALTER TABLE [risk].[ConstraintBreach] CHECK CONSTRAINT [FK_ConstraintBreach_TargetAllocationCheck]
GO
ALTER TABLE [risk].[Filter]  WITH NOCHECK ADD  CONSTRAINT [FK_Filter_BooleanOperator] FOREIGN KEY([BooleanOperatorId])
REFERENCES [risk].[BooleanOperator] ([BooleanOperatorId])
GO
ALTER TABLE [risk].[Filter] CHECK CONSTRAINT [FK_Filter_BooleanOperator]
GO
ALTER TABLE [risk].[Filter]  WITH NOCHECK ADD  CONSTRAINT [FK_Filter_FilterCriterion1] FOREIGN KEY([FilterCriterion1Id])
REFERENCES [risk].[FilterCriterion] ([FilterCriterionId])
GO
ALTER TABLE [risk].[Filter] CHECK CONSTRAINT [FK_Filter_FilterCriterion1]
GO
ALTER TABLE [risk].[Filter]  WITH NOCHECK ADD  CONSTRAINT [FK_Filter_FilterCriterion2] FOREIGN KEY([FilterCriterion2Id])
REFERENCES [risk].[FilterCriterion] ([FilterCriterionId])
GO
ALTER TABLE [risk].[Filter] CHECK CONSTRAINT [FK_Filter_FilterCriterion2]
GO
ALTER TABLE [risk].[FilterCriterion]  WITH NOCHECK ADD  CONSTRAINT [FK_FilterCriterion_FilterOperator] FOREIGN KEY([FilterOperatorId])
REFERENCES [risk].[FilterOperator] ([FilterOperatorId])
GO
ALTER TABLE [risk].[FilterCriterion] CHECK CONSTRAINT [FK_FilterCriterion_FilterOperator]
GO
ALTER TABLE [risk].[FilterCriterion]  WITH NOCHECK ADD  CONSTRAINT [FK_FilterCriterion_FilterParty] FOREIGN KEY([FilterPartyId], [FilterPartyTypeId])
REFERENCES [risk].[FilterParty] ([FilterPartyId], [FilterPartyTypeId])
GO
ALTER TABLE [risk].[FilterCriterion] CHECK CONSTRAINT [FK_FilterCriterion_FilterParty]
GO
ALTER TABLE [risk].[FilterCriterion]  WITH NOCHECK ADD  CONSTRAINT [FK_FilterCriterion_FilterPartyType] FOREIGN KEY([FilterPartyTypeId])
REFERENCES [risk].[FilterPartyType] ([FilterPartyTypeId])
GO
ALTER TABLE [risk].[FilterCriterion] CHECK CONSTRAINT [FK_FilterCriterion_FilterPartyType]
GO
ALTER TABLE [risk].[PortfolioConstraint]  WITH NOCHECK ADD  CONSTRAINT [FK_PortfolioConstraint_Constraint] FOREIGN KEY([ConstraintId])
REFERENCES [risk].[Constraint] ([ConstraintId])
ON DELETE CASCADE
GO
ALTER TABLE [risk].[PortfolioConstraint] CHECK CONSTRAINT [FK_PortfolioConstraint_Constraint]
GO
ALTER TABLE [risk].[PortfolioConstraint]  WITH NOCHECK ADD  CONSTRAINT [FK_PortfolioConstraint_Portfolio] FOREIGN KEY([PortfolioId])
REFERENCES [risk].[Portfolio] ([PortfolioId])
ON DELETE CASCADE
GO
ALTER TABLE [risk].[PortfolioConstraint] CHECK CONSTRAINT [FK_PortfolioConstraint_Portfolio]
GO
ALTER TABLE [roll].[ForwardContract]  WITH NOCHECK ADD  CONSTRAINT [FK_ForwardContract_CurrencyPair] FOREIGN KEY([CurrencyPairId])
REFERENCES [roll].[ForwardContractChain] ([CurrencyPairId])
ON DELETE CASCADE
GO
ALTER TABLE [roll].[ForwardContract] CHECK CONSTRAINT [FK_ForwardContract_CurrencyPair]
GO
ALTER TABLE [roll].[FutureContract]  WITH NOCHECK ADD  CONSTRAINT [FK_FutureContract_GenericFuture] FOREIGN KEY([GenericFutureId])
REFERENCES [roll].[FutureContractChain] ([GenericFutureId])
ON DELETE CASCADE
GO
ALTER TABLE [roll].[FutureContract] CHECK CONSTRAINT [FK_FutureContract_GenericFuture]
GO
ALTER TABLE [rout].[AccountSelectionRule]  WITH NOCHECK ADD  CONSTRAINT [FK_AccountSelectionRule_Account] FOREIGN KEY([AccountId])
REFERENCES [rout].[Account] ([AccountId])
GO
ALTER TABLE [rout].[AccountSelectionRule] CHECK CONSTRAINT [FK_AccountSelectionRule_Account]
GO
ALTER TABLE [strats].[Price]  WITH NOCHECK ADD  CONSTRAINT [FK_Price_Security] FOREIGN KEY([SecurityId])
REFERENCES [strats].[Security] ([SecurityId])
GO
ALTER TABLE [strats].[Price] CHECK CONSTRAINT [FK_Price_Security]
GO
ALTER TABLE [strats].[SubUniverseConstituent]  WITH NOCHECK ADD  CONSTRAINT [FK_SubUniverseConstituent_Security] FOREIGN KEY([SecurityId])
REFERENCES [strats].[Security] ([SecurityId])
GO
ALTER TABLE [strats].[SubUniverseConstituent] CHECK CONSTRAINT [FK_SubUniverseConstituent_Security]
GO
ALTER TABLE [strats].[SubUniverseConstituent]  WITH NOCHECK ADD  CONSTRAINT [FK_SubUniverseConstituent_SubUniverse] FOREIGN KEY([SubUniverseId])
REFERENCES [strats].[SubUniverse] ([SubUniverseId])
GO
ALTER TABLE [strats].[SubUniverseConstituent] CHECK CONSTRAINT [FK_SubUniverseConstituent_SubUniverse]
GO
ALTER TABLE [strats].[UniverseConstituent]  WITH NOCHECK ADD  CONSTRAINT [FK_UniverseConstituent_Security] FOREIGN KEY([SecurityId])
REFERENCES [strats].[Security] ([SecurityId])
GO
ALTER TABLE [strats].[UniverseConstituent] CHECK CONSTRAINT [FK_UniverseConstituent_Security]
GO
ALTER TABLE [strats].[UniverseConstituent]  WITH NOCHECK ADD  CONSTRAINT [FK_UniverseConstituent_Universe] FOREIGN KEY([UniverseId])
REFERENCES [strats].[Universe] ([UniverseId])
GO
ALTER TABLE [strats].[UniverseConstituent] CHECK CONSTRAINT [FK_UniverseConstituent_Universe]
GO
ALTER TABLE [val].[FutureContract]  WITH NOCHECK ADD  CONSTRAINT [FK_FutureContract_Instrument] FOREIGN KEY([FutureContractId])
REFERENCES [val].[Instrument] ([InstrumentId])
ON DELETE CASCADE
GO
ALTER TABLE [val].[FutureContract] CHECK CONSTRAINT [FK_FutureContract_Instrument]
GO
ALTER TABLE [val].[InstrumentPricing]  WITH NOCHECK ADD  CONSTRAINT [FK_InstrumentPricing_Instrument] FOREIGN KEY([InstrumentId])
REFERENCES [val].[Instrument] ([InstrumentId])
ON DELETE CASCADE
GO
ALTER TABLE [val].[InstrumentPricing] CHECK CONSTRAINT [FK_InstrumentPricing_Instrument]
GO
ALTER TABLE [val].[PortfolioValuation]  WITH NOCHECK ADD  CONSTRAINT [FK_PortfolioValuation_Portfolio] FOREIGN KEY([PortfolioId])
REFERENCES [val].[Portfolio] ([PortfolioId])
GO
ALTER TABLE [val].[PortfolioValuation] CHECK CONSTRAINT [FK_PortfolioValuation_Portfolio]
GO
ALTER TABLE [val].[Position]  WITH NOCHECK ADD  CONSTRAINT [FK_Position_Instrument] FOREIGN KEY([InstrumentId])
REFERENCES [val].[Instrument] ([InstrumentId])
GO
ALTER TABLE [val].[Position] CHECK CONSTRAINT [FK_Position_Instrument]
GO
ALTER TABLE [val].[Position]  WITH NOCHECK ADD  CONSTRAINT [FK_Position_Portfolio] FOREIGN KEY([PortfolioId])
REFERENCES [val].[Portfolio] ([PortfolioId])
ON DELETE CASCADE
GO
ALTER TABLE [val].[Position] CHECK CONSTRAINT [FK_Position_Portfolio]
GO
ALTER TABLE [val].[PositionValuation]  WITH NOCHECK ADD  CONSTRAINT [FK_PositionValuation_Instrument] FOREIGN KEY([InstrumentId])
REFERENCES [val].[Instrument] ([InstrumentId])
GO
ALTER TABLE [val].[PositionValuation] CHECK CONSTRAINT [FK_PositionValuation_Instrument]
GO
ALTER TABLE [val].[PositionValuation]  WITH NOCHECK ADD  CONSTRAINT [FK_PositionValuation_PortfolioValuation] FOREIGN KEY([PortfolioValuationId])
REFERENCES [val].[PortfolioValuation] ([PortfolioValuationId])
ON DELETE CASCADE
GO
ALTER TABLE [val].[PositionValuation] CHECK CONSTRAINT [FK_PositionValuation_PortfolioValuation]
GO
ALTER TABLE [val].[TargetAllocation]  WITH NOCHECK ADD  CONSTRAINT [FK_TargetAllocation_Portfolio] FOREIGN KEY([PortfolioId])
REFERENCES [val].[Portfolio] ([PortfolioId])
GO
ALTER TABLE [val].[TargetAllocation] CHECK CONSTRAINT [FK_TargetAllocation_Portfolio]
GO
ALTER TABLE [val].[TargetAllocationValuation]  WITH NOCHECK ADD  CONSTRAINT [FK_TargetAllocationValuation_TargetAllocation] FOREIGN KEY([TargetAllocationId])
REFERENCES [val].[TargetAllocation] ([TargetAllocationId])
ON DELETE CASCADE
GO
ALTER TABLE [val].[TargetAllocationValuation] CHECK CONSTRAINT [FK_TargetAllocationValuation_TargetAllocation]
GO
ALTER TABLE [val].[TargetWeight]  WITH NOCHECK ADD  CONSTRAINT [FK_TargetWeight_Instrument] FOREIGN KEY([InstrumentId])
REFERENCES [val].[Instrument] ([InstrumentId])
GO
ALTER TABLE [val].[TargetWeight] CHECK CONSTRAINT [FK_TargetWeight_Instrument]
GO
ALTER TABLE [val].[TargetWeight]  WITH NOCHECK ADD  CONSTRAINT [FK_TargetWeight_TargetAllocation] FOREIGN KEY([TargetAllocationId])
REFERENCES [val].[TargetAllocation] ([TargetAllocationId])
ON DELETE CASCADE
GO
ALTER TABLE [val].[TargetWeight] CHECK CONSTRAINT [FK_TargetWeight_TargetAllocation]
GO
ALTER TABLE [val].[TargetWeightValuation]  WITH NOCHECK ADD  CONSTRAINT [FK_TargetWeightValuation_Instrument] FOREIGN KEY([InstrumentId])
REFERENCES [val].[Instrument] ([InstrumentId])
GO
ALTER TABLE [val].[TargetWeightValuation] CHECK CONSTRAINT [FK_TargetWeightValuation_Instrument]
GO
ALTER TABLE [val].[TargetWeightValuation]  WITH NOCHECK ADD  CONSTRAINT [FK_TargetWeightValuation_TargetAllocationValuation] FOREIGN KEY([TargetAllocationValuationId])
REFERENCES [val].[TargetAllocationValuation] ([TargetAllocationValuationId])
ON DELETE CASCADE
GO
ALTER TABLE [val].[TargetWeightValuation] CHECK CONSTRAINT [FK_TargetWeightValuation_TargetAllocationValuation]
GO
ALTER TABLE [wght].[TargetWeight]  WITH NOCHECK ADD  CONSTRAINT [FK_TargetWeight_Instrument] FOREIGN KEY([InstrumentId])
REFERENCES [wght].[Instrument] ([InstrumentId])
GO
ALTER TABLE [wght].[TargetWeight] CHECK CONSTRAINT [FK_TargetWeight_Instrument]
GO
ALTER TABLE [wght].[TargetWeight]  WITH NOCHECK ADD  CONSTRAINT [FK_TargetWeight_TargetAllocation] FOREIGN KEY([TargetAllocationId])
REFERENCES [wght].[TargetAllocation] ([TargetAllocationId])
ON DELETE CASCADE
GO
ALTER TABLE [wght].[TargetWeight] CHECK CONSTRAINT [FK_TargetWeight_TargetAllocation]
GO
USE [master]
GO
ALTER DATABASE [Trading] SET  READ_WRITE 
GO
